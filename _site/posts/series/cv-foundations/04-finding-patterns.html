<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hasan">
<meta name="dcterms.date" content="2025-01-22">

<title>Hasan’s Data Science &amp; AI Blog - Finding Patterns: Edges, Contours, and Shapes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hasan’s Data Science &amp; AI Blog - Finding Patterns: Edges, Contours, and Shapes">
<meta property="og:description" content="">
<meta property="og:image" content="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2067&amp;q=80">
<meta property="og:site-name" content="Hasan's Data Science &amp; AI Blog">
<meta name="twitter:title" content="Hasan’s Data Science &amp; AI Blog - Finding Patterns: Edges, Contours, and Shapes">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2067&amp;q=80">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hasan’s Data Science &amp; AI Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-series" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-series">    
        <li>
    <a class="dropdown-item" href="../../../posts/series/data-science-steps.html" rel="" target="">
 <span class="dropdown-text">Data Science Steps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/computer-vision-with-pytorch.qmd" rel="" target="">
 <span class="dropdown-text">Computer Vision</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/vlm.html" rel="" target="">
 <span class="dropdown-text">VLM Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/anomaly-detection/index.html" rel="" target="">
 <span class="dropdown-text">Anomaly Detection</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../categories.html" rel="" target="">
 <span class="menu-text">Categories</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tags.html" rel="" target="">
 <span class="menu-text">Tags</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HasanGoni" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/hasangoni" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Finding Patterns: Edges, Contours, and Shapes</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Finding Patterns: Edges, Contours, and Shapes</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">computer-vision</div>
                <div class="quarto-category">edge-detection</div>
                <div class="quarto-category">contours</div>
                <div class="quarto-category">opencv</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hasan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 22, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">June 28, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/data-science-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 06</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Computer Vision</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">posts/series/computer-vision-with-pytorch.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Anomaly Detection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/finding-the-oddballs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding the Oddballs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">VLM Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm-qwen3-14b/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen3-14B</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-detective-story-teaching-computers-to-see-patterns" id="toc-the-detective-story-teaching-computers-to-see-patterns" class="nav-link active" data-scroll-target="#the-detective-story-teaching-computers-to-see-patterns"><span class="header-section-number">0.1</span> The Detective Story: Teaching Computers to See Patterns</a></li>
  <li><a href="#the-edge-detection-revolution" id="toc-the-edge-detection-revolution" class="nav-link" data-scroll-target="#the-edge-detection-revolution"><span class="header-section-number">0.2</span> The Edge Detection Revolution</a>
  <ul class="collapse">
  <li><a href="#why-edges-matter" id="toc-why-edges-matter" class="nav-link" data-scroll-target="#why-edges-matter"><span class="header-section-number">0.2.1</span> Why Edges Matter</a></li>
  </ul></li>
  <li><a href="#your-first-edge-detector-the-canny-algorithm" id="toc-your-first-edge-detector-the-canny-algorithm" class="nav-link" data-scroll-target="#your-first-edge-detector-the-canny-algorithm"><span class="header-section-number">0.3</span> Your First Edge Detector: The Canny Algorithm</a>
  <ul class="collapse">
  <li><a href="#understanding-the-canny-parameters" id="toc-understanding-the-canny-parameters" class="nav-link" data-scroll-target="#understanding-the-canny-parameters"><span class="header-section-number">0.3.1</span> Understanding the Canny Parameters</a></li>
  <li><a href="#the-magic-behind-canny" id="toc-the-magic-behind-canny" class="nav-link" data-scroll-target="#the-magic-behind-canny"><span class="header-section-number">0.3.2</span> The Magic Behind Canny</a></li>
  </ul></li>
  <li><a href="#from-edges-to-shapes-contour-detection" id="toc-from-edges-to-shapes-contour-detection" class="nav-link" data-scroll-target="#from-edges-to-shapes-contour-detection"><span class="header-section-number">0.4</span> From Edges to Shapes: Contour Detection</a>
  <ul class="collapse">
  <li><a href="#analyzing-contour-properties" id="toc-analyzing-contour-properties" class="nav-link" data-scroll-target="#analyzing-contour-properties"><span class="header-section-number">0.4.1</span> Analyzing Contour Properties</a></li>
  </ul></li>
  <li><a href="#shape-detection-teaching-computers-geometry" id="toc-shape-detection-teaching-computers-geometry" class="nav-link" data-scroll-target="#shape-detection-teaching-computers-geometry"><span class="header-section-number">0.5</span> Shape Detection: Teaching Computers Geometry</a></li>
  <li><a href="#real-world-application-coin-counter" id="toc-real-world-application-coin-counter" class="nav-link" data-scroll-target="#real-world-application-coin-counter"><span class="header-section-number">0.6</span> Real-World Application: Coin Counter</a></li>
  <li><a href="#advanced-pattern-detection-template-matching" id="toc-advanced-pattern-detection-template-matching" class="nav-link" data-scroll-target="#advanced-pattern-detection-template-matching"><span class="header-section-number">0.7</span> Advanced Pattern Detection: Template Matching</a></li>
  <li><a href="#building-a-complete-object-detection-pipeline" id="toc-building-a-complete-object-detection-pipeline" class="nav-link" data-scroll-target="#building-a-complete-object-detection-pipeline"><span class="header-section-number">0.8</span> Building a Complete Object Detection Pipeline</a></li>
  <li><a href="#your-challenge-build-a-practical-application" id="toc-your-challenge-build-a-practical-application" class="nav-link" data-scroll-target="#your-challenge-build-a-practical-application"><span class="header-section-number">0.9</span> Your Challenge: Build a Practical Application</a>
  <ul class="collapse">
  <li><a href="#challenge-1-document-page-counter" id="toc-challenge-1-document-page-counter" class="nav-link" data-scroll-target="#challenge-1-document-page-counter"><span class="header-section-number">0.9.1</span> 🎯 <strong>Challenge 1: Document Page Counter</strong></a></li>
  <li><a href="#challenge-2-parking-space-detector" id="toc-challenge-2-parking-space-detector" class="nav-link" data-scroll-target="#challenge-2-parking-space-detector"><span class="header-section-number">0.9.2</span> 🎯 <strong>Challenge 2: Parking Space Detector</strong></a></li>
  <li><a href="#challenge-3-playing-card-detector" id="toc-challenge-3-playing-card-detector" class="nav-link" data-scroll-target="#challenge-3-playing-card-detector"><span class="header-section-number">0.9.3</span> 🎯 <strong>Challenge 3: Playing Card Detector</strong></a></li>
  </ul></li>
  <li><a href="#whats-coming-next" id="toc-whats-coming-next" class="nav-link" data-scroll-target="#whats-coming-next"><span class="header-section-number">0.10</span> What’s Coming Next?</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">0.11</span> Key Takeaways</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="the-detective-story-teaching-computers-to-see-patterns" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="the-detective-story-teaching-computers-to-see-patterns"><span class="header-section-number">0.1</span> The Detective Story: Teaching Computers to See Patterns</h2>
<p>Imagine you’re a detective looking at a crime scene photo. Your brain instantly picks out: - The outline of a footprint in the mud - The edge of a broken window - The shape of a mysterious object on the table</p>
<p>How do you do this so effortlessly? You’re detecting <strong>edges</strong> and <strong>patterns</strong>—the fundamental building blocks of vision.</p>
<p>Today, we’re going to teach computers this same superpower. By the end of this post, your computer will be able to find shapes, count objects, and even detect specific patterns in any image!</p>
</section>
<section id="the-edge-detection-revolution" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="the-edge-detection-revolution"><span class="header-section-number">0.2</span> The Edge Detection Revolution</h2>
<p><strong>Edges</strong> are where the magic happens. They’re the boundaries between different regions in an image—where one object ends and another begins. Think of them as the “outlines” in a coloring book.</p>
<section id="why-edges-matter" class="level3" data-number="0.2.1">
<h3 data-number="0.2.1" class="anchored" data-anchor-id="why-edges-matter"><span class="header-section-number">0.2.1</span> Why Edges Matter</h3>
<p>Before we dive into code, let’s understand why edge detection changed everything:</p>
<ul>
<li><strong>Object Recognition</strong>: Edges define object boundaries</li>
<li><strong>Feature Extraction</strong>: Corners and curves are key features</li>
<li><strong>Noise Reduction</strong>: Edges help separate signal from noise</li>
<li><strong>Compression</strong>: JPEG uses edge information to compress images</li>
</ul>
</section>
</section>
<section id="your-first-edge-detector-the-canny-algorithm" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="your-first-edge-detector-the-canny-algorithm"><span class="header-section-number">0.3</span> Your First Edge Detector: The Canny Algorithm</h2>
<p>The <strong>Canny edge detector</strong> is the gold standard—it’s been the go-to algorithm for over 30 years! Here’s how it works:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Load and prepare image</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>img <span class="op">=</span> cv2.imread(<span class="st">'your_image.jpg'</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>img_rgb <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2RGB)</span>
<span id="cb1-8"><a href="#cb1-8"></a>gray <span class="op">=</span> cv2.cvtColor(img_rgb, cv2.COLOR_RGB2GRAY)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Apply Canny edge detection</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># Display the results</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a>plt.imshow(img_rgb)</span>
<span id="cb1-18"><a href="#cb1-18"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>plt.imshow(gray, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>plt.title(<span class="st">"Grayscale"</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1-27"><a href="#cb1-27"></a>plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a>plt.title(<span class="st">"Canny Edges"</span>)</span>
<span id="cb1-29"><a href="#cb1-29"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a>plt.tight_layout()</span>
<span id="cb1-32"><a href="#cb1-32"></a>plt.show()</span>
<span id="cb1-33"><a href="#cb1-33"></a></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="bu">print</span>(<span class="ss">f"Found edges in </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(edges <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">}</span><span class="ss"> pixels out of </span><span class="sc">{</span>edges<span class="sc">.</span>size<span class="sc">}</span><span class="ss"> total pixels"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>🎯 Try it yourself!</strong> <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-04-finding-patterns.ipynb">Open in Colab</a></p>
<section id="understanding-the-canny-parameters" class="level3" data-number="0.3.1">
<h3 data-number="0.3.1" class="anchored" data-anchor-id="understanding-the-canny-parameters"><span class="header-section-number">0.3.1</span> Understanding the Canny Parameters</h3>
<p>The Canny algorithm has two important parameters—think of them as sensitivity controls:</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> explore_canny_thresholds(image, low_thresholds, high_thresholds):</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="co">"""Explore different Canny threshold combinations"""</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb2-4"><a href="#cb2-4"></a>    </span>
<span id="cb2-5"><a href="#cb2-5"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb2-6"><a href="#cb2-6"></a>    </span>
<span id="cb2-7"><a href="#cb2-7"></a>    plot_idx <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="cf">for</span> low <span class="kw">in</span> low_thresholds:</span>
<span id="cb2-9"><a href="#cb2-9"></a>        <span class="cf">for</span> high <span class="kw">in</span> high_thresholds:</span>
<span id="cb2-10"><a href="#cb2-10"></a>            edges <span class="op">=</span> cv2.Canny(gray, low, high)</span>
<span id="cb2-11"><a href="#cb2-11"></a>            </span>
<span id="cb2-12"><a href="#cb2-12"></a>            plt.subplot(<span class="bu">len</span>(low_thresholds), <span class="bu">len</span>(high_thresholds), plot_idx)</span>
<span id="cb2-13"><a href="#cb2-13"></a>            plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>            plt.title(<span class="ss">f"Low: </span><span class="sc">{</span>low<span class="sc">}</span><span class="ss">, High: </span><span class="sc">{</span>high<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>            plt.axis(<span class="st">'off'</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a>            </span>
<span id="cb2-17"><a href="#cb2-17"></a>            plot_idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>    </span>
<span id="cb2-19"><a href="#cb2-19"></a>    plt.tight_layout()</span>
<span id="cb2-20"><a href="#cb2-20"></a>    plt.show()</span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co"># Test different threshold combinations</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>low_thresholds <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>]</span>
<span id="cb2-24"><a href="#cb2-24"></a>high_thresholds <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>]</span>
<span id="cb2-25"><a href="#cb2-25"></a>explore_canny_thresholds(img_rgb, low_thresholds, high_thresholds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="the-magic-behind-canny" class="level3" data-number="0.3.2">
<h3 data-number="0.3.2" class="anchored" data-anchor-id="the-magic-behind-canny"><span class="header-section-number">0.3.2</span> The Magic Behind Canny</h3>
<p>Here’s what happens inside the Canny algorithm (don’t worry, OpenCV does this for you!):</p>
<ol type="1">
<li><strong>Blur</strong> the image to reduce noise</li>
<li><strong>Calculate gradients</strong> to find intensity changes</li>
<li><strong>Non-maximum suppression</strong> to thin the edges</li>
<li><strong>Double thresholding</strong> to classify edge pixels</li>
<li><strong>Edge tracking</strong> to connect broken edge segments</li>
</ol>
</section>
</section>
<section id="from-edges-to-shapes-contour-detection" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="from-edges-to-shapes-contour-detection"><span class="header-section-number">0.4</span> From Edges to Shapes: Contour Detection</h2>
<p>Edges are great, but <strong>contours</strong> are even better! A contour is a curve that connects all the edge points around an object’s boundary. Think of it as tracing around objects with your finger.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Find edges first</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>gray <span class="op">=</span> cv2.cvtColor(img_rgb, cv2.COLOR_RGB2GRAY)</span>
<span id="cb3-3"><a href="#cb3-3"></a>edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Find contours</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>contours, hierarchy <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(contours)<span class="sc">}</span><span class="ss"> contours!"</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># Draw contours on the original image</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>img_with_contours <span class="op">=</span> img_rgb.copy()</span>
<span id="cb3-12"><a href="#cb3-12"></a>cv2.drawContours(img_with_contours, contours, <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># Display results</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>plt.imshow(img_rgb)</span>
<span id="cb3-19"><a href="#cb3-19"></a>plt.title(<span class="st">"Original"</span>)</span>
<span id="cb3-20"><a href="#cb3-20"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb3-23"><a href="#cb3-23"></a>plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-24"><a href="#cb3-24"></a>plt.title(<span class="st">"Edges"</span>)</span>
<span id="cb3-25"><a href="#cb3-25"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>plt.imshow(img_with_contours)</span>
<span id="cb3-29"><a href="#cb3-29"></a>plt.title(<span class="ss">f"Contours (</span><span class="sc">{</span><span class="bu">len</span>(contours)<span class="sc">}</span><span class="ss"> found)"</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-31"><a href="#cb3-31"></a></span>
<span id="cb3-32"><a href="#cb3-32"></a>plt.tight_layout()</span>
<span id="cb3-33"><a href="#cb3-33"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="analyzing-contour-properties" class="level3" data-number="0.4.1">
<h3 data-number="0.4.1" class="anchored" data-anchor-id="analyzing-contour-properties"><span class="header-section-number">0.4.1</span> Analyzing Contour Properties</h3>
<p>Once we have contours, we can learn a lot about each shape:</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> analyze_contours(contours, image):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="co">"""Analyze properties of each contour"""</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    img_analysis <span class="op">=</span> image.copy()</span>
<span id="cb4-4"><a href="#cb4-4"></a>    </span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="co"># Calculate contour properties</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb4-8"><a href="#cb4-8"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>        </span>
<span id="cb4-10"><a href="#cb4-10"></a>        <span class="co"># Skip tiny contours (probably noise)</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>        <span class="cf">if</span> area <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb4-12"><a href="#cb4-12"></a>            <span class="cf">continue</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>        </span>
<span id="cb4-14"><a href="#cb4-14"></a>        <span class="co"># Get bounding rectangle</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>        x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb4-16"><a href="#cb4-16"></a>        </span>
<span id="cb4-17"><a href="#cb4-17"></a>        <span class="co"># Calculate aspect ratio</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>        aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb4-19"><a href="#cb4-19"></a>        </span>
<span id="cb4-20"><a href="#cb4-20"></a>        <span class="co"># Calculate extent (contour area / bounding rectangle area)</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>        rect_area <span class="op">=</span> w <span class="op">*</span> h</span>
<span id="cb4-22"><a href="#cb4-22"></a>        extent <span class="op">=</span> <span class="bu">float</span>(area) <span class="op">/</span> rect_area</span>
<span id="cb4-23"><a href="#cb4-23"></a>        </span>
<span id="cb4-24"><a href="#cb4-24"></a>        <span class="co"># Draw bounding rectangle</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>        cv2.rectangle(img_analysis, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb4-26"><a href="#cb4-26"></a>        </span>
<span id="cb4-27"><a href="#cb4-27"></a>        <span class="co"># Add text with properties</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>        text <span class="op">=</span> <span class="ss">f"#</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: A=</span><span class="sc">{</span><span class="bu">int</span>(area)<span class="sc">}</span><span class="ss">, AR=</span><span class="sc">{</span>aspect_ratio<span class="sc">:.2f}</span><span class="ss">"</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>        cv2.putText(img_analysis, text, (x, y<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb4-30"><a href="#cb4-30"></a>                   cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb4-31"><a href="#cb4-31"></a>        </span>
<span id="cb4-32"><a href="#cb4-32"></a>        <span class="bu">print</span>(<span class="ss">f"Contour </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb4-33"><a href="#cb4-33"></a>        <span class="bu">print</span>(<span class="ss">f"  Area: </span><span class="sc">{</span>area<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb4-34"><a href="#cb4-34"></a>        <span class="bu">print</span>(<span class="ss">f"  Perimeter: </span><span class="sc">{</span>perimeter<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb4-35"><a href="#cb4-35"></a>        <span class="bu">print</span>(<span class="ss">f"  Aspect Ratio: </span><span class="sc">{</span>aspect_ratio<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-36"><a href="#cb4-36"></a>        <span class="bu">print</span>(<span class="ss">f"  Extent: </span><span class="sc">{</span>extent<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-37"><a href="#cb4-37"></a>        <span class="bu">print</span>()</span>
<span id="cb4-38"><a href="#cb4-38"></a>    </span>
<span id="cb4-39"><a href="#cb4-39"></a>    <span class="cf">return</span> img_analysis</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="co"># Analyze our contours</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>analyzed_img <span class="op">=</span> analyze_contours(contours, img_rgb)</span>
<span id="cb4-43"><a href="#cb4-43"></a></span>
<span id="cb4-44"><a href="#cb4-44"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb4-45"><a href="#cb4-45"></a>plt.imshow(analyzed_img)</span>
<span id="cb4-46"><a href="#cb4-46"></a>plt.title(<span class="st">"Contour Analysis"</span>)</span>
<span id="cb4-47"><a href="#cb4-47"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb4-48"><a href="#cb4-48"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="shape-detection-teaching-computers-geometry" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="shape-detection-teaching-computers-geometry"><span class="header-section-number">0.5</span> Shape Detection: Teaching Computers Geometry</h2>
<p>Now for the really cool part—detecting specific shapes! Let’s build a shape classifier:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> classify_shape(contour):</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="co">"""Classify a contour as a specific shape"""</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="co"># Approximate the contour to reduce number of points</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    epsilon <span class="op">=</span> <span class="fl">0.02</span> <span class="op">*</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>    approx <span class="op">=</span> cv2.approxPolyDP(contour, epsilon, <span class="va">True</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>    </span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="co"># Get number of vertices</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>    vertices <span class="op">=</span> <span class="bu">len</span>(approx)</span>
<span id="cb5-9"><a href="#cb5-9"></a>    </span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="co"># Calculate aspect ratio</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb5-12"><a href="#cb5-12"></a>    aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb5-13"><a href="#cb5-13"></a>    </span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="co"># Classify based on number of vertices and aspect ratio</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>    <span class="cf">if</span> vertices <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb5-16"><a href="#cb5-16"></a>        <span class="cf">return</span> <span class="st">"Triangle"</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="cf">elif</span> vertices <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb5-18"><a href="#cb5-18"></a>        <span class="cf">if</span> <span class="fl">0.95</span> <span class="op">&lt;=</span> aspect_ratio <span class="op">&lt;=</span> <span class="fl">1.05</span>:</span>
<span id="cb5-19"><a href="#cb5-19"></a>            <span class="cf">return</span> <span class="st">"Square"</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>        <span class="cf">else</span>:</span>
<span id="cb5-21"><a href="#cb5-21"></a>            <span class="cf">return</span> <span class="st">"Rectangle"</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="cf">elif</span> vertices <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb5-23"><a href="#cb5-23"></a>        <span class="cf">return</span> <span class="st">"Pentagon"</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="cf">elif</span> vertices <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb5-25"><a href="#cb5-25"></a>        <span class="co"># Check if it's circular</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb5-27"><a href="#cb5-27"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb5-28"><a href="#cb5-28"></a>        circularity <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">*</span> area <span class="op">/</span> (perimeter <span class="op">*</span> perimeter)</span>
<span id="cb5-29"><a href="#cb5-29"></a>        </span>
<span id="cb5-30"><a href="#cb5-30"></a>        <span class="cf">if</span> circularity <span class="op">&gt;</span> <span class="fl">0.7</span>:</span>
<span id="cb5-31"><a href="#cb5-31"></a>            <span class="cf">return</span> <span class="st">"Circle"</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>        <span class="cf">else</span>:</span>
<span id="cb5-33"><a href="#cb5-33"></a>            <span class="cf">return</span> <span class="st">"Polygon"</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>    <span class="cf">else</span>:</span>
<span id="cb5-35"><a href="#cb5-35"></a>        <span class="cf">return</span> <span class="st">"Unknown"</span></span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="kw">def</span> detect_shapes(image):</span>
<span id="cb5-38"><a href="#cb5-38"></a>    <span class="co">"""Detect and classify shapes in an image"""</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>    <span class="co"># Preprocessing</span></span>
<span id="cb5-40"><a href="#cb5-40"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb5-41"><a href="#cb5-41"></a>    blurred <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb5-42"><a href="#cb5-42"></a>    edges <span class="op">=</span> cv2.Canny(blurred, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb5-43"><a href="#cb5-43"></a>    </span>
<span id="cb5-44"><a href="#cb5-44"></a>    <span class="co"># Find contours</span></span>
<span id="cb5-45"><a href="#cb5-45"></a>    contours, _ <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb5-46"><a href="#cb5-46"></a>    </span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="co"># Classify shapes</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb5-49"><a href="#cb5-49"></a>    shape_counts <span class="op">=</span> {}</span>
<span id="cb5-50"><a href="#cb5-50"></a>    </span>
<span id="cb5-51"><a href="#cb5-51"></a>    <span class="cf">for</span> contour <span class="kw">in</span> contours:</span>
<span id="cb5-52"><a href="#cb5-52"></a>        <span class="co"># Skip small contours</span></span>
<span id="cb5-53"><a href="#cb5-53"></a>        <span class="cf">if</span> cv2.contourArea(contour) <span class="op">&lt;</span> <span class="dv">500</span>:</span>
<span id="cb5-54"><a href="#cb5-54"></a>            <span class="cf">continue</span></span>
<span id="cb5-55"><a href="#cb5-55"></a>        </span>
<span id="cb5-56"><a href="#cb5-56"></a>        <span class="co"># Classify the shape</span></span>
<span id="cb5-57"><a href="#cb5-57"></a>        shape <span class="op">=</span> classify_shape(contour)</span>
<span id="cb5-58"><a href="#cb5-58"></a>        </span>
<span id="cb5-59"><a href="#cb5-59"></a>        <span class="co"># Count shapes</span></span>
<span id="cb5-60"><a href="#cb5-60"></a>        shape_counts[shape] <span class="op">=</span> shape_counts.get(shape, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-61"><a href="#cb5-61"></a>        </span>
<span id="cb5-62"><a href="#cb5-62"></a>        <span class="co"># Draw contour and label</span></span>
<span id="cb5-63"><a href="#cb5-63"></a>        cv2.drawContours(result_img, [contour], <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb5-64"><a href="#cb5-64"></a>        </span>
<span id="cb5-65"><a href="#cb5-65"></a>        <span class="co"># Get centroid for text placement</span></span>
<span id="cb5-66"><a href="#cb5-66"></a>        M <span class="op">=</span> cv2.moments(contour)</span>
<span id="cb5-67"><a href="#cb5-67"></a>        <span class="cf">if</span> M[<span class="st">"m00"</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb5-68"><a href="#cb5-68"></a>            cx <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m10"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb5-69"><a href="#cb5-69"></a>            cy <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m01"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb5-70"><a href="#cb5-70"></a>            cv2.putText(result_img, shape, (cx<span class="op">-</span><span class="dv">30</span>, cy), </span>
<span id="cb5-71"><a href="#cb5-71"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.6</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb5-72"><a href="#cb5-72"></a>    </span>
<span id="cb5-73"><a href="#cb5-73"></a>    <span class="cf">return</span> result_img, shape_counts</span>
<span id="cb5-74"><a href="#cb5-74"></a></span>
<span id="cb5-75"><a href="#cb5-75"></a><span class="co"># Test shape detection</span></span>
<span id="cb5-76"><a href="#cb5-76"></a>shapes_img, shape_counts <span class="op">=</span> detect_shapes(img_rgb)</span>
<span id="cb5-77"><a href="#cb5-77"></a></span>
<span id="cb5-78"><a href="#cb5-78"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb5-79"><a href="#cb5-79"></a>plt.imshow(shapes_img)</span>
<span id="cb5-80"><a href="#cb5-80"></a>plt.title(<span class="st">"Shape Detection Results"</span>)</span>
<span id="cb5-81"><a href="#cb5-81"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-82"><a href="#cb5-82"></a>plt.show()</span>
<span id="cb5-83"><a href="#cb5-83"></a></span>
<span id="cb5-84"><a href="#cb5-84"></a><span class="bu">print</span>(<span class="st">"Detected shapes:"</span>)</span>
<span id="cb5-85"><a href="#cb5-85"></a><span class="cf">for</span> shape, count <span class="kw">in</span> shape_counts.items():</span>
<span id="cb5-86"><a href="#cb5-86"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>shape<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="real-world-application-coin-counter" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="real-world-application-coin-counter"><span class="header-section-number">0.6</span> Real-World Application: Coin Counter</h2>
<p>Let’s build something practical—a coin counting system:</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> count_coins(image):</span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="co">"""Count circular objects (coins) in an image"""</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb6-5"><a href="#cb6-5"></a>    </span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="co"># Apply median blur to reduce noise</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>    blurred <span class="op">=</span> cv2.medianBlur(gray, <span class="dv">5</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a>    </span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="co"># Use HoughCircles to detect circular objects</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>    circles <span class="op">=</span> cv2.HoughCircles(</span>
<span id="cb6-11"><a href="#cb6-11"></a>        blurred,</span>
<span id="cb6-12"><a href="#cb6-12"></a>        cv2.HOUGH_GRADIENT,</span>
<span id="cb6-13"><a href="#cb6-13"></a>        dp<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb6-14"><a href="#cb6-14"></a>        minDist<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb6-15"><a href="#cb6-15"></a>        param1<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb6-16"><a href="#cb6-16"></a>        param2<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>        minRadius<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb6-18"><a href="#cb6-18"></a>        maxRadius<span class="op">=</span><span class="dv">100</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>    )</span>
<span id="cb6-20"><a href="#cb6-20"></a>    </span>
<span id="cb6-21"><a href="#cb6-21"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb6-22"><a href="#cb6-22"></a>    coin_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>    </span>
<span id="cb6-24"><a href="#cb6-24"></a>    <span class="cf">if</span> circles <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb6-25"><a href="#cb6-25"></a>        circles <span class="op">=</span> np.<span class="bu">round</span>(circles[<span class="dv">0</span>, :]).astype(<span class="st">"int"</span>)</span>
<span id="cb6-26"><a href="#cb6-26"></a>        coin_count <span class="op">=</span> <span class="bu">len</span>(circles)</span>
<span id="cb6-27"><a href="#cb6-27"></a>        </span>
<span id="cb6-28"><a href="#cb6-28"></a>        <span class="co"># Draw detected circles</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>        <span class="cf">for</span> (x, y, r) <span class="kw">in</span> circles:</span>
<span id="cb6-30"><a href="#cb6-30"></a>            cv2.circle(result_img, (x, y), r, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb6-31"><a href="#cb6-31"></a>            cv2.circle(result_img, (x, y), <span class="dv">2</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), <span class="dv">3</span>)</span>
<span id="cb6-32"><a href="#cb6-32"></a>            cv2.putText(result_img, <span class="ss">f"Coin"</span>, (x<span class="op">-</span><span class="dv">20</span>, y<span class="op">-</span>r<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb6-33"><a href="#cb6-33"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb6-34"><a href="#cb6-34"></a>    </span>
<span id="cb6-35"><a href="#cb6-35"></a>    <span class="cf">return</span> result_img, coin_count</span>
<span id="cb6-36"><a href="#cb6-36"></a></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co"># Test coin counting (works best with images of coins on a plain background)</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>coins_img, coin_count <span class="op">=</span> count_coins(img_rgb)</span>
<span id="cb6-39"><a href="#cb6-39"></a></span>
<span id="cb6-40"><a href="#cb6-40"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb6-41"><a href="#cb6-41"></a>plt.imshow(coins_img)</span>
<span id="cb6-42"><a href="#cb6-42"></a>plt.title(<span class="ss">f"Coin Detection - Found </span><span class="sc">{</span>coin_count<span class="sc">}</span><span class="ss"> coins"</span>)</span>
<span id="cb6-43"><a href="#cb6-43"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb6-44"><a href="#cb6-44"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="advanced-pattern-detection-template-matching" class="level2" data-number="0.7">
<h2 data-number="0.7" class="anchored" data-anchor-id="advanced-pattern-detection-template-matching"><span class="header-section-number">0.7</span> Advanced Pattern Detection: Template Matching</h2>
<p>Sometimes you want to find a specific pattern or object. Template matching is perfect for this:</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">def</span> find_template(image, template, threshold<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="co">"""Find template in image using template matching"""</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="co"># Convert both to grayscale</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    gray_img <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb7-5"><a href="#cb7-5"></a>    gray_template <span class="op">=</span> cv2.cvtColor(template, cv2.COLOR_RGB2GRAY)</span>
<span id="cb7-6"><a href="#cb7-6"></a>    </span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    result <span class="op">=</span> cv2.matchTemplate(gray_img, gray_template, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb7-9"><a href="#cb7-9"></a>    </span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="co"># Find locations where matching exceeds threshold</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>    locations <span class="op">=</span> np.where(result <span class="op">&gt;=</span> threshold)</span>
<span id="cb7-12"><a href="#cb7-12"></a>    </span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="co"># Draw rectangles around matches</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb7-15"><a href="#cb7-15"></a>    h, w <span class="op">=</span> gray_template.shape</span>
<span id="cb7-16"><a href="#cb7-16"></a>    </span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="cf">for</span> pt <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>locations[::<span class="op">-</span><span class="dv">1</span>]):  <span class="co"># Switch x and y coordinates</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>        cv2.rectangle(result_img, pt, (pt[<span class="dv">0</span>] <span class="op">+</span> w, pt[<span class="dv">1</span>] <span class="op">+</span> h), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb7-19"><a href="#cb7-19"></a>    </span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="cf">return</span> result_img, <span class="bu">len</span>(locations[<span class="dv">0</span>])</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"># Create a simple template (you can crop from your image)</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co"># For demo, let's use a small patch from the original image</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>template <span class="op">=</span> img_rgb[<span class="dv">50</span>:<span class="dv">150</span>, <span class="dv">50</span>:<span class="dv">150</span>]  <span class="co"># 100x100 patch</span></span>
<span id="cb7-25"><a href="#cb7-25"></a></span>
<span id="cb7-26"><a href="#cb7-26"></a>matched_img, match_count <span class="op">=</span> find_template(img_rgb, template, threshold<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb7-27"><a href="#cb7-27"></a></span>
<span id="cb7-28"><a href="#cb7-28"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb7-29"><a href="#cb7-29"></a></span>
<span id="cb7-30"><a href="#cb7-30"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb7-31"><a href="#cb7-31"></a>plt.imshow(template)</span>
<span id="cb7-32"><a href="#cb7-32"></a>plt.title(<span class="st">"Template to Find"</span>)</span>
<span id="cb7-33"><a href="#cb7-33"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-34"><a href="#cb7-34"></a></span>
<span id="cb7-35"><a href="#cb7-35"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb7-36"><a href="#cb7-36"></a>plt.imshow(img_rgb)</span>
<span id="cb7-37"><a href="#cb7-37"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb7-38"><a href="#cb7-38"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-39"><a href="#cb7-39"></a></span>
<span id="cb7-40"><a href="#cb7-40"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb7-41"><a href="#cb7-41"></a>plt.imshow(matched_img)</span>
<span id="cb7-42"><a href="#cb7-42"></a>plt.title(<span class="ss">f"Matches Found: </span><span class="sc">{</span>match_count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-43"><a href="#cb7-43"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-44"><a href="#cb7-44"></a></span>
<span id="cb7-45"><a href="#cb7-45"></a>plt.tight_layout()</span>
<span id="cb7-46"><a href="#cb7-46"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-a-complete-object-detection-pipeline" class="level2" data-number="0.8">
<h2 data-number="0.8" class="anchored" data-anchor-id="building-a-complete-object-detection-pipeline"><span class="header-section-number">0.8</span> Building a Complete Object Detection Pipeline</h2>
<p>Let’s combine everything into a comprehensive object detection system:</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">class</span> SimpleObjectDetector:</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb8-3"><a href="#cb8-3"></a>        <span class="va">self</span>.min_contour_area <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>        <span class="va">self</span>.canny_low <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="va">self</span>.canny_high <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    </span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="kw">def</span> preprocess(<span class="va">self</span>, image):</span>
<span id="cb8-8"><a href="#cb8-8"></a>        <span class="co">"""Preprocess image for better detection"""</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb8-10"><a href="#cb8-10"></a>        blurred <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>        <span class="cf">return</span> blurred</span>
<span id="cb8-12"><a href="#cb8-12"></a>    </span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="kw">def</span> find_objects(<span class="va">self</span>, image):</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="co">"""Find all objects in the image"""</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>        <span class="co"># Preprocess</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>        processed <span class="op">=</span> <span class="va">self</span>.preprocess(image)</span>
<span id="cb8-17"><a href="#cb8-17"></a>        </span>
<span id="cb8-18"><a href="#cb8-18"></a>        <span class="co"># Edge detection</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>        edges <span class="op">=</span> cv2.Canny(processed, <span class="va">self</span>.canny_low, <span class="va">self</span>.canny_high)</span>
<span id="cb8-20"><a href="#cb8-20"></a>        </span>
<span id="cb8-21"><a href="#cb8-21"></a>        <span class="co"># Find contours</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>        contours, _ <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb8-23"><a href="#cb8-23"></a>        </span>
<span id="cb8-24"><a href="#cb8-24"></a>        <span class="co"># Filter contours by area</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>        valid_contours <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> contours <span class="cf">if</span> cv2.contourArea(c) <span class="op">&gt;</span> <span class="va">self</span>.min_contour_area]</span>
<span id="cb8-26"><a href="#cb8-26"></a>        </span>
<span id="cb8-27"><a href="#cb8-27"></a>        <span class="cf">return</span> valid_contours, edges</span>
<span id="cb8-28"><a href="#cb8-28"></a>    </span>
<span id="cb8-29"><a href="#cb8-29"></a>    <span class="kw">def</span> analyze_objects(<span class="va">self</span>, contours, image):</span>
<span id="cb8-30"><a href="#cb8-30"></a>        <span class="co">"""Analyze detected objects"""</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>        results <span class="op">=</span> []</span>
<span id="cb8-32"><a href="#cb8-32"></a>        result_img <span class="op">=</span> image.copy()</span>
<span id="cb8-33"><a href="#cb8-33"></a>        </span>
<span id="cb8-34"><a href="#cb8-34"></a>        <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb8-35"><a href="#cb8-35"></a>            <span class="co"># Basic properties</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>            area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb8-37"><a href="#cb8-37"></a>            perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb8-38"><a href="#cb8-38"></a>            </span>
<span id="cb8-39"><a href="#cb8-39"></a>            <span class="co"># Bounding rectangle</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>            x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb8-41"><a href="#cb8-41"></a>            aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb8-42"><a href="#cb8-42"></a>            </span>
<span id="cb8-43"><a href="#cb8-43"></a>            <span class="co"># Shape classification</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>            shape <span class="op">=</span> classify_shape(contour)</span>
<span id="cb8-45"><a href="#cb8-45"></a>            </span>
<span id="cb8-46"><a href="#cb8-46"></a>            <span class="co"># Store results</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>            obj_info <span class="op">=</span> {</span>
<span id="cb8-48"><a href="#cb8-48"></a>                <span class="st">'id'</span>: i,</span>
<span id="cb8-49"><a href="#cb8-49"></a>                <span class="st">'area'</span>: area,</span>
<span id="cb8-50"><a href="#cb8-50"></a>                <span class="st">'perimeter'</span>: perimeter,</span>
<span id="cb8-51"><a href="#cb8-51"></a>                <span class="st">'aspect_ratio'</span>: aspect_ratio,</span>
<span id="cb8-52"><a href="#cb8-52"></a>                <span class="st">'shape'</span>: shape,</span>
<span id="cb8-53"><a href="#cb8-53"></a>                <span class="st">'bbox'</span>: (x, y, w, h)</span>
<span id="cb8-54"><a href="#cb8-54"></a>            }</span>
<span id="cb8-55"><a href="#cb8-55"></a>            results.append(obj_info)</span>
<span id="cb8-56"><a href="#cb8-56"></a>            </span>
<span id="cb8-57"><a href="#cb8-57"></a>            <span class="co"># Draw on image</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>            cv2.drawContours(result_img, [contour], <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb8-59"><a href="#cb8-59"></a>            cv2.rectangle(result_img, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb8-60"><a href="#cb8-60"></a>            cv2.putText(result_img, <span class="ss">f"</span><span class="sc">{</span>shape<span class="sc">}</span><span class="ss"> #</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, (x, y<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb8-61"><a href="#cb8-61"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb8-62"><a href="#cb8-62"></a>        </span>
<span id="cb8-63"><a href="#cb8-63"></a>        <span class="cf">return</span> results, result_img</span>
<span id="cb8-64"><a href="#cb8-64"></a>    </span>
<span id="cb8-65"><a href="#cb8-65"></a>    <span class="kw">def</span> detect(<span class="va">self</span>, image):</span>
<span id="cb8-66"><a href="#cb8-66"></a>        <span class="co">"""Complete detection pipeline"""</span></span>
<span id="cb8-67"><a href="#cb8-67"></a>        contours, edges <span class="op">=</span> <span class="va">self</span>.find_objects(image)</span>
<span id="cb8-68"><a href="#cb8-68"></a>        results, result_img <span class="op">=</span> <span class="va">self</span>.analyze_objects(contours, image)</span>
<span id="cb8-69"><a href="#cb8-69"></a>        </span>
<span id="cb8-70"><a href="#cb8-70"></a>        <span class="cf">return</span> {</span>
<span id="cb8-71"><a href="#cb8-71"></a>            <span class="st">'objects'</span>: results,</span>
<span id="cb8-72"><a href="#cb8-72"></a>            <span class="st">'result_image'</span>: result_img,</span>
<span id="cb8-73"><a href="#cb8-73"></a>            <span class="st">'edges'</span>: edges,</span>
<span id="cb8-74"><a href="#cb8-74"></a>            <span class="st">'object_count'</span>: <span class="bu">len</span>(results)</span>
<span id="cb8-75"><a href="#cb8-75"></a>        }</span>
<span id="cb8-76"><a href="#cb8-76"></a></span>
<span id="cb8-77"><a href="#cb8-77"></a><span class="co"># Use the detector</span></span>
<span id="cb8-78"><a href="#cb8-78"></a>detector <span class="op">=</span> SimpleObjectDetector()</span>
<span id="cb8-79"><a href="#cb8-79"></a>detection_results <span class="op">=</span> detector.detect(img_rgb)</span>
<span id="cb8-80"><a href="#cb8-80"></a></span>
<span id="cb8-81"><a href="#cb8-81"></a><span class="co"># Display results</span></span>
<span id="cb8-82"><a href="#cb8-82"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb8-83"><a href="#cb8-83"></a></span>
<span id="cb8-84"><a href="#cb8-84"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb8-85"><a href="#cb8-85"></a>plt.imshow(img_rgb)</span>
<span id="cb8-86"><a href="#cb8-86"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb8-87"><a href="#cb8-87"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb8-88"><a href="#cb8-88"></a></span>
<span id="cb8-89"><a href="#cb8-89"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb8-90"><a href="#cb8-90"></a>plt.imshow(detection_results[<span class="st">'edges'</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb8-91"><a href="#cb8-91"></a>plt.title(<span class="st">"Edge Detection"</span>)</span>
<span id="cb8-92"><a href="#cb8-92"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb8-93"><a href="#cb8-93"></a></span>
<span id="cb8-94"><a href="#cb8-94"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb8-95"><a href="#cb8-95"></a>plt.imshow(detection_results[<span class="st">'result_image'</span>])</span>
<span id="cb8-96"><a href="#cb8-96"></a>plt.title(<span class="ss">f"Detected Objects: </span><span class="sc">{</span>detection_results[<span class="st">'object_count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-97"><a href="#cb8-97"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb8-98"><a href="#cb8-98"></a></span>
<span id="cb8-99"><a href="#cb8-99"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb8-100"><a href="#cb8-100"></a><span class="co"># Create a summary plot</span></span>
<span id="cb8-101"><a href="#cb8-101"></a>object_shapes <span class="op">=</span> [obj[<span class="st">'shape'</span>] <span class="cf">for</span> obj <span class="kw">in</span> detection_results[<span class="st">'objects'</span>]]</span>
<span id="cb8-102"><a href="#cb8-102"></a>shape_counts <span class="op">=</span> {}</span>
<span id="cb8-103"><a href="#cb8-103"></a><span class="cf">for</span> shape <span class="kw">in</span> object_shapes:</span>
<span id="cb8-104"><a href="#cb8-104"></a>    shape_counts[shape] <span class="op">=</span> shape_counts.get(shape, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-105"><a href="#cb8-105"></a></span>
<span id="cb8-106"><a href="#cb8-106"></a><span class="cf">if</span> shape_counts:</span>
<span id="cb8-107"><a href="#cb8-107"></a>    shapes <span class="op">=</span> <span class="bu">list</span>(shape_counts.keys())</span>
<span id="cb8-108"><a href="#cb8-108"></a>    counts <span class="op">=</span> <span class="bu">list</span>(shape_counts.values())</span>
<span id="cb8-109"><a href="#cb8-109"></a>    plt.bar(shapes, counts)</span>
<span id="cb8-110"><a href="#cb8-110"></a>    plt.title(<span class="st">"Object Type Distribution"</span>)</span>
<span id="cb8-111"><a href="#cb8-111"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb8-112"><a href="#cb8-112"></a><span class="cf">else</span>:</span>
<span id="cb8-113"><a href="#cb8-113"></a>    plt.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">"No objects detected"</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb8-114"><a href="#cb8-114"></a>    plt.title(<span class="st">"No Objects Found"</span>)</span>
<span id="cb8-115"><a href="#cb8-115"></a></span>
<span id="cb8-116"><a href="#cb8-116"></a>plt.tight_layout()</span>
<span id="cb8-117"><a href="#cb8-117"></a>plt.show()</span>
<span id="cb8-118"><a href="#cb8-118"></a></span>
<span id="cb8-119"><a href="#cb8-119"></a><span class="co"># Print detailed results</span></span>
<span id="cb8-120"><a href="#cb8-120"></a><span class="bu">print</span>(<span class="st">"Detection Results:"</span>)</span>
<span id="cb8-121"><a href="#cb8-121"></a><span class="bu">print</span>(<span class="ss">f"Total objects found: </span><span class="sc">{</span>detection_results[<span class="st">'object_count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-122"><a href="#cb8-122"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Object details:"</span>)</span>
<span id="cb8-123"><a href="#cb8-123"></a><span class="cf">for</span> obj <span class="kw">in</span> detection_results[<span class="st">'objects'</span>]:</span>
<span id="cb8-124"><a href="#cb8-124"></a>    <span class="bu">print</span>(<span class="ss">f"  Object </span><span class="sc">{</span>obj[<span class="st">'id'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>obj[<span class="st">'shape'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-125"><a href="#cb8-125"></a>    <span class="bu">print</span>(<span class="ss">f"    Area: </span><span class="sc">{</span>obj[<span class="st">'area'</span>]<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb8-126"><a href="#cb8-126"></a>    <span class="bu">print</span>(<span class="ss">f"    Aspect Ratio: </span><span class="sc">{</span>obj[<span class="st">'aspect_ratio'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb8-127"><a href="#cb8-127"></a>    <span class="bu">print</span>(<span class="ss">f"    Bounding Box: </span><span class="sc">{</span>obj[<span class="st">'bbox'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="your-challenge-build-a-practical-application" class="level2" data-number="0.9">
<h2 data-number="0.9" class="anchored" data-anchor-id="your-challenge-build-a-practical-application"><span class="header-section-number">0.9</span> Your Challenge: Build a Practical Application</h2>
<p>Now it’s your turn! Try building one of these applications:</p>
<section id="challenge-1-document-page-counter" class="level3" data-number="0.9.1">
<h3 data-number="0.9.1" class="anchored" data-anchor-id="challenge-1-document-page-counter"><span class="header-section-number">0.9.1</span> 🎯 <strong>Challenge 1: Document Page Counter</strong></h3>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> count_pages(image):</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co">"""Count rectangular pages/documents in an image"""</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="co"># Your code here!</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="co"># Hint: Look for large rectangular contours</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="challenge-2-parking-space-detector" class="level3" data-number="0.9.2">
<h3 data-number="0.9.2" class="anchored" data-anchor-id="challenge-2-parking-space-detector"><span class="header-section-number">0.9.2</span> 🎯 <strong>Challenge 2: Parking Space Detector</strong></h3>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">def</span> detect_parking_spaces(image):</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="co">"""Detect empty parking spaces (rectangular regions)"""</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>    <span class="co"># Your code here!</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="co"># Hint: Look for rectangular shapes of a certain size</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="challenge-3-playing-card-detector" class="level3" data-number="0.9.3">
<h3 data-number="0.9.3" class="anchored" data-anchor-id="challenge-3-playing-card-detector"><span class="header-section-number">0.9.3</span> 🎯 <strong>Challenge 3: Playing Card Detector</strong></h3>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">def</span> detect_playing_cards(image):</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="co">"""Detect playing cards in an image"""</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="co"># Your code here!</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="co"># Hint: Cards are rectangular with a specific aspect ratio</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="whats-coming-next" class="level2" data-number="0.10">
<h2 data-number="0.10" class="anchored" data-anchor-id="whats-coming-next"><span class="header-section-number">0.10</span> What’s Coming Next?</h2>
<p>In our next adventure, <a href="../05-feature-magic/"><strong>“Feature Magic: What Makes Images Unique”</strong></a>, we’ll explore:</p>
<ul>
<li><strong>Keypoint detection</strong> (finding interesting points)</li>
<li><strong>Feature descriptors</strong> (describing what makes each point unique)</li>
<li><strong>Feature matching</strong> (finding the same object in different images)</li>
<li><strong>Panorama stitching</strong> (combining multiple photos)</li>
</ul>
<p>You’ve just learned to find shapes and patterns—next, we’ll learn to recognize and match them!</p>
</section>
<section id="key-takeaways" class="level2" data-number="0.11">
<h2 data-number="0.11" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">0.11</span> Key Takeaways</h2>
<ul>
<li><strong>Edges are fundamental</strong> to computer vision</li>
<li><strong>Canny edge detection</strong> is the gold standard algorithm</li>
<li><strong>Contours</strong> help us find and analyze shapes</li>
<li><strong>Shape classification</strong> uses geometric properties</li>
<li><strong>Template matching</strong> finds specific patterns</li>
<li><strong>Combining techniques</strong> creates powerful applications</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hands-On Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ready to detect patterns in your own images? Try the complete interactive notebook: <a href="https://colab.research.google.com/drive/1Finding_Patterns_Lab_123456"><strong>Pattern Detection Lab</strong></a></p>
<p>Upload photos and watch your computer find shapes, count objects, and detect patterns!</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Series Navigation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Previous</strong>: <a href="../03-opencv-essentials/">OpenCV Essentials: Your First Computer Vision Toolkit</a></li>
<li><strong>Next</strong>: <a href="../05-feature-magic/">Feature Magic: What Makes Images Unique</a></li>
<li><strong>Series Home</strong>: <a href="../../../posts/series/computer-vision-foundations.html">Computer Vision Foundations</a></li>
</ul>
</div>
</div>
<hr>
<p><em>You’ve just taught computers to see patterns and shapes! This is a huge milestone—you’re now working with the same techniques used in industrial quality control, medical imaging, and autonomous vehicles.</em></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div>CC BY-NC-SA 4.0</div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2025,
  author = {, Hasan},
  title = {Finding {Patterns:} {Edges,} {Contours,} and {Shapes}},
  date = {2025-01-22},
  url = {https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/04-finding-patterns.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Hasan. 2025. <span>“Finding Patterns: Edges, Contours, and
Shapes.”</span> January 22, 2025. <a href="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/04-finding-patterns.html">https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/04-finding-patterns.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="yourusername/quarto_blog_hasan" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<script src="https://giscus.app/client.js" data-repo="HasanGoni/quarto_blog_hasan" data-repo-id="" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">---</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="an">title:</span><span class="co"> "Finding Patterns: Edges, Contours, and Shapes"</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="an">author:</span><span class="co"> "Hasan"</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="an">date:</span><span class="co"> 2025-01-22</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="an">categories:</span><span class="co"> [computer-vision, edge-detection, contours, opencv]</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="an">tags:</span><span class="co"> [canny, contours, shapes, pattern-recognition]</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="an">image:</span><span class="co"> "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2067&amp;q=80"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="an">series:</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">  name: "Computer Vision Foundations"</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">  number: 4</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="an">format:</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">  html: default</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">---</span></span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="fu">## The Detective Story: Teaching Computers to See Patterns</span></span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>Imagine you're a detective looking at a crime scene photo. Your brain instantly picks out:</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="ss">- </span>The outline of a footprint in the mud</span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="ss">- </span>The edge of a broken window</span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="ss">- </span>The shape of a mysterious object on the table</span>
<span id="cb12-23"><a href="#cb12-23"></a></span>
<span id="cb12-24"><a href="#cb12-24"></a>How do you do this so effortlessly? You're detecting **edges** and **patterns**—the fundamental building blocks of vision.</span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a>Today, we're going to teach computers this same superpower. By the end of this post, your computer will be able to find shapes, count objects, and even detect specific patterns in any image!</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="fu">## The Edge Detection Revolution</span></span>
<span id="cb12-29"><a href="#cb12-29"></a></span>
<span id="cb12-30"><a href="#cb12-30"></a>**Edges** are where the magic happens. They're the boundaries between different regions in an image—where one object ends and another begins. Think of them as the "outlines" in a coloring book.</span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="fu">### Why Edges Matter</span></span>
<span id="cb12-33"><a href="#cb12-33"></a></span>
<span id="cb12-34"><a href="#cb12-34"></a>Before we dive into code, let's understand why edge detection changed everything:</span>
<span id="cb12-35"><a href="#cb12-35"></a></span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="ss">- </span>**Object Recognition**: Edges define object boundaries</span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="ss">- </span>**Feature Extraction**: Corners and curves are key features</span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="ss">- </span>**Noise Reduction**: Edges help separate signal from noise</span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="ss">- </span>**Compression**: JPEG uses edge information to compress images</span>
<span id="cb12-40"><a href="#cb12-40"></a></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="fu">## Your First Edge Detector: The Canny Algorithm</span></span>
<span id="cb12-42"><a href="#cb12-42"></a></span>
<span id="cb12-43"><a href="#cb12-43"></a>The **Canny edge detector** is the gold standard—it's been the go-to algorithm for over 30 years! Here's how it works:</span>
<span id="cb12-44"><a href="#cb12-44"></a></span>
<span id="cb12-47"><a href="#cb12-47"></a><span class="in">```{python}</span></span>
<span id="cb12-48"><a href="#cb12-48"></a><span class="co">#| eval: false</span></span>
<span id="cb12-49"><a href="#cb12-49"></a><span class="im">import</span> cv2</span>
<span id="cb12-50"><a href="#cb12-50"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-51"><a href="#cb12-51"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-52"><a href="#cb12-52"></a></span>
<span id="cb12-53"><a href="#cb12-53"></a><span class="co"># Load and prepare image</span></span>
<span id="cb12-54"><a href="#cb12-54"></a>img <span class="op">=</span> cv2.imread(<span class="st">'your_image.jpg'</span>)</span>
<span id="cb12-55"><a href="#cb12-55"></a>img_rgb <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2RGB)</span>
<span id="cb12-56"><a href="#cb12-56"></a>gray <span class="op">=</span> cv2.cvtColor(img_rgb, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-57"><a href="#cb12-57"></a></span>
<span id="cb12-58"><a href="#cb12-58"></a><span class="co"># Apply Canny edge detection</span></span>
<span id="cb12-59"><a href="#cb12-59"></a>edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb12-60"><a href="#cb12-60"></a></span>
<span id="cb12-61"><a href="#cb12-61"></a><span class="co"># Display the results</span></span>
<span id="cb12-62"><a href="#cb12-62"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb12-63"><a href="#cb12-63"></a></span>
<span id="cb12-64"><a href="#cb12-64"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb12-65"><a href="#cb12-65"></a>plt.imshow(img_rgb)</span>
<span id="cb12-66"><a href="#cb12-66"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb12-67"><a href="#cb12-67"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-68"><a href="#cb12-68"></a></span>
<span id="cb12-69"><a href="#cb12-69"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb12-70"><a href="#cb12-70"></a>plt.imshow(gray, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-71"><a href="#cb12-71"></a>plt.title(<span class="st">"Grayscale"</span>)</span>
<span id="cb12-72"><a href="#cb12-72"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-73"><a href="#cb12-73"></a></span>
<span id="cb12-74"><a href="#cb12-74"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb12-75"><a href="#cb12-75"></a>plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-76"><a href="#cb12-76"></a>plt.title(<span class="st">"Canny Edges"</span>)</span>
<span id="cb12-77"><a href="#cb12-77"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-78"><a href="#cb12-78"></a></span>
<span id="cb12-79"><a href="#cb12-79"></a>plt.tight_layout()</span>
<span id="cb12-80"><a href="#cb12-80"></a>plt.show()</span>
<span id="cb12-81"><a href="#cb12-81"></a></span>
<span id="cb12-82"><a href="#cb12-82"></a><span class="bu">print</span>(<span class="ss">f"Found edges in </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(edges <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">}</span><span class="ss"> pixels out of </span><span class="sc">{</span>edges<span class="sc">.</span>size<span class="sc">}</span><span class="ss"> total pixels"</span>)</span>
<span id="cb12-83"><a href="#cb12-83"></a><span class="in">```</span></span>
<span id="cb12-84"><a href="#cb12-84"></a></span>
<span id="cb12-85"><a href="#cb12-85"></a>**🎯 Try it yourself!** <span class="co">[</span><span class="ot">Open in Colab</span><span class="co">](https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-04-finding-patterns.ipynb)</span></span>
<span id="cb12-86"><a href="#cb12-86"></a></span>
<span id="cb12-87"><a href="#cb12-87"></a><span class="fu">### Understanding the Canny Parameters</span></span>
<span id="cb12-88"><a href="#cb12-88"></a></span>
<span id="cb12-89"><a href="#cb12-89"></a>The Canny algorithm has two important parameters—think of them as sensitivity controls:</span>
<span id="cb12-90"><a href="#cb12-90"></a></span>
<span id="cb12-93"><a href="#cb12-93"></a><span class="in">```{python}</span></span>
<span id="cb12-94"><a href="#cb12-94"></a><span class="co">#| eval: false</span></span>
<span id="cb12-95"><a href="#cb12-95"></a><span class="kw">def</span> explore_canny_thresholds(image, low_thresholds, high_thresholds):</span>
<span id="cb12-96"><a href="#cb12-96"></a>    <span class="co">"""Explore different Canny threshold combinations"""</span></span>
<span id="cb12-97"><a href="#cb12-97"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-98"><a href="#cb12-98"></a>    </span>
<span id="cb12-99"><a href="#cb12-99"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb12-100"><a href="#cb12-100"></a>    </span>
<span id="cb12-101"><a href="#cb12-101"></a>    plot_idx <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-102"><a href="#cb12-102"></a>    <span class="cf">for</span> low <span class="kw">in</span> low_thresholds:</span>
<span id="cb12-103"><a href="#cb12-103"></a>        <span class="cf">for</span> high <span class="kw">in</span> high_thresholds:</span>
<span id="cb12-104"><a href="#cb12-104"></a>            edges <span class="op">=</span> cv2.Canny(gray, low, high)</span>
<span id="cb12-105"><a href="#cb12-105"></a>            </span>
<span id="cb12-106"><a href="#cb12-106"></a>            plt.subplot(<span class="bu">len</span>(low_thresholds), <span class="bu">len</span>(high_thresholds), plot_idx)</span>
<span id="cb12-107"><a href="#cb12-107"></a>            plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-108"><a href="#cb12-108"></a>            plt.title(<span class="ss">f"Low: </span><span class="sc">{</span>low<span class="sc">}</span><span class="ss">, High: </span><span class="sc">{</span>high<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-109"><a href="#cb12-109"></a>            plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-110"><a href="#cb12-110"></a>            </span>
<span id="cb12-111"><a href="#cb12-111"></a>            plot_idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-112"><a href="#cb12-112"></a>    </span>
<span id="cb12-113"><a href="#cb12-113"></a>    plt.tight_layout()</span>
<span id="cb12-114"><a href="#cb12-114"></a>    plt.show()</span>
<span id="cb12-115"><a href="#cb12-115"></a></span>
<span id="cb12-116"><a href="#cb12-116"></a><span class="co"># Test different threshold combinations</span></span>
<span id="cb12-117"><a href="#cb12-117"></a>low_thresholds <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>]</span>
<span id="cb12-118"><a href="#cb12-118"></a>high_thresholds <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>]</span>
<span id="cb12-119"><a href="#cb12-119"></a>explore_canny_thresholds(img_rgb, low_thresholds, high_thresholds)</span>
<span id="cb12-120"><a href="#cb12-120"></a><span class="in">```</span></span>
<span id="cb12-121"><a href="#cb12-121"></a></span>
<span id="cb12-122"><a href="#cb12-122"></a><span class="fu">### The Magic Behind Canny</span></span>
<span id="cb12-123"><a href="#cb12-123"></a></span>
<span id="cb12-124"><a href="#cb12-124"></a>Here's what happens inside the Canny algorithm (don't worry, OpenCV does this for you!):</span>
<span id="cb12-125"><a href="#cb12-125"></a></span>
<span id="cb12-126"><a href="#cb12-126"></a><span class="ss">1. </span>**Blur** the image to reduce noise</span>
<span id="cb12-127"><a href="#cb12-127"></a><span class="ss">2. </span>**Calculate gradients** to find intensity changes</span>
<span id="cb12-128"><a href="#cb12-128"></a><span class="ss">3. </span>**Non-maximum suppression** to thin the edges</span>
<span id="cb12-129"><a href="#cb12-129"></a><span class="ss">4. </span>**Double thresholding** to classify edge pixels</span>
<span id="cb12-130"><a href="#cb12-130"></a><span class="ss">5. </span>**Edge tracking** to connect broken edge segments</span>
<span id="cb12-131"><a href="#cb12-131"></a></span>
<span id="cb12-132"><a href="#cb12-132"></a><span class="fu">## From Edges to Shapes: Contour Detection</span></span>
<span id="cb12-133"><a href="#cb12-133"></a></span>
<span id="cb12-134"><a href="#cb12-134"></a>Edges are great, but **contours** are even better! A contour is a curve that connects all the edge points around an object's boundary. Think of it as tracing around objects with your finger.</span>
<span id="cb12-135"><a href="#cb12-135"></a></span>
<span id="cb12-138"><a href="#cb12-138"></a><span class="in">```{python}</span></span>
<span id="cb12-139"><a href="#cb12-139"></a><span class="co">#| eval: false</span></span>
<span id="cb12-140"><a href="#cb12-140"></a><span class="co"># Find edges first</span></span>
<span id="cb12-141"><a href="#cb12-141"></a>gray <span class="op">=</span> cv2.cvtColor(img_rgb, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-142"><a href="#cb12-142"></a>edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb12-143"><a href="#cb12-143"></a></span>
<span id="cb12-144"><a href="#cb12-144"></a><span class="co"># Find contours</span></span>
<span id="cb12-145"><a href="#cb12-145"></a>contours, hierarchy <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb12-146"><a href="#cb12-146"></a></span>
<span id="cb12-147"><a href="#cb12-147"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(contours)<span class="sc">}</span><span class="ss"> contours!"</span>)</span>
<span id="cb12-148"><a href="#cb12-148"></a></span>
<span id="cb12-149"><a href="#cb12-149"></a><span class="co"># Draw contours on the original image</span></span>
<span id="cb12-150"><a href="#cb12-150"></a>img_with_contours <span class="op">=</span> img_rgb.copy()</span>
<span id="cb12-151"><a href="#cb12-151"></a>cv2.drawContours(img_with_contours, contours, <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-152"><a href="#cb12-152"></a></span>
<span id="cb12-153"><a href="#cb12-153"></a><span class="co"># Display results</span></span>
<span id="cb12-154"><a href="#cb12-154"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb12-155"><a href="#cb12-155"></a></span>
<span id="cb12-156"><a href="#cb12-156"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb12-157"><a href="#cb12-157"></a>plt.imshow(img_rgb)</span>
<span id="cb12-158"><a href="#cb12-158"></a>plt.title(<span class="st">"Original"</span>)</span>
<span id="cb12-159"><a href="#cb12-159"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-160"><a href="#cb12-160"></a></span>
<span id="cb12-161"><a href="#cb12-161"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb12-162"><a href="#cb12-162"></a>plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-163"><a href="#cb12-163"></a>plt.title(<span class="st">"Edges"</span>)</span>
<span id="cb12-164"><a href="#cb12-164"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-165"><a href="#cb12-165"></a></span>
<span id="cb12-166"><a href="#cb12-166"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb12-167"><a href="#cb12-167"></a>plt.imshow(img_with_contours)</span>
<span id="cb12-168"><a href="#cb12-168"></a>plt.title(<span class="ss">f"Contours (</span><span class="sc">{</span><span class="bu">len</span>(contours)<span class="sc">}</span><span class="ss"> found)"</span>)</span>
<span id="cb12-169"><a href="#cb12-169"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-170"><a href="#cb12-170"></a></span>
<span id="cb12-171"><a href="#cb12-171"></a>plt.tight_layout()</span>
<span id="cb12-172"><a href="#cb12-172"></a>plt.show()</span>
<span id="cb12-173"><a href="#cb12-173"></a><span class="in">```</span></span>
<span id="cb12-174"><a href="#cb12-174"></a></span>
<span id="cb12-175"><a href="#cb12-175"></a><span class="fu">### Analyzing Contour Properties</span></span>
<span id="cb12-176"><a href="#cb12-176"></a></span>
<span id="cb12-177"><a href="#cb12-177"></a>Once we have contours, we can learn a lot about each shape:</span>
<span id="cb12-178"><a href="#cb12-178"></a></span>
<span id="cb12-181"><a href="#cb12-181"></a><span class="in">```{python}</span></span>
<span id="cb12-182"><a href="#cb12-182"></a><span class="co">#| eval: false</span></span>
<span id="cb12-183"><a href="#cb12-183"></a><span class="kw">def</span> analyze_contours(contours, image):</span>
<span id="cb12-184"><a href="#cb12-184"></a>    <span class="co">"""Analyze properties of each contour"""</span></span>
<span id="cb12-185"><a href="#cb12-185"></a>    img_analysis <span class="op">=</span> image.copy()</span>
<span id="cb12-186"><a href="#cb12-186"></a>    </span>
<span id="cb12-187"><a href="#cb12-187"></a>    <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb12-188"><a href="#cb12-188"></a>        <span class="co"># Calculate contour properties</span></span>
<span id="cb12-189"><a href="#cb12-189"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb12-190"><a href="#cb12-190"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb12-191"><a href="#cb12-191"></a>        </span>
<span id="cb12-192"><a href="#cb12-192"></a>        <span class="co"># Skip tiny contours (probably noise)</span></span>
<span id="cb12-193"><a href="#cb12-193"></a>        <span class="cf">if</span> area <span class="op">&lt;</span> <span class="dv">100</span>:</span>
<span id="cb12-194"><a href="#cb12-194"></a>            <span class="cf">continue</span></span>
<span id="cb12-195"><a href="#cb12-195"></a>        </span>
<span id="cb12-196"><a href="#cb12-196"></a>        <span class="co"># Get bounding rectangle</span></span>
<span id="cb12-197"><a href="#cb12-197"></a>        x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb12-198"><a href="#cb12-198"></a>        </span>
<span id="cb12-199"><a href="#cb12-199"></a>        <span class="co"># Calculate aspect ratio</span></span>
<span id="cb12-200"><a href="#cb12-200"></a>        aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb12-201"><a href="#cb12-201"></a>        </span>
<span id="cb12-202"><a href="#cb12-202"></a>        <span class="co"># Calculate extent (contour area / bounding rectangle area)</span></span>
<span id="cb12-203"><a href="#cb12-203"></a>        rect_area <span class="op">=</span> w <span class="op">*</span> h</span>
<span id="cb12-204"><a href="#cb12-204"></a>        extent <span class="op">=</span> <span class="bu">float</span>(area) <span class="op">/</span> rect_area</span>
<span id="cb12-205"><a href="#cb12-205"></a>        </span>
<span id="cb12-206"><a href="#cb12-206"></a>        <span class="co"># Draw bounding rectangle</span></span>
<span id="cb12-207"><a href="#cb12-207"></a>        cv2.rectangle(img_analysis, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-208"><a href="#cb12-208"></a>        </span>
<span id="cb12-209"><a href="#cb12-209"></a>        <span class="co"># Add text with properties</span></span>
<span id="cb12-210"><a href="#cb12-210"></a>        text <span class="op">=</span> <span class="ss">f"#</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: A=</span><span class="sc">{</span><span class="bu">int</span>(area)<span class="sc">}</span><span class="ss">, AR=</span><span class="sc">{</span>aspect_ratio<span class="sc">:.2f}</span><span class="ss">"</span></span>
<span id="cb12-211"><a href="#cb12-211"></a>        cv2.putText(img_analysis, text, (x, y<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb12-212"><a href="#cb12-212"></a>                   cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb12-213"><a href="#cb12-213"></a>        </span>
<span id="cb12-214"><a href="#cb12-214"></a>        <span class="bu">print</span>(<span class="ss">f"Contour </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb12-215"><a href="#cb12-215"></a>        <span class="bu">print</span>(<span class="ss">f"  Area: </span><span class="sc">{</span>area<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb12-216"><a href="#cb12-216"></a>        <span class="bu">print</span>(<span class="ss">f"  Perimeter: </span><span class="sc">{</span>perimeter<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb12-217"><a href="#cb12-217"></a>        <span class="bu">print</span>(<span class="ss">f"  Aspect Ratio: </span><span class="sc">{</span>aspect_ratio<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-218"><a href="#cb12-218"></a>        <span class="bu">print</span>(<span class="ss">f"  Extent: </span><span class="sc">{</span>extent<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-219"><a href="#cb12-219"></a>        <span class="bu">print</span>()</span>
<span id="cb12-220"><a href="#cb12-220"></a>    </span>
<span id="cb12-221"><a href="#cb12-221"></a>    <span class="cf">return</span> img_analysis</span>
<span id="cb12-222"><a href="#cb12-222"></a></span>
<span id="cb12-223"><a href="#cb12-223"></a><span class="co"># Analyze our contours</span></span>
<span id="cb12-224"><a href="#cb12-224"></a>analyzed_img <span class="op">=</span> analyze_contours(contours, img_rgb)</span>
<span id="cb12-225"><a href="#cb12-225"></a></span>
<span id="cb12-226"><a href="#cb12-226"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb12-227"><a href="#cb12-227"></a>plt.imshow(analyzed_img)</span>
<span id="cb12-228"><a href="#cb12-228"></a>plt.title(<span class="st">"Contour Analysis"</span>)</span>
<span id="cb12-229"><a href="#cb12-229"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-230"><a href="#cb12-230"></a>plt.show()</span>
<span id="cb12-231"><a href="#cb12-231"></a><span class="in">```</span></span>
<span id="cb12-232"><a href="#cb12-232"></a></span>
<span id="cb12-233"><a href="#cb12-233"></a><span class="fu">## Shape Detection: Teaching Computers Geometry</span></span>
<span id="cb12-234"><a href="#cb12-234"></a></span>
<span id="cb12-235"><a href="#cb12-235"></a>Now for the really cool part—detecting specific shapes! Let's build a shape classifier:</span>
<span id="cb12-236"><a href="#cb12-236"></a></span>
<span id="cb12-239"><a href="#cb12-239"></a><span class="in">```{python}</span></span>
<span id="cb12-240"><a href="#cb12-240"></a><span class="co">#| eval: false</span></span>
<span id="cb12-241"><a href="#cb12-241"></a><span class="kw">def</span> classify_shape(contour):</span>
<span id="cb12-242"><a href="#cb12-242"></a>    <span class="co">"""Classify a contour as a specific shape"""</span></span>
<span id="cb12-243"><a href="#cb12-243"></a>    <span class="co"># Approximate the contour to reduce number of points</span></span>
<span id="cb12-244"><a href="#cb12-244"></a>    epsilon <span class="op">=</span> <span class="fl">0.02</span> <span class="op">*</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb12-245"><a href="#cb12-245"></a>    approx <span class="op">=</span> cv2.approxPolyDP(contour, epsilon, <span class="va">True</span>)</span>
<span id="cb12-246"><a href="#cb12-246"></a>    </span>
<span id="cb12-247"><a href="#cb12-247"></a>    <span class="co"># Get number of vertices</span></span>
<span id="cb12-248"><a href="#cb12-248"></a>    vertices <span class="op">=</span> <span class="bu">len</span>(approx)</span>
<span id="cb12-249"><a href="#cb12-249"></a>    </span>
<span id="cb12-250"><a href="#cb12-250"></a>    <span class="co"># Calculate aspect ratio</span></span>
<span id="cb12-251"><a href="#cb12-251"></a>    x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb12-252"><a href="#cb12-252"></a>    aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb12-253"><a href="#cb12-253"></a>    </span>
<span id="cb12-254"><a href="#cb12-254"></a>    <span class="co"># Classify based on number of vertices and aspect ratio</span></span>
<span id="cb12-255"><a href="#cb12-255"></a>    <span class="cf">if</span> vertices <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb12-256"><a href="#cb12-256"></a>        <span class="cf">return</span> <span class="st">"Triangle"</span></span>
<span id="cb12-257"><a href="#cb12-257"></a>    <span class="cf">elif</span> vertices <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb12-258"><a href="#cb12-258"></a>        <span class="cf">if</span> <span class="fl">0.95</span> <span class="op">&lt;=</span> aspect_ratio <span class="op">&lt;=</span> <span class="fl">1.05</span>:</span>
<span id="cb12-259"><a href="#cb12-259"></a>            <span class="cf">return</span> <span class="st">"Square"</span></span>
<span id="cb12-260"><a href="#cb12-260"></a>        <span class="cf">else</span>:</span>
<span id="cb12-261"><a href="#cb12-261"></a>            <span class="cf">return</span> <span class="st">"Rectangle"</span></span>
<span id="cb12-262"><a href="#cb12-262"></a>    <span class="cf">elif</span> vertices <span class="op">==</span> <span class="dv">5</span>:</span>
<span id="cb12-263"><a href="#cb12-263"></a>        <span class="cf">return</span> <span class="st">"Pentagon"</span></span>
<span id="cb12-264"><a href="#cb12-264"></a>    <span class="cf">elif</span> vertices <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb12-265"><a href="#cb12-265"></a>        <span class="co"># Check if it's circular</span></span>
<span id="cb12-266"><a href="#cb12-266"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb12-267"><a href="#cb12-267"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb12-268"><a href="#cb12-268"></a>        circularity <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> np.pi <span class="op">*</span> area <span class="op">/</span> (perimeter <span class="op">*</span> perimeter)</span>
<span id="cb12-269"><a href="#cb12-269"></a>        </span>
<span id="cb12-270"><a href="#cb12-270"></a>        <span class="cf">if</span> circularity <span class="op">&gt;</span> <span class="fl">0.7</span>:</span>
<span id="cb12-271"><a href="#cb12-271"></a>            <span class="cf">return</span> <span class="st">"Circle"</span></span>
<span id="cb12-272"><a href="#cb12-272"></a>        <span class="cf">else</span>:</span>
<span id="cb12-273"><a href="#cb12-273"></a>            <span class="cf">return</span> <span class="st">"Polygon"</span></span>
<span id="cb12-274"><a href="#cb12-274"></a>    <span class="cf">else</span>:</span>
<span id="cb12-275"><a href="#cb12-275"></a>        <span class="cf">return</span> <span class="st">"Unknown"</span></span>
<span id="cb12-276"><a href="#cb12-276"></a></span>
<span id="cb12-277"><a href="#cb12-277"></a><span class="kw">def</span> detect_shapes(image):</span>
<span id="cb12-278"><a href="#cb12-278"></a>    <span class="co">"""Detect and classify shapes in an image"""</span></span>
<span id="cb12-279"><a href="#cb12-279"></a>    <span class="co"># Preprocessing</span></span>
<span id="cb12-280"><a href="#cb12-280"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-281"><a href="#cb12-281"></a>    blurred <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb12-282"><a href="#cb12-282"></a>    edges <span class="op">=</span> cv2.Canny(blurred, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb12-283"><a href="#cb12-283"></a>    </span>
<span id="cb12-284"><a href="#cb12-284"></a>    <span class="co"># Find contours</span></span>
<span id="cb12-285"><a href="#cb12-285"></a>    contours, _ <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb12-286"><a href="#cb12-286"></a>    </span>
<span id="cb12-287"><a href="#cb12-287"></a>    <span class="co"># Classify shapes</span></span>
<span id="cb12-288"><a href="#cb12-288"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb12-289"><a href="#cb12-289"></a>    shape_counts <span class="op">=</span> {}</span>
<span id="cb12-290"><a href="#cb12-290"></a>    </span>
<span id="cb12-291"><a href="#cb12-291"></a>    <span class="cf">for</span> contour <span class="kw">in</span> contours:</span>
<span id="cb12-292"><a href="#cb12-292"></a>        <span class="co"># Skip small contours</span></span>
<span id="cb12-293"><a href="#cb12-293"></a>        <span class="cf">if</span> cv2.contourArea(contour) <span class="op">&lt;</span> <span class="dv">500</span>:</span>
<span id="cb12-294"><a href="#cb12-294"></a>            <span class="cf">continue</span></span>
<span id="cb12-295"><a href="#cb12-295"></a>        </span>
<span id="cb12-296"><a href="#cb12-296"></a>        <span class="co"># Classify the shape</span></span>
<span id="cb12-297"><a href="#cb12-297"></a>        shape <span class="op">=</span> classify_shape(contour)</span>
<span id="cb12-298"><a href="#cb12-298"></a>        </span>
<span id="cb12-299"><a href="#cb12-299"></a>        <span class="co"># Count shapes</span></span>
<span id="cb12-300"><a href="#cb12-300"></a>        shape_counts[shape] <span class="op">=</span> shape_counts.get(shape, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb12-301"><a href="#cb12-301"></a>        </span>
<span id="cb12-302"><a href="#cb12-302"></a>        <span class="co"># Draw contour and label</span></span>
<span id="cb12-303"><a href="#cb12-303"></a>        cv2.drawContours(result_img, [contour], <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-304"><a href="#cb12-304"></a>        </span>
<span id="cb12-305"><a href="#cb12-305"></a>        <span class="co"># Get centroid for text placement</span></span>
<span id="cb12-306"><a href="#cb12-306"></a>        M <span class="op">=</span> cv2.moments(contour)</span>
<span id="cb12-307"><a href="#cb12-307"></a>        <span class="cf">if</span> M[<span class="st">"m00"</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb12-308"><a href="#cb12-308"></a>            cx <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m10"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb12-309"><a href="#cb12-309"></a>            cy <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m01"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb12-310"><a href="#cb12-310"></a>            cv2.putText(result_img, shape, (cx<span class="op">-</span><span class="dv">30</span>, cy), </span>
<span id="cb12-311"><a href="#cb12-311"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.6</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-312"><a href="#cb12-312"></a>    </span>
<span id="cb12-313"><a href="#cb12-313"></a>    <span class="cf">return</span> result_img, shape_counts</span>
<span id="cb12-314"><a href="#cb12-314"></a></span>
<span id="cb12-315"><a href="#cb12-315"></a><span class="co"># Test shape detection</span></span>
<span id="cb12-316"><a href="#cb12-316"></a>shapes_img, shape_counts <span class="op">=</span> detect_shapes(img_rgb)</span>
<span id="cb12-317"><a href="#cb12-317"></a></span>
<span id="cb12-318"><a href="#cb12-318"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb12-319"><a href="#cb12-319"></a>plt.imshow(shapes_img)</span>
<span id="cb12-320"><a href="#cb12-320"></a>plt.title(<span class="st">"Shape Detection Results"</span>)</span>
<span id="cb12-321"><a href="#cb12-321"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-322"><a href="#cb12-322"></a>plt.show()</span>
<span id="cb12-323"><a href="#cb12-323"></a></span>
<span id="cb12-324"><a href="#cb12-324"></a><span class="bu">print</span>(<span class="st">"Detected shapes:"</span>)</span>
<span id="cb12-325"><a href="#cb12-325"></a><span class="cf">for</span> shape, count <span class="kw">in</span> shape_counts.items():</span>
<span id="cb12-326"><a href="#cb12-326"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>shape<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-327"><a href="#cb12-327"></a><span class="in">```</span></span>
<span id="cb12-328"><a href="#cb12-328"></a></span>
<span id="cb12-329"><a href="#cb12-329"></a><span class="fu">## Real-World Application: Coin Counter</span></span>
<span id="cb12-330"><a href="#cb12-330"></a></span>
<span id="cb12-331"><a href="#cb12-331"></a>Let's build something practical—a coin counting system:</span>
<span id="cb12-332"><a href="#cb12-332"></a></span>
<span id="cb12-335"><a href="#cb12-335"></a><span class="in">```{python}</span></span>
<span id="cb12-336"><a href="#cb12-336"></a><span class="co">#| eval: false</span></span>
<span id="cb12-337"><a href="#cb12-337"></a><span class="kw">def</span> count_coins(image):</span>
<span id="cb12-338"><a href="#cb12-338"></a>    <span class="co">"""Count circular objects (coins) in an image"""</span></span>
<span id="cb12-339"><a href="#cb12-339"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb12-340"><a href="#cb12-340"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-341"><a href="#cb12-341"></a>    </span>
<span id="cb12-342"><a href="#cb12-342"></a>    <span class="co"># Apply median blur to reduce noise</span></span>
<span id="cb12-343"><a href="#cb12-343"></a>    blurred <span class="op">=</span> cv2.medianBlur(gray, <span class="dv">5</span>)</span>
<span id="cb12-344"><a href="#cb12-344"></a>    </span>
<span id="cb12-345"><a href="#cb12-345"></a>    <span class="co"># Use HoughCircles to detect circular objects</span></span>
<span id="cb12-346"><a href="#cb12-346"></a>    circles <span class="op">=</span> cv2.HoughCircles(</span>
<span id="cb12-347"><a href="#cb12-347"></a>        blurred,</span>
<span id="cb12-348"><a href="#cb12-348"></a>        cv2.HOUGH_GRADIENT,</span>
<span id="cb12-349"><a href="#cb12-349"></a>        dp<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb12-350"><a href="#cb12-350"></a>        minDist<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb12-351"><a href="#cb12-351"></a>        param1<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb12-352"><a href="#cb12-352"></a>        param2<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb12-353"><a href="#cb12-353"></a>        minRadius<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb12-354"><a href="#cb12-354"></a>        maxRadius<span class="op">=</span><span class="dv">100</span></span>
<span id="cb12-355"><a href="#cb12-355"></a>    )</span>
<span id="cb12-356"><a href="#cb12-356"></a>    </span>
<span id="cb12-357"><a href="#cb12-357"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb12-358"><a href="#cb12-358"></a>    coin_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-359"><a href="#cb12-359"></a>    </span>
<span id="cb12-360"><a href="#cb12-360"></a>    <span class="cf">if</span> circles <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb12-361"><a href="#cb12-361"></a>        circles <span class="op">=</span> np.<span class="bu">round</span>(circles[<span class="dv">0</span>, :]).astype(<span class="st">"int"</span>)</span>
<span id="cb12-362"><a href="#cb12-362"></a>        coin_count <span class="op">=</span> <span class="bu">len</span>(circles)</span>
<span id="cb12-363"><a href="#cb12-363"></a>        </span>
<span id="cb12-364"><a href="#cb12-364"></a>        <span class="co"># Draw detected circles</span></span>
<span id="cb12-365"><a href="#cb12-365"></a>        <span class="cf">for</span> (x, y, r) <span class="kw">in</span> circles:</span>
<span id="cb12-366"><a href="#cb12-366"></a>            cv2.circle(result_img, (x, y), r, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-367"><a href="#cb12-367"></a>            cv2.circle(result_img, (x, y), <span class="dv">2</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), <span class="dv">3</span>)</span>
<span id="cb12-368"><a href="#cb12-368"></a>            cv2.putText(result_img, <span class="ss">f"Coin"</span>, (x<span class="op">-</span><span class="dv">20</span>, y<span class="op">-</span>r<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb12-369"><a href="#cb12-369"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb12-370"><a href="#cb12-370"></a>    </span>
<span id="cb12-371"><a href="#cb12-371"></a>    <span class="cf">return</span> result_img, coin_count</span>
<span id="cb12-372"><a href="#cb12-372"></a></span>
<span id="cb12-373"><a href="#cb12-373"></a><span class="co"># Test coin counting (works best with images of coins on a plain background)</span></span>
<span id="cb12-374"><a href="#cb12-374"></a>coins_img, coin_count <span class="op">=</span> count_coins(img_rgb)</span>
<span id="cb12-375"><a href="#cb12-375"></a></span>
<span id="cb12-376"><a href="#cb12-376"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb12-377"><a href="#cb12-377"></a>plt.imshow(coins_img)</span>
<span id="cb12-378"><a href="#cb12-378"></a>plt.title(<span class="ss">f"Coin Detection - Found </span><span class="sc">{</span>coin_count<span class="sc">}</span><span class="ss"> coins"</span>)</span>
<span id="cb12-379"><a href="#cb12-379"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-380"><a href="#cb12-380"></a>plt.show()</span>
<span id="cb12-381"><a href="#cb12-381"></a><span class="in">```</span></span>
<span id="cb12-382"><a href="#cb12-382"></a></span>
<span id="cb12-383"><a href="#cb12-383"></a><span class="fu">## Advanced Pattern Detection: Template Matching</span></span>
<span id="cb12-384"><a href="#cb12-384"></a></span>
<span id="cb12-385"><a href="#cb12-385"></a>Sometimes you want to find a specific pattern or object. Template matching is perfect for this:</span>
<span id="cb12-386"><a href="#cb12-386"></a></span>
<span id="cb12-389"><a href="#cb12-389"></a><span class="in">```{python}</span></span>
<span id="cb12-390"><a href="#cb12-390"></a><span class="co">#| eval: false</span></span>
<span id="cb12-391"><a href="#cb12-391"></a><span class="kw">def</span> find_template(image, template, threshold<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb12-392"><a href="#cb12-392"></a>    <span class="co">"""Find template in image using template matching"""</span></span>
<span id="cb12-393"><a href="#cb12-393"></a>    <span class="co"># Convert both to grayscale</span></span>
<span id="cb12-394"><a href="#cb12-394"></a>    gray_img <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-395"><a href="#cb12-395"></a>    gray_template <span class="op">=</span> cv2.cvtColor(template, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-396"><a href="#cb12-396"></a>    </span>
<span id="cb12-397"><a href="#cb12-397"></a>    <span class="co"># Perform template matching</span></span>
<span id="cb12-398"><a href="#cb12-398"></a>    result <span class="op">=</span> cv2.matchTemplate(gray_img, gray_template, cv2.TM_CCOEFF_NORMED)</span>
<span id="cb12-399"><a href="#cb12-399"></a>    </span>
<span id="cb12-400"><a href="#cb12-400"></a>    <span class="co"># Find locations where matching exceeds threshold</span></span>
<span id="cb12-401"><a href="#cb12-401"></a>    locations <span class="op">=</span> np.where(result <span class="op">&gt;=</span> threshold)</span>
<span id="cb12-402"><a href="#cb12-402"></a>    </span>
<span id="cb12-403"><a href="#cb12-403"></a>    <span class="co"># Draw rectangles around matches</span></span>
<span id="cb12-404"><a href="#cb12-404"></a>    result_img <span class="op">=</span> image.copy()</span>
<span id="cb12-405"><a href="#cb12-405"></a>    h, w <span class="op">=</span> gray_template.shape</span>
<span id="cb12-406"><a href="#cb12-406"></a>    </span>
<span id="cb12-407"><a href="#cb12-407"></a>    <span class="cf">for</span> pt <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>locations[::<span class="op">-</span><span class="dv">1</span>]):  <span class="co"># Switch x and y coordinates</span></span>
<span id="cb12-408"><a href="#cb12-408"></a>        cv2.rectangle(result_img, pt, (pt[<span class="dv">0</span>] <span class="op">+</span> w, pt[<span class="dv">1</span>] <span class="op">+</span> h), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-409"><a href="#cb12-409"></a>    </span>
<span id="cb12-410"><a href="#cb12-410"></a>    <span class="cf">return</span> result_img, <span class="bu">len</span>(locations[<span class="dv">0</span>])</span>
<span id="cb12-411"><a href="#cb12-411"></a></span>
<span id="cb12-412"><a href="#cb12-412"></a><span class="co"># Create a simple template (you can crop from your image)</span></span>
<span id="cb12-413"><a href="#cb12-413"></a><span class="co"># For demo, let's use a small patch from the original image</span></span>
<span id="cb12-414"><a href="#cb12-414"></a>template <span class="op">=</span> img_rgb[<span class="dv">50</span>:<span class="dv">150</span>, <span class="dv">50</span>:<span class="dv">150</span>]  <span class="co"># 100x100 patch</span></span>
<span id="cb12-415"><a href="#cb12-415"></a></span>
<span id="cb12-416"><a href="#cb12-416"></a>matched_img, match_count <span class="op">=</span> find_template(img_rgb, template, threshold<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb12-417"><a href="#cb12-417"></a></span>
<span id="cb12-418"><a href="#cb12-418"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb12-419"><a href="#cb12-419"></a></span>
<span id="cb12-420"><a href="#cb12-420"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb12-421"><a href="#cb12-421"></a>plt.imshow(template)</span>
<span id="cb12-422"><a href="#cb12-422"></a>plt.title(<span class="st">"Template to Find"</span>)</span>
<span id="cb12-423"><a href="#cb12-423"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-424"><a href="#cb12-424"></a></span>
<span id="cb12-425"><a href="#cb12-425"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb12-426"><a href="#cb12-426"></a>plt.imshow(img_rgb)</span>
<span id="cb12-427"><a href="#cb12-427"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb12-428"><a href="#cb12-428"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-429"><a href="#cb12-429"></a></span>
<span id="cb12-430"><a href="#cb12-430"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb12-431"><a href="#cb12-431"></a>plt.imshow(matched_img)</span>
<span id="cb12-432"><a href="#cb12-432"></a>plt.title(<span class="ss">f"Matches Found: </span><span class="sc">{</span>match_count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-433"><a href="#cb12-433"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-434"><a href="#cb12-434"></a></span>
<span id="cb12-435"><a href="#cb12-435"></a>plt.tight_layout()</span>
<span id="cb12-436"><a href="#cb12-436"></a>plt.show()</span>
<span id="cb12-437"><a href="#cb12-437"></a><span class="in">```</span></span>
<span id="cb12-438"><a href="#cb12-438"></a></span>
<span id="cb12-439"><a href="#cb12-439"></a><span class="fu">## Building a Complete Object Detection Pipeline</span></span>
<span id="cb12-440"><a href="#cb12-440"></a></span>
<span id="cb12-441"><a href="#cb12-441"></a>Let's combine everything into a comprehensive object detection system:</span>
<span id="cb12-442"><a href="#cb12-442"></a></span>
<span id="cb12-445"><a href="#cb12-445"></a><span class="in">```{python}</span></span>
<span id="cb12-446"><a href="#cb12-446"></a><span class="co">#| eval: false</span></span>
<span id="cb12-447"><a href="#cb12-447"></a><span class="kw">class</span> SimpleObjectDetector:</span>
<span id="cb12-448"><a href="#cb12-448"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb12-449"><a href="#cb12-449"></a>        <span class="va">self</span>.min_contour_area <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb12-450"><a href="#cb12-450"></a>        <span class="va">self</span>.canny_low <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb12-451"><a href="#cb12-451"></a>        <span class="va">self</span>.canny_high <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb12-452"><a href="#cb12-452"></a>    </span>
<span id="cb12-453"><a href="#cb12-453"></a>    <span class="kw">def</span> preprocess(<span class="va">self</span>, image):</span>
<span id="cb12-454"><a href="#cb12-454"></a>        <span class="co">"""Preprocess image for better detection"""</span></span>
<span id="cb12-455"><a href="#cb12-455"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-456"><a href="#cb12-456"></a>        blurred <span class="op">=</span> cv2.GaussianBlur(gray, (<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>)</span>
<span id="cb12-457"><a href="#cb12-457"></a>        <span class="cf">return</span> blurred</span>
<span id="cb12-458"><a href="#cb12-458"></a>    </span>
<span id="cb12-459"><a href="#cb12-459"></a>    <span class="kw">def</span> find_objects(<span class="va">self</span>, image):</span>
<span id="cb12-460"><a href="#cb12-460"></a>        <span class="co">"""Find all objects in the image"""</span></span>
<span id="cb12-461"><a href="#cb12-461"></a>        <span class="co"># Preprocess</span></span>
<span id="cb12-462"><a href="#cb12-462"></a>        processed <span class="op">=</span> <span class="va">self</span>.preprocess(image)</span>
<span id="cb12-463"><a href="#cb12-463"></a>        </span>
<span id="cb12-464"><a href="#cb12-464"></a>        <span class="co"># Edge detection</span></span>
<span id="cb12-465"><a href="#cb12-465"></a>        edges <span class="op">=</span> cv2.Canny(processed, <span class="va">self</span>.canny_low, <span class="va">self</span>.canny_high)</span>
<span id="cb12-466"><a href="#cb12-466"></a>        </span>
<span id="cb12-467"><a href="#cb12-467"></a>        <span class="co"># Find contours</span></span>
<span id="cb12-468"><a href="#cb12-468"></a>        contours, _ <span class="op">=</span> cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb12-469"><a href="#cb12-469"></a>        </span>
<span id="cb12-470"><a href="#cb12-470"></a>        <span class="co"># Filter contours by area</span></span>
<span id="cb12-471"><a href="#cb12-471"></a>        valid_contours <span class="op">=</span> [c <span class="cf">for</span> c <span class="kw">in</span> contours <span class="cf">if</span> cv2.contourArea(c) <span class="op">&gt;</span> <span class="va">self</span>.min_contour_area]</span>
<span id="cb12-472"><a href="#cb12-472"></a>        </span>
<span id="cb12-473"><a href="#cb12-473"></a>        <span class="cf">return</span> valid_contours, edges</span>
<span id="cb12-474"><a href="#cb12-474"></a>    </span>
<span id="cb12-475"><a href="#cb12-475"></a>    <span class="kw">def</span> analyze_objects(<span class="va">self</span>, contours, image):</span>
<span id="cb12-476"><a href="#cb12-476"></a>        <span class="co">"""Analyze detected objects"""</span></span>
<span id="cb12-477"><a href="#cb12-477"></a>        results <span class="op">=</span> []</span>
<span id="cb12-478"><a href="#cb12-478"></a>        result_img <span class="op">=</span> image.copy()</span>
<span id="cb12-479"><a href="#cb12-479"></a>        </span>
<span id="cb12-480"><a href="#cb12-480"></a>        <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb12-481"><a href="#cb12-481"></a>            <span class="co"># Basic properties</span></span>
<span id="cb12-482"><a href="#cb12-482"></a>            area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb12-483"><a href="#cb12-483"></a>            perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb12-484"><a href="#cb12-484"></a>            </span>
<span id="cb12-485"><a href="#cb12-485"></a>            <span class="co"># Bounding rectangle</span></span>
<span id="cb12-486"><a href="#cb12-486"></a>            x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb12-487"><a href="#cb12-487"></a>            aspect_ratio <span class="op">=</span> <span class="bu">float</span>(w) <span class="op">/</span> h</span>
<span id="cb12-488"><a href="#cb12-488"></a>            </span>
<span id="cb12-489"><a href="#cb12-489"></a>            <span class="co"># Shape classification</span></span>
<span id="cb12-490"><a href="#cb12-490"></a>            shape <span class="op">=</span> classify_shape(contour)</span>
<span id="cb12-491"><a href="#cb12-491"></a>            </span>
<span id="cb12-492"><a href="#cb12-492"></a>            <span class="co"># Store results</span></span>
<span id="cb12-493"><a href="#cb12-493"></a>            obj_info <span class="op">=</span> {</span>
<span id="cb12-494"><a href="#cb12-494"></a>                <span class="st">'id'</span>: i,</span>
<span id="cb12-495"><a href="#cb12-495"></a>                <span class="st">'area'</span>: area,</span>
<span id="cb12-496"><a href="#cb12-496"></a>                <span class="st">'perimeter'</span>: perimeter,</span>
<span id="cb12-497"><a href="#cb12-497"></a>                <span class="st">'aspect_ratio'</span>: aspect_ratio,</span>
<span id="cb12-498"><a href="#cb12-498"></a>                <span class="st">'shape'</span>: shape,</span>
<span id="cb12-499"><a href="#cb12-499"></a>                <span class="st">'bbox'</span>: (x, y, w, h)</span>
<span id="cb12-500"><a href="#cb12-500"></a>            }</span>
<span id="cb12-501"><a href="#cb12-501"></a>            results.append(obj_info)</span>
<span id="cb12-502"><a href="#cb12-502"></a>            </span>
<span id="cb12-503"><a href="#cb12-503"></a>            <span class="co"># Draw on image</span></span>
<span id="cb12-504"><a href="#cb12-504"></a>            cv2.drawContours(result_img, [contour], <span class="op">-</span><span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb12-505"><a href="#cb12-505"></a>            cv2.rectangle(result_img, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb12-506"><a href="#cb12-506"></a>            cv2.putText(result_img, <span class="ss">f"</span><span class="sc">{</span>shape<span class="sc">}</span><span class="ss"> #</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, (x, y<span class="op">-</span><span class="dv">10</span>), </span>
<span id="cb12-507"><a href="#cb12-507"></a>                       cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.5</span>, (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>)</span>
<span id="cb12-508"><a href="#cb12-508"></a>        </span>
<span id="cb12-509"><a href="#cb12-509"></a>        <span class="cf">return</span> results, result_img</span>
<span id="cb12-510"><a href="#cb12-510"></a>    </span>
<span id="cb12-511"><a href="#cb12-511"></a>    <span class="kw">def</span> detect(<span class="va">self</span>, image):</span>
<span id="cb12-512"><a href="#cb12-512"></a>        <span class="co">"""Complete detection pipeline"""</span></span>
<span id="cb12-513"><a href="#cb12-513"></a>        contours, edges <span class="op">=</span> <span class="va">self</span>.find_objects(image)</span>
<span id="cb12-514"><a href="#cb12-514"></a>        results, result_img <span class="op">=</span> <span class="va">self</span>.analyze_objects(contours, image)</span>
<span id="cb12-515"><a href="#cb12-515"></a>        </span>
<span id="cb12-516"><a href="#cb12-516"></a>        <span class="cf">return</span> {</span>
<span id="cb12-517"><a href="#cb12-517"></a>            <span class="st">'objects'</span>: results,</span>
<span id="cb12-518"><a href="#cb12-518"></a>            <span class="st">'result_image'</span>: result_img,</span>
<span id="cb12-519"><a href="#cb12-519"></a>            <span class="st">'edges'</span>: edges,</span>
<span id="cb12-520"><a href="#cb12-520"></a>            <span class="st">'object_count'</span>: <span class="bu">len</span>(results)</span>
<span id="cb12-521"><a href="#cb12-521"></a>        }</span>
<span id="cb12-522"><a href="#cb12-522"></a></span>
<span id="cb12-523"><a href="#cb12-523"></a><span class="co"># Use the detector</span></span>
<span id="cb12-524"><a href="#cb12-524"></a>detector <span class="op">=</span> SimpleObjectDetector()</span>
<span id="cb12-525"><a href="#cb12-525"></a>detection_results <span class="op">=</span> detector.detect(img_rgb)</span>
<span id="cb12-526"><a href="#cb12-526"></a></span>
<span id="cb12-527"><a href="#cb12-527"></a><span class="co"># Display results</span></span>
<span id="cb12-528"><a href="#cb12-528"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb12-529"><a href="#cb12-529"></a></span>
<span id="cb12-530"><a href="#cb12-530"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb12-531"><a href="#cb12-531"></a>plt.imshow(img_rgb)</span>
<span id="cb12-532"><a href="#cb12-532"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb12-533"><a href="#cb12-533"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-534"><a href="#cb12-534"></a></span>
<span id="cb12-535"><a href="#cb12-535"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb12-536"><a href="#cb12-536"></a>plt.imshow(detection_results[<span class="st">'edges'</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-537"><a href="#cb12-537"></a>plt.title(<span class="st">"Edge Detection"</span>)</span>
<span id="cb12-538"><a href="#cb12-538"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-539"><a href="#cb12-539"></a></span>
<span id="cb12-540"><a href="#cb12-540"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb12-541"><a href="#cb12-541"></a>plt.imshow(detection_results[<span class="st">'result_image'</span>])</span>
<span id="cb12-542"><a href="#cb12-542"></a>plt.title(<span class="ss">f"Detected Objects: </span><span class="sc">{</span>detection_results[<span class="st">'object_count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-543"><a href="#cb12-543"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-544"><a href="#cb12-544"></a></span>
<span id="cb12-545"><a href="#cb12-545"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb12-546"><a href="#cb12-546"></a><span class="co"># Create a summary plot</span></span>
<span id="cb12-547"><a href="#cb12-547"></a>object_shapes <span class="op">=</span> [obj[<span class="st">'shape'</span>] <span class="cf">for</span> obj <span class="kw">in</span> detection_results[<span class="st">'objects'</span>]]</span>
<span id="cb12-548"><a href="#cb12-548"></a>shape_counts <span class="op">=</span> {}</span>
<span id="cb12-549"><a href="#cb12-549"></a><span class="cf">for</span> shape <span class="kw">in</span> object_shapes:</span>
<span id="cb12-550"><a href="#cb12-550"></a>    shape_counts[shape] <span class="op">=</span> shape_counts.get(shape, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb12-551"><a href="#cb12-551"></a></span>
<span id="cb12-552"><a href="#cb12-552"></a><span class="cf">if</span> shape_counts:</span>
<span id="cb12-553"><a href="#cb12-553"></a>    shapes <span class="op">=</span> <span class="bu">list</span>(shape_counts.keys())</span>
<span id="cb12-554"><a href="#cb12-554"></a>    counts <span class="op">=</span> <span class="bu">list</span>(shape_counts.values())</span>
<span id="cb12-555"><a href="#cb12-555"></a>    plt.bar(shapes, counts)</span>
<span id="cb12-556"><a href="#cb12-556"></a>    plt.title(<span class="st">"Object Type Distribution"</span>)</span>
<span id="cb12-557"><a href="#cb12-557"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb12-558"><a href="#cb12-558"></a><span class="cf">else</span>:</span>
<span id="cb12-559"><a href="#cb12-559"></a>    plt.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">"No objects detected"</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb12-560"><a href="#cb12-560"></a>    plt.title(<span class="st">"No Objects Found"</span>)</span>
<span id="cb12-561"><a href="#cb12-561"></a></span>
<span id="cb12-562"><a href="#cb12-562"></a>plt.tight_layout()</span>
<span id="cb12-563"><a href="#cb12-563"></a>plt.show()</span>
<span id="cb12-564"><a href="#cb12-564"></a></span>
<span id="cb12-565"><a href="#cb12-565"></a><span class="co"># Print detailed results</span></span>
<span id="cb12-566"><a href="#cb12-566"></a><span class="bu">print</span>(<span class="st">"Detection Results:"</span>)</span>
<span id="cb12-567"><a href="#cb12-567"></a><span class="bu">print</span>(<span class="ss">f"Total objects found: </span><span class="sc">{</span>detection_results[<span class="st">'object_count'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-568"><a href="#cb12-568"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Object details:"</span>)</span>
<span id="cb12-569"><a href="#cb12-569"></a><span class="cf">for</span> obj <span class="kw">in</span> detection_results[<span class="st">'objects'</span>]:</span>
<span id="cb12-570"><a href="#cb12-570"></a>    <span class="bu">print</span>(<span class="ss">f"  Object </span><span class="sc">{</span>obj[<span class="st">'id'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>obj[<span class="st">'shape'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-571"><a href="#cb12-571"></a>    <span class="bu">print</span>(<span class="ss">f"    Area: </span><span class="sc">{</span>obj[<span class="st">'area'</span>]<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb12-572"><a href="#cb12-572"></a>    <span class="bu">print</span>(<span class="ss">f"    Aspect Ratio: </span><span class="sc">{</span>obj[<span class="st">'aspect_ratio'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb12-573"><a href="#cb12-573"></a>    <span class="bu">print</span>(<span class="ss">f"    Bounding Box: </span><span class="sc">{</span>obj[<span class="st">'bbox'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-574"><a href="#cb12-574"></a><span class="in">```</span></span>
<span id="cb12-575"><a href="#cb12-575"></a></span>
<span id="cb12-576"><a href="#cb12-576"></a><span class="fu">## Your Challenge: Build a Practical Application</span></span>
<span id="cb12-577"><a href="#cb12-577"></a></span>
<span id="cb12-578"><a href="#cb12-578"></a>Now it's your turn! Try building one of these applications:</span>
<span id="cb12-579"><a href="#cb12-579"></a></span>
<span id="cb12-580"><a href="#cb12-580"></a><span class="fu">### 🎯 **Challenge 1: Document Page Counter**</span></span>
<span id="cb12-583"><a href="#cb12-583"></a><span class="in">```{python}</span></span>
<span id="cb12-584"><a href="#cb12-584"></a><span class="co">#| eval: false</span></span>
<span id="cb12-585"><a href="#cb12-585"></a><span class="kw">def</span> count_pages(image):</span>
<span id="cb12-586"><a href="#cb12-586"></a>    <span class="co">"""Count rectangular pages/documents in an image"""</span></span>
<span id="cb12-587"><a href="#cb12-587"></a>    <span class="co"># Your code here!</span></span>
<span id="cb12-588"><a href="#cb12-588"></a>    <span class="co"># Hint: Look for large rectangular contours</span></span>
<span id="cb12-589"><a href="#cb12-589"></a>    <span class="cf">pass</span></span>
<span id="cb12-590"><a href="#cb12-590"></a><span class="in">```</span></span>
<span id="cb12-591"><a href="#cb12-591"></a></span>
<span id="cb12-592"><a href="#cb12-592"></a><span class="fu">### 🎯 **Challenge 2: Parking Space Detector**</span></span>
<span id="cb12-595"><a href="#cb12-595"></a><span class="in">```{python}</span></span>
<span id="cb12-596"><a href="#cb12-596"></a><span class="co">#| eval: false</span></span>
<span id="cb12-597"><a href="#cb12-597"></a><span class="kw">def</span> detect_parking_spaces(image):</span>
<span id="cb12-598"><a href="#cb12-598"></a>    <span class="co">"""Detect empty parking spaces (rectangular regions)"""</span></span>
<span id="cb12-599"><a href="#cb12-599"></a>    <span class="co"># Your code here!</span></span>
<span id="cb12-600"><a href="#cb12-600"></a>    <span class="co"># Hint: Look for rectangular shapes of a certain size</span></span>
<span id="cb12-601"><a href="#cb12-601"></a>    <span class="cf">pass</span></span>
<span id="cb12-602"><a href="#cb12-602"></a><span class="in">```</span></span>
<span id="cb12-603"><a href="#cb12-603"></a></span>
<span id="cb12-604"><a href="#cb12-604"></a><span class="fu">### 🎯 **Challenge 3: Playing Card Detector**</span></span>
<span id="cb12-607"><a href="#cb12-607"></a><span class="in">```{python}</span></span>
<span id="cb12-608"><a href="#cb12-608"></a><span class="co">#| eval: false</span></span>
<span id="cb12-609"><a href="#cb12-609"></a><span class="kw">def</span> detect_playing_cards(image):</span>
<span id="cb12-610"><a href="#cb12-610"></a>    <span class="co">"""Detect playing cards in an image"""</span></span>
<span id="cb12-611"><a href="#cb12-611"></a>    <span class="co"># Your code here!</span></span>
<span id="cb12-612"><a href="#cb12-612"></a>    <span class="co"># Hint: Cards are rectangular with a specific aspect ratio</span></span>
<span id="cb12-613"><a href="#cb12-613"></a>    <span class="cf">pass</span></span>
<span id="cb12-614"><a href="#cb12-614"></a><span class="in">```</span></span>
<span id="cb12-615"><a href="#cb12-615"></a></span>
<span id="cb12-616"><a href="#cb12-616"></a><span class="fu">## What's Coming Next?</span></span>
<span id="cb12-617"><a href="#cb12-617"></a></span>
<span id="cb12-618"><a href="#cb12-618"></a>In our next adventure, <span class="co">[</span><span class="ot">**"Feature Magic: What Makes Images Unique"**</span><span class="co">](../05-feature-magic/)</span>, we'll explore:</span>
<span id="cb12-619"><a href="#cb12-619"></a></span>
<span id="cb12-620"><a href="#cb12-620"></a><span class="ss">- </span>**Keypoint detection** (finding interesting points)</span>
<span id="cb12-621"><a href="#cb12-621"></a><span class="ss">- </span>**Feature descriptors** (describing what makes each point unique)</span>
<span id="cb12-622"><a href="#cb12-622"></a><span class="ss">- </span>**Feature matching** (finding the same object in different images)</span>
<span id="cb12-623"><a href="#cb12-623"></a><span class="ss">- </span>**Panorama stitching** (combining multiple photos)</span>
<span id="cb12-624"><a href="#cb12-624"></a></span>
<span id="cb12-625"><a href="#cb12-625"></a>You've just learned to find shapes and patterns—next, we'll learn to recognize and match them!</span>
<span id="cb12-626"><a href="#cb12-626"></a></span>
<span id="cb12-627"><a href="#cb12-627"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb12-628"><a href="#cb12-628"></a></span>
<span id="cb12-629"><a href="#cb12-629"></a><span class="ss">- </span>**Edges are fundamental** to computer vision</span>
<span id="cb12-630"><a href="#cb12-630"></a><span class="ss">- </span>**Canny edge detection** is the gold standard algorithm</span>
<span id="cb12-631"><a href="#cb12-631"></a><span class="ss">- </span>**Contours** help us find and analyze shapes</span>
<span id="cb12-632"><a href="#cb12-632"></a><span class="ss">- </span>**Shape classification** uses geometric properties</span>
<span id="cb12-633"><a href="#cb12-633"></a><span class="ss">- </span>**Template matching** finds specific patterns</span>
<span id="cb12-634"><a href="#cb12-634"></a><span class="ss">- </span>**Combining techniques** creates powerful applications</span>
<span id="cb12-635"><a href="#cb12-635"></a></span>
<span id="cb12-636"><a href="#cb12-636"></a>:::{.callout-tip}</span>
<span id="cb12-637"><a href="#cb12-637"></a><span class="fu">## Hands-On Lab</span></span>
<span id="cb12-638"><a href="#cb12-638"></a>Ready to detect patterns in your own images? Try the complete interactive notebook: <span class="co">[</span><span class="ot">**Pattern Detection Lab**</span><span class="co">](https://colab.research.google.com/drive/1Finding_Patterns_Lab_123456)</span></span>
<span id="cb12-639"><a href="#cb12-639"></a></span>
<span id="cb12-640"><a href="#cb12-640"></a>Upload photos and watch your computer find shapes, count objects, and detect patterns!</span>
<span id="cb12-641"><a href="#cb12-641"></a>:::</span>
<span id="cb12-642"><a href="#cb12-642"></a></span>
<span id="cb12-643"><a href="#cb12-643"></a>:::{.callout-note}</span>
<span id="cb12-644"><a href="#cb12-644"></a><span class="fu">## Series Navigation</span></span>
<span id="cb12-645"><a href="#cb12-645"></a><span class="ss">- </span>**Previous**: <span class="co">[</span><span class="ot">OpenCV Essentials: Your First Computer Vision Toolkit</span><span class="co">](../03-opencv-essentials/)</span></span>
<span id="cb12-646"><a href="#cb12-646"></a><span class="ss">- </span>**Next**: <span class="co">[</span><span class="ot">Feature Magic: What Makes Images Unique</span><span class="co">](../05-feature-magic/)</span></span>
<span id="cb12-647"><a href="#cb12-647"></a><span class="ss">- </span>**Series Home**: <span class="co">[</span><span class="ot">Computer Vision Foundations</span><span class="co">](../computer-vision-foundations.qmd)</span></span>
<span id="cb12-648"><a href="#cb12-648"></a>:::</span>
<span id="cb12-649"><a href="#cb12-649"></a></span>
<span id="cb12-650"><a href="#cb12-650"></a>---</span>
<span id="cb12-651"><a href="#cb12-651"></a></span>
<span id="cb12-652"><a href="#cb12-652"></a>*You've just taught computers to see patterns and shapes! This is a huge milestone—you're now working with the same techniques used in industrial quality control, medical imaging, and autonomous vehicles.* </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>