<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hasan">
<meta name="dcterms.date" content="2025-01-22">

<title>Hasan's Data Science &amp; AI Blog ‚Äì Your First CV Project: Putting It All Together</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hasan's Data Science &amp; AI Blog - Your First CV Project: Putting It All Together">
<meta property="og:description" content="You‚Äôve learned about pixels, mastered OpenCV, detected patterns, matched features, and explored cutting-edge deep learning models.">
<meta property="og:image" content="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2069&amp;q=80">
<meta property="og:site-name" content="Hasan's Data Science &amp; AI Blog">
<meta name="twitter:title" content="Hasan's Data Science &amp; AI Blog - Your First CV Project: Putting It All Together">
<meta name="twitter:description" content="You‚Äôve learned about pixels, mastered OpenCV, detected patterns, matched features, and explored cutting-edge deep learning models.">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2069&amp;q=80">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hasan's Data Science &amp; AI Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-series" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-series">    
        <li>
    <a class="dropdown-item" href="../../../posts/series/data-science-steps.html" rel="" target="">
 <span class="dropdown-text">Data Science Steps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/computer-vision-with-pytorch.qmd" rel="" target="">
 <span class="dropdown-text">Computer Vision</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/vlm.html" rel="" target="">
 <span class="dropdown-text">VLM Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/anomaly-detection/index.html" rel="" target="">
 <span class="dropdown-text">Anomaly Detection</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../categories.html" rel="" target="">
 <span class="menu-text">Categories</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tags.html" rel="" target="">
 <span class="menu-text">Tags</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HasanGoni" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/hasangoni" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Your First CV Project: Putting It All Together</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Your First CV Project: Putting It All Together</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">computer-vision</div>
                <div class="quarto-category">project</div>
                <div class="quarto-category">application</div>
                <div class="quarto-category">deployment</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hasan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 22, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">June 28, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/data-science-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 06</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Computer Vision</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">posts/series/computer-vision-with-pytorch.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Anomaly Detection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/finding-the-oddballs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding the Oddballs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">VLM Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm-qwen3-14b/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen3-14B</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-moment-of-truth-building-something-real" id="toc-the-moment-of-truth-building-something-real" class="nav-link active" data-scroll-target="#the-moment-of-truth-building-something-real"><span class="header-section-number">0.1</span> The Moment of Truth: Building Something Real</a></li>
  <li><a href="#project-overview-smart-photo-analyzer" id="toc-project-overview-smart-photo-analyzer" class="nav-link" data-scroll-target="#project-overview-smart-photo-analyzer"><span class="header-section-number">0.2</span> Project Overview: Smart Photo Analyzer</a>
  <ul class="collapse">
  <li><a href="#what-were-building" id="toc-what-were-building" class="nav-link" data-scroll-target="#what-were-building"><span class="header-section-number">0.2.1</span> What We‚Äôre Building</a></li>
  <li><a href="#the-tech-stack" id="toc-the-tech-stack" class="nav-link" data-scroll-target="#the-tech-stack"><span class="header-section-number">0.2.2</span> The Tech Stack</a></li>
  </ul></li>
  <li><a href="#setting-up-the-project-structure" id="toc-setting-up-the-project-structure" class="nav-link" data-scroll-target="#setting-up-the-project-structure"><span class="header-section-number">0.3</span> Setting Up the Project Structure</a></li>
  <li><a href="#building-the-core-components" id="toc-building-the-core-components" class="nav-link" data-scroll-target="#building-the-core-components"><span class="header-section-number">0.4</span> Building the Core Components</a>
  <ul class="collapse">
  <li><a href="#image-analyzer-class" id="toc-image-analyzer-class" class="nav-link" data-scroll-target="#image-analyzer-class"><span class="header-section-number">0.4.1</span> 1. Image Analyzer Class</a></li>
  <li><a href="#image-filters-module" id="toc-image-filters-module" class="nav-link" data-scroll-target="#image-filters-module"><span class="header-section-number">0.4.2</span> 2. Image Filters Module</a></li>
  <li><a href="#similarity-search-engine" id="toc-similarity-search-engine" class="nav-link" data-scroll-target="#similarity-search-engine"><span class="header-section-number">0.4.3</span> 3. Similarity Search Engine</a></li>
  </ul></li>
  <li><a href="#building-the-web-interface-with-streamlit" id="toc-building-the-web-interface-with-streamlit" class="nav-link" data-scroll-target="#building-the-web-interface-with-streamlit"><span class="header-section-number">0.5</span> Building the Web Interface with Streamlit</a></li>
  <li><a href="#deployment-options" id="toc-deployment-options" class="nav-link" data-scroll-target="#deployment-options"><span class="header-section-number">0.6</span> Deployment Options</a>
  <ul class="collapse">
  <li><a href="#option-1-local-deployment" id="toc-option-1-local-deployment" class="nav-link" data-scroll-target="#option-1-local-deployment"><span class="header-section-number">0.6.1</span> Option 1: Local Deployment</a></li>
  <li><a href="#option-2-streamlit-cloud" id="toc-option-2-streamlit-cloud" class="nav-link" data-scroll-target="#option-2-streamlit-cloud"><span class="header-section-number">0.6.2</span> Option 2: Streamlit Cloud</a></li>
  <li><a href="#option-3-docker-deployment" id="toc-option-3-docker-deployment" class="nav-link" data-scroll-target="#option-3-docker-deployment"><span class="header-section-number">0.6.3</span> Option 3: Docker Deployment</a></li>
  </ul></li>
  <li><a href="#advanced-features-to-add" id="toc-advanced-features-to-add" class="nav-link" data-scroll-target="#advanced-features-to-add"><span class="header-section-number">0.7</span> Advanced Features to Add</a>
  <ul class="collapse">
  <li><a href="#batch-processing" id="toc-batch-processing" class="nav-link" data-scroll-target="#batch-processing"><span class="header-section-number">0.7.1</span> 1. Batch Processing</a></li>
  <li><a href="#custom-model-training" id="toc-custom-model-training" class="nav-link" data-scroll-target="#custom-model-training"><span class="header-section-number">0.7.2</span> 2. Custom Model Training</a></li>
  <li><a href="#real-time-video-processing" id="toc-real-time-video-processing" class="nav-link" data-scroll-target="#real-time-video-processing"><span class="header-section-number">0.7.3</span> 3. Real-time Video Processing</a></li>
  </ul></li>
  <li><a href="#testing-your-application" id="toc-testing-your-application" class="nav-link" data-scroll-target="#testing-your-application"><span class="header-section-number">0.8</span> Testing Your Application</a></li>
  <li><a href="#performance-optimization" id="toc-performance-optimization" class="nav-link" data-scroll-target="#performance-optimization"><span class="header-section-number">0.9</span> Performance Optimization</a>
  <ul class="collapse">
  <li><a href="#model-caching" id="toc-model-caching" class="nav-link" data-scroll-target="#model-caching"><span class="header-section-number">0.9.1</span> 1. Model Caching</a></li>
  <li><a href="#image-preprocessing-optimization" id="toc-image-preprocessing-optimization" class="nav-link" data-scroll-target="#image-preprocessing-optimization"><span class="header-section-number">0.9.2</span> 2. Image Preprocessing Optimization</a></li>
  </ul></li>
  <li><a href="#your-portfolio-showcase" id="toc-your-portfolio-showcase" class="nav-link" data-scroll-target="#your-portfolio-showcase"><span class="header-section-number">0.10</span> Your Portfolio Showcase</a>
  <ul class="collapse">
  <li><a href="#creating-a-professional-readme" id="toc-creating-a-professional-readme" class="nav-link" data-scroll-target="#creating-a-professional-readme"><span class="header-section-number">0.10.1</span> Creating a Professional README</a></li>
  </ul></li>
  <li><a href="#technologies" id="toc-technologies" class="nav-link" data-scroll-target="#technologies"><span class="header-section-number">0.11</span> Technologies</a></li>
  <li><a href="#what-i-learned" id="toc-what-i-learned" class="nav-link" data-scroll-target="#what-i-learned"><span class="header-section-number">0.12</span> What I Learned</a></li>
  <li><a href="#building-the-core-components-1" id="toc-building-the-core-components-1" class="nav-link" data-scroll-target="#building-the-core-components-1"><span class="header-section-number">0.13</span> Building the Core Components</a>
  <ul class="collapse">
  <li><a href="#image-analyzer-class-1" id="toc-image-analyzer-class-1" class="nav-link" data-scroll-target="#image-analyzer-class-1"><span class="header-section-number">0.13.1</span> 1. Image Analyzer Class</a></li>
  <li><a href="#image-filters-module-1" id="toc-image-filters-module-1" class="nav-link" data-scroll-target="#image-filters-module-1"><span class="header-section-number">0.13.2</span> 2. Image Filters Module</a></li>
  <li><a href="#similarity-search-engine-1" id="toc-similarity-search-engine-1" class="nav-link" data-scroll-target="#similarity-search-engine-1"><span class="header-section-number">0.13.3</span> 3. Similarity Search Engine</a></li>
  </ul></li>
  <li><a href="#building-the-web-interface-with-streamlit-1" id="toc-building-the-web-interface-with-streamlit-1" class="nav-link" data-scroll-target="#building-the-web-interface-with-streamlit-1"><span class="header-section-number">0.14</span> Building the Web Interface with Streamlit</a></li>
  <li><a href="#deployment-options-1" id="toc-deployment-options-1" class="nav-link" data-scroll-target="#deployment-options-1"><span class="header-section-number">0.15</span> Deployment Options</a>
  <ul class="collapse">
  <li><a href="#option-1-local-deployment-1" id="toc-option-1-local-deployment-1" class="nav-link" data-scroll-target="#option-1-local-deployment-1"><span class="header-section-number">0.15.1</span> Option 1: Local Deployment</a></li>
  <li><a href="#option-2-streamlit-cloud-1" id="toc-option-2-streamlit-cloud-1" class="nav-link" data-scroll-target="#option-2-streamlit-cloud-1"><span class="header-section-number">0.15.2</span> Option 2: Streamlit Cloud</a></li>
  <li><a href="#option-3-docker-deployment-1" id="toc-option-3-docker-deployment-1" class="nav-link" data-scroll-target="#option-3-docker-deployment-1"><span class="header-section-number">0.15.3</span> Option 3: Docker Deployment</a></li>
  </ul></li>
  <li><a href="#advanced-features-to-add-1" id="toc-advanced-features-to-add-1" class="nav-link" data-scroll-target="#advanced-features-to-add-1"><span class="header-section-number">0.16</span> Advanced Features to Add</a>
  <ul class="collapse">
  <li><a href="#batch-processing-1" id="toc-batch-processing-1" class="nav-link" data-scroll-target="#batch-processing-1"><span class="header-section-number">0.16.1</span> 1. Batch Processing</a></li>
  <li><a href="#custom-model-training-1" id="toc-custom-model-training-1" class="nav-link" data-scroll-target="#custom-model-training-1"><span class="header-section-number">0.16.2</span> 2. Custom Model Training</a></li>
  <li><a href="#real-time-video-processing-1" id="toc-real-time-video-processing-1" class="nav-link" data-scroll-target="#real-time-video-processing-1"><span class="header-section-number">0.16.3</span> 3. Real-time Video Processing</a></li>
  </ul></li>
  <li><a href="#testing-your-application-1" id="toc-testing-your-application-1" class="nav-link" data-scroll-target="#testing-your-application-1"><span class="header-section-number">0.17</span> Testing Your Application</a></li>
  <li><a href="#performance-optimization-1" id="toc-performance-optimization-1" class="nav-link" data-scroll-target="#performance-optimization-1"><span class="header-section-number">0.18</span> Performance Optimization</a>
  <ul class="collapse">
  <li><a href="#model-caching-1" id="toc-model-caching-1" class="nav-link" data-scroll-target="#model-caching-1"><span class="header-section-number">0.18.1</span> 1. Model Caching</a></li>
  <li><a href="#image-preprocessing-optimization-1" id="toc-image-preprocessing-optimization-1" class="nav-link" data-scroll-target="#image-preprocessing-optimization-1"><span class="header-section-number">0.18.2</span> 2. Image Preprocessing Optimization</a></li>
  </ul></li>
  <li><a href="#your-portfolio-showcase-1" id="toc-your-portfolio-showcase-1" class="nav-link" data-scroll-target="#your-portfolio-showcase-1"><span class="header-section-number">0.19</span> Your Portfolio Showcase</a>
  <ul class="collapse">
  <li><a href="#creating-a-professional-readme-1" id="toc-creating-a-professional-readme-1" class="nav-link" data-scroll-target="#creating-a-professional-readme-1"><span class="header-section-number">0.19.1</span> Creating a Professional README</a></li>
  </ul></li>
  <li><a href="#technologies-1" id="toc-technologies-1" class="nav-link" data-scroll-target="#technologies-1"><span class="header-section-number">0.20</span> Technologies</a></li>
  <li><a href="#what-i-learned-1" id="toc-what-i-learned-1" class="nav-link" data-scroll-target="#what-i-learned-1"><span class="header-section-number">0.21</span> What I Learned</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="the-moment-of-truth-building-something-real" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="the-moment-of-truth-building-something-real"><span class="header-section-number">0.1</span> The Moment of Truth: Building Something Real</h2>
<p>You‚Äôve learned about pixels, mastered OpenCV, detected patterns, matched features, and explored cutting-edge deep learning models. Now comes the exciting part: <strong>building a complete computer vision application that showcases everything you‚Äôve learned!</strong></p>
<p>Today, we‚Äôre going to create the <strong>‚ÄúSmart Photo Analyzer‚Äù</strong>‚Äîan interactive web app that can: - üîç <strong>Analyze any image</strong> you upload - üè∑Ô∏è <strong>Classify objects</strong> using deep learning - üé® <strong>Apply artistic filters</strong> using classical CV - üîó <strong>Find similar images</strong> using DINOv2 features - üìä <strong>Extract detailed statistics</strong> about the image</p>
<p>By the end of this post, you‚Äôll have a portfolio-worthy project that demonstrates your computer vision skills!</p>
</section>
<section id="project-overview-smart-photo-analyzer" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="project-overview-smart-photo-analyzer"><span class="header-section-number">0.2</span> Project Overview: Smart Photo Analyzer</h2>
<section id="what-were-building" class="level3" data-number="0.2.1">
<h3 data-number="0.2.1" class="anchored" data-anchor-id="what-were-building"><span class="header-section-number">0.2.1</span> What We‚Äôre Building</h3>
<p>Our Smart Photo Analyzer will have these features:</p>
<ol type="1">
<li><strong>Image Upload &amp; Display</strong></li>
<li><strong>Basic Image Analysis</strong> (size, colors, etc.)</li>
<li><strong>Object Classification</strong> (using pre-trained models)</li>
<li><strong>Artistic Filters</strong> (using OpenCV)</li>
<li><strong>Feature Extraction</strong> (using DINOv2)</li>
<li><strong>Similar Image Search</strong></li>
<li><strong>Interactive Web Interface</strong></li>
</ol>
</section>
<section id="the-tech-stack" class="level3" data-number="0.2.2">
<h3 data-number="0.2.2" class="anchored" data-anchor-id="the-tech-stack"><span class="header-section-number">0.2.2</span> The Tech Stack</h3>
<ul>
<li><strong>Backend</strong>: Python with OpenCV, PyTorch, Transformers</li>
<li><strong>Frontend</strong>: Streamlit (for quick deployment) or Gradio</li>
<li><strong>Models</strong>: ResNet for classification, DINOv2 for features</li>
<li><strong>Deployment</strong>: Local first, then optional cloud deployment</li>
</ul>
</section>
</section>
<section id="setting-up-the-project-structure" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="setting-up-the-project-structure"><span class="header-section-number">0.3</span> Setting Up the Project Structure</h2>
<p>Let‚Äôs start by organizing our project:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Project structure</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">"""</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">smart_photo_analyzer/</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">‚îú‚îÄ‚îÄ app.py                 # Main Streamlit app</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">‚îú‚îÄ‚îÄ src/</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">‚îÇ   ‚îú‚îÄ‚îÄ __init__.py</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">‚îÇ   ‚îú‚îÄ‚îÄ image_analyzer.py  # Core analysis functions</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">‚îÇ   ‚îú‚îÄ‚îÄ filters.py         # OpenCV filters</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">‚îÇ   ‚îú‚îÄ‚îÄ classifier.py      # Deep learning classification</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">‚îÇ   ‚îî‚îÄ‚îÄ feature_extractor.py  # DINOv2 features</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">‚îú‚îÄ‚îÄ models/                # Saved models (if any)</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">‚îú‚îÄ‚îÄ sample_images/         # Test images</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">‚îú‚îÄ‚îÄ requirements.txt       # Dependencies</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">‚îî‚îÄ‚îÄ README.md             # Project documentation</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">"""</span></span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># Let's create the core modules</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="im">import</span> os</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="im">import</span> cv2</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="im">import</span> torch</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="im">import</span> torchvision.models <span class="im">as</span> models</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> transforms</span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="im">from</span> transformers <span class="im">import</span> AutoImageProcessor, AutoModel</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>üéØ Try it yourself!</strong> <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-08-first-cv-project.ipynb">Open in Colab</a></p>
</section>
<section id="building-the-core-components" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="building-the-core-components"><span class="header-section-number">0.4</span> Building the Core Components</h2>
<section id="image-analyzer-class" class="level3" data-number="0.4.1">
<h3 data-number="0.4.1" class="anchored" data-anchor-id="image-analyzer-class"><span class="header-section-number">0.4.1</span> 1. Image Analyzer Class</h3>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">class</span> SmartImageAnalyzer:</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb2-3"><a href="#cb2-3"></a>        <span class="va">self</span>.setup_models()</span>
<span id="cb2-4"><a href="#cb2-4"></a>        <span class="va">self</span>.setup_transforms()</span>
<span id="cb2-5"><a href="#cb2-5"></a>    </span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="kw">def</span> setup_models(<span class="va">self</span>):</span>
<span id="cb2-7"><a href="#cb2-7"></a>        <span class="co">"""Initialize all models"""</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>        <span class="bu">print</span>(<span class="st">"Loading models..."</span>)</span>
<span id="cb2-9"><a href="#cb2-9"></a>        </span>
<span id="cb2-10"><a href="#cb2-10"></a>        <span class="co"># Classification model</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>        <span class="va">self</span>.classifier <span class="op">=</span> models.resnet50(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>        <span class="va">self</span>.classifier.<span class="bu">eval</span>()</span>
<span id="cb2-13"><a href="#cb2-13"></a>        </span>
<span id="cb2-14"><a href="#cb2-14"></a>        <span class="co"># DINOv2 for feature extraction</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>        <span class="va">self</span>.dinov2_processor <span class="op">=</span> AutoImageProcessor.from_pretrained(<span class="st">"facebook/dinov2-base"</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a>        <span class="va">self</span>.dinov2_model <span class="op">=</span> AutoModel.from_pretrained(<span class="st">"facebook/dinov2-base"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a>        <span class="va">self</span>.dinov2_model.<span class="bu">eval</span>()</span>
<span id="cb2-18"><a href="#cb2-18"></a>        </span>
<span id="cb2-19"><a href="#cb2-19"></a>        <span class="co"># ImageNet class labels</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>        <span class="va">self</span>.load_imagenet_labels()</span>
<span id="cb2-21"><a href="#cb2-21"></a>        </span>
<span id="cb2-22"><a href="#cb2-22"></a>        <span class="bu">print</span>(<span class="st">"Models loaded successfully!"</span>)</span>
<span id="cb2-23"><a href="#cb2-23"></a>    </span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="kw">def</span> setup_transforms(<span class="va">self</span>):</span>
<span id="cb2-25"><a href="#cb2-25"></a>        <span class="co">"""Setup image transforms"""</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>        <span class="va">self</span>.classification_transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb2-27"><a href="#cb2-27"></a>            transforms.Resize(<span class="dv">256</span>),</span>
<span id="cb2-28"><a href="#cb2-28"></a>            transforms.CenterCrop(<span class="dv">224</span>),</span>
<span id="cb2-29"><a href="#cb2-29"></a>            transforms.ToTensor(),</span>
<span id="cb2-30"><a href="#cb2-30"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb2-31"><a href="#cb2-31"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb2-32"><a href="#cb2-32"></a>        ])</span>
<span id="cb2-33"><a href="#cb2-33"></a>    </span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="kw">def</span> load_imagenet_labels(<span class="va">self</span>):</span>
<span id="cb2-35"><a href="#cb2-35"></a>        <span class="co">"""Load ImageNet class labels"""</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>        <span class="co"># Simplified version - you would load the full ImageNet labels</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>        <span class="va">self</span>.imagenet_labels <span class="op">=</span> [</span>
<span id="cb2-38"><a href="#cb2-38"></a>            <span class="st">"tench"</span>, <span class="st">"goldfish"</span>, <span class="st">"great white shark"</span>, <span class="st">"tiger shark"</span>,</span>
<span id="cb2-39"><a href="#cb2-39"></a>            <span class="st">"hammerhead"</span>, <span class="st">"electric ray"</span>, <span class="st">"stingray"</span>, <span class="st">"cock"</span>, <span class="st">"hen"</span>, <span class="st">"ostrich"</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>            <span class="co"># ... (1000 total classes)</span></span>
<span id="cb2-41"><a href="#cb2-41"></a>        ]</span>
<span id="cb2-42"><a href="#cb2-42"></a>    </span>
<span id="cb2-43"><a href="#cb2-43"></a>    <span class="kw">def</span> analyze_basic_properties(<span class="va">self</span>, image):</span>
<span id="cb2-44"><a href="#cb2-44"></a>        <span class="co">"""Analyze basic image properties"""</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, PIL.Image.Image):</span>
<span id="cb2-46"><a href="#cb2-46"></a>            image_array <span class="op">=</span> np.array(image)</span>
<span id="cb2-47"><a href="#cb2-47"></a>        <span class="cf">else</span>:</span>
<span id="cb2-48"><a href="#cb2-48"></a>            image_array <span class="op">=</span> image</span>
<span id="cb2-49"><a href="#cb2-49"></a>        </span>
<span id="cb2-50"><a href="#cb2-50"></a>        height, width <span class="op">=</span> image_array.shape[:<span class="dv">2</span>]</span>
<span id="cb2-51"><a href="#cb2-51"></a>        channels <span class="op">=</span> image_array.shape[<span class="dv">2</span>] <span class="cf">if</span> <span class="bu">len</span>(image_array.shape) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb2-52"><a href="#cb2-52"></a>        </span>
<span id="cb2-53"><a href="#cb2-53"></a>        <span class="co"># Color analysis</span></span>
<span id="cb2-54"><a href="#cb2-54"></a>        <span class="cf">if</span> channels <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb2-55"><a href="#cb2-55"></a>            <span class="co"># Convert to different color spaces</span></span>
<span id="cb2-56"><a href="#cb2-56"></a>            hsv <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2HSV)</span>
<span id="cb2-57"><a href="#cb2-57"></a>            lab <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2LAB)</span>
<span id="cb2-58"><a href="#cb2-58"></a>            </span>
<span id="cb2-59"><a href="#cb2-59"></a>            <span class="co"># Dominant colors (simplified)</span></span>
<span id="cb2-60"><a href="#cb2-60"></a>            dominant_colors <span class="op">=</span> <span class="va">self</span>.extract_dominant_colors(image_array)</span>
<span id="cb2-61"><a href="#cb2-61"></a>            </span>
<span id="cb2-62"><a href="#cb2-62"></a>            <span class="co"># Brightness and contrast</span></span>
<span id="cb2-63"><a href="#cb2-63"></a>            gray <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2GRAY)</span>
<span id="cb2-64"><a href="#cb2-64"></a>            brightness <span class="op">=</span> np.mean(gray)</span>
<span id="cb2-65"><a href="#cb2-65"></a>            contrast <span class="op">=</span> np.std(gray)</span>
<span id="cb2-66"><a href="#cb2-66"></a>        <span class="cf">else</span>:</span>
<span id="cb2-67"><a href="#cb2-67"></a>            brightness <span class="op">=</span> np.mean(image_array)</span>
<span id="cb2-68"><a href="#cb2-68"></a>            contrast <span class="op">=</span> np.std(image_array)</span>
<span id="cb2-69"><a href="#cb2-69"></a>            dominant_colors <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-70"><a href="#cb2-70"></a>        </span>
<span id="cb2-71"><a href="#cb2-71"></a>        <span class="cf">return</span> {</span>
<span id="cb2-72"><a href="#cb2-72"></a>            <span class="st">'dimensions'</span>: <span class="ss">f"</span><span class="sc">{</span>width<span class="sc">}</span><span class="ss"> x </span><span class="sc">{</span>height<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb2-73"><a href="#cb2-73"></a>            <span class="st">'channels'</span>: channels,</span>
<span id="cb2-74"><a href="#cb2-74"></a>            <span class="st">'file_size'</span>: <span class="ss">f"</span><span class="sc">{</span>width <span class="op">*</span> height <span class="op">*</span> channels <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1024</span><span class="sc">:.1f}</span><span class="ss"> KB"</span>,</span>
<span id="cb2-75"><a href="#cb2-75"></a>            <span class="st">'brightness'</span>: <span class="ss">f"</span><span class="sc">{</span>brightness<span class="sc">:.1f}</span><span class="ss">"</span>,</span>
<span id="cb2-76"><a href="#cb2-76"></a>            <span class="st">'contrast'</span>: <span class="ss">f"</span><span class="sc">{</span>contrast<span class="sc">:.1f}</span><span class="ss">"</span>,</span>
<span id="cb2-77"><a href="#cb2-77"></a>            <span class="st">'dominant_colors'</span>: dominant_colors</span>
<span id="cb2-78"><a href="#cb2-78"></a>        }</span>
<span id="cb2-79"><a href="#cb2-79"></a>    </span>
<span id="cb2-80"><a href="#cb2-80"></a>    <span class="kw">def</span> extract_dominant_colors(<span class="va">self</span>, image, k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb2-81"><a href="#cb2-81"></a>        <span class="co">"""Extract dominant colors using K-means"""</span></span>
<span id="cb2-82"><a href="#cb2-82"></a>        <span class="co"># Reshape image to be a list of pixels</span></span>
<span id="cb2-83"><a href="#cb2-83"></a>        pixels <span class="op">=</span> image.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb2-84"><a href="#cb2-84"></a>        pixels <span class="op">=</span> np.float32(pixels)</span>
<span id="cb2-85"><a href="#cb2-85"></a>        </span>
<span id="cb2-86"><a href="#cb2-86"></a>        <span class="co"># K-means clustering</span></span>
<span id="cb2-87"><a href="#cb2-87"></a>        criteria <span class="op">=</span> (cv2.TERM_CRITERIA_EPS <span class="op">+</span> cv2.TERM_CRITERIA_MAX_ITER, <span class="dv">100</span>, <span class="fl">0.2</span>)</span>
<span id="cb2-88"><a href="#cb2-88"></a>        _, labels, centers <span class="op">=</span> cv2.kmeans(pixels, k, <span class="va">None</span>, criteria, <span class="dv">10</span>, cv2.KMEANS_RANDOM_CENTERS)</span>
<span id="cb2-89"><a href="#cb2-89"></a>        </span>
<span id="cb2-90"><a href="#cb2-90"></a>        <span class="co"># Convert back to uint8</span></span>
<span id="cb2-91"><a href="#cb2-91"></a>        centers <span class="op">=</span> np.uint8(centers)</span>
<span id="cb2-92"><a href="#cb2-92"></a>        </span>
<span id="cb2-93"><a href="#cb2-93"></a>        <span class="cf">return</span> centers.tolist()</span>
<span id="cb2-94"><a href="#cb2-94"></a>    </span>
<span id="cb2-95"><a href="#cb2-95"></a>    <span class="kw">def</span> classify_image(<span class="va">self</span>, image):</span>
<span id="cb2-96"><a href="#cb2-96"></a>        <span class="co">"""Classify image using ResNet"""</span></span>
<span id="cb2-97"><a href="#cb2-97"></a>        <span class="co"># Preprocess image</span></span>
<span id="cb2-98"><a href="#cb2-98"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb2-99"><a href="#cb2-99"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb2-100"><a href="#cb2-100"></a>        </span>
<span id="cb2-101"><a href="#cb2-101"></a>        input_tensor <span class="op">=</span> <span class="va">self</span>.classification_transform(image).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb2-102"><a href="#cb2-102"></a>        </span>
<span id="cb2-103"><a href="#cb2-103"></a>        <span class="co"># Make prediction</span></span>
<span id="cb2-104"><a href="#cb2-104"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb2-105"><a href="#cb2-105"></a>            outputs <span class="op">=</span> <span class="va">self</span>.classifier(input_tensor)</span>
<span id="cb2-106"><a href="#cb2-106"></a>            probabilities <span class="op">=</span> torch.softmax(outputs, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-107"><a href="#cb2-107"></a>            top5_prob, top5_indices <span class="op">=</span> torch.topk(probabilities, <span class="dv">5</span>)</span>
<span id="cb2-108"><a href="#cb2-108"></a>        </span>
<span id="cb2-109"><a href="#cb2-109"></a>        <span class="co"># Format results</span></span>
<span id="cb2-110"><a href="#cb2-110"></a>        results <span class="op">=</span> []</span>
<span id="cb2-111"><a href="#cb2-111"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb2-112"><a href="#cb2-112"></a>            class_idx <span class="op">=</span> top5_indices[<span class="dv">0</span>][i].item()</span>
<span id="cb2-113"><a href="#cb2-113"></a>            prob <span class="op">=</span> top5_prob[<span class="dv">0</span>][i].item()</span>
<span id="cb2-114"><a href="#cb2-114"></a>            class_name <span class="op">=</span> <span class="va">self</span>.imagenet_labels[class_idx] <span class="cf">if</span> class_idx <span class="op">&lt;</span> <span class="bu">len</span>(<span class="va">self</span>.imagenet_labels) <span class="cf">else</span> <span class="ss">f"Class_</span><span class="sc">{</span>class_idx<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb2-115"><a href="#cb2-115"></a>            results.append({</span>
<span id="cb2-116"><a href="#cb2-116"></a>                <span class="st">'class'</span>: class_name,</span>
<span id="cb2-117"><a href="#cb2-117"></a>                <span class="st">'confidence'</span>: prob</span>
<span id="cb2-118"><a href="#cb2-118"></a>            })</span>
<span id="cb2-119"><a href="#cb2-119"></a>        </span>
<span id="cb2-120"><a href="#cb2-120"></a>        <span class="cf">return</span> results</span>
<span id="cb2-121"><a href="#cb2-121"></a>    </span>
<span id="cb2-122"><a href="#cb2-122"></a>    <span class="kw">def</span> extract_features(<span class="va">self</span>, image):</span>
<span id="cb2-123"><a href="#cb2-123"></a>        <span class="co">"""Extract DINOv2 features"""</span></span>
<span id="cb2-124"><a href="#cb2-124"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb2-125"><a href="#cb2-125"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb2-126"><a href="#cb2-126"></a>        </span>
<span id="cb2-127"><a href="#cb2-127"></a>        <span class="co"># Process image</span></span>
<span id="cb2-128"><a href="#cb2-128"></a>        inputs <span class="op">=</span> <span class="va">self</span>.dinov2_processor(images<span class="op">=</span>image, return_tensors<span class="op">=</span><span class="st">"pt"</span>)</span>
<span id="cb2-129"><a href="#cb2-129"></a>        </span>
<span id="cb2-130"><a href="#cb2-130"></a>        <span class="co"># Extract features</span></span>
<span id="cb2-131"><a href="#cb2-131"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb2-132"><a href="#cb2-132"></a>            outputs <span class="op">=</span> <span class="va">self</span>.dinov2_model(<span class="op">**</span>inputs)</span>
<span id="cb2-133"><a href="#cb2-133"></a>            cls_features <span class="op">=</span> outputs.last_hidden_state[:, <span class="dv">0</span>]  <span class="co"># Global features</span></span>
<span id="cb2-134"><a href="#cb2-134"></a>            patch_features <span class="op">=</span> outputs.last_hidden_state[:, <span class="dv">1</span>:]  <span class="co"># Local features</span></span>
<span id="cb2-135"><a href="#cb2-135"></a>        </span>
<span id="cb2-136"><a href="#cb2-136"></a>        <span class="cf">return</span> {</span>
<span id="cb2-137"><a href="#cb2-137"></a>            <span class="st">'global_features'</span>: cls_features.numpy(),</span>
<span id="cb2-138"><a href="#cb2-138"></a>            <span class="st">'patch_features'</span>: patch_features.numpy(),</span>
<span id="cb2-139"><a href="#cb2-139"></a>            <span class="st">'feature_dimension'</span>: cls_features.shape[<span class="dv">1</span>]</span>
<span id="cb2-140"><a href="#cb2-140"></a>        }</span>
<span id="cb2-141"><a href="#cb2-141"></a></span>
<span id="cb2-142"><a href="#cb2-142"></a><span class="co"># Initialize the analyzer</span></span>
<span id="cb2-143"><a href="#cb2-143"></a>analyzer <span class="op">=</span> SmartImageAnalyzer()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="image-filters-module" class="level3" data-number="0.4.2">
<h3 data-number="0.4.2" class="anchored" data-anchor-id="image-filters-module"><span class="header-section-number">0.4.2</span> 2. Image Filters Module</h3>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">class</span> ImageFilters:</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="kw">def</span> apply_blur(image, kernel_size<span class="op">=</span><span class="dv">15</span>):</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="co">"""Apply Gaussian blur"""</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="cf">return</span> cv2.GaussianBlur(image, (kernel_size, kernel_size), <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>    </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="kw">def</span> apply_sharpen(image):</span>
<span id="cb3-9"><a href="#cb3-9"></a>        <span class="co">"""Apply sharpening filter"""</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>        kernel <span class="op">=</span> np.array([[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>,<span class="dv">9</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb3-11"><a href="#cb3-11"></a>        <span class="cf">return</span> cv2.filter2D(image, <span class="op">-</span><span class="dv">1</span>, kernel)</span>
<span id="cb3-12"><a href="#cb3-12"></a>    </span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="kw">def</span> apply_edge_detection(image):</span>
<span id="cb3-15"><a href="#cb3-15"></a>        <span class="co">"""Apply Canny edge detection"""</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb3-17"><a href="#cb3-17"></a>        edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>        <span class="cf">return</span> cv2.cvtColor(edges, cv2.COLOR_GRAY2RGB)</span>
<span id="cb3-19"><a href="#cb3-19"></a>    </span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="kw">def</span> apply_vintage(image):</span>
<span id="cb3-22"><a href="#cb3-22"></a>        <span class="co">"""Apply vintage filter"""</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>        <span class="co"># Convert to float for calculations</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>        img_float <span class="op">=</span> image.astype(np.float32) <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>        </span>
<span id="cb3-26"><a href="#cb3-26"></a>        <span class="co"># Apply sepia effect</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>        sepia_filter <span class="op">=</span> np.array([</span>
<span id="cb3-28"><a href="#cb3-28"></a>            [<span class="fl">0.393</span>, <span class="fl">0.769</span>, <span class="fl">0.189</span>],</span>
<span id="cb3-29"><a href="#cb3-29"></a>            [<span class="fl">0.349</span>, <span class="fl">0.686</span>, <span class="fl">0.168</span>],</span>
<span id="cb3-30"><a href="#cb3-30"></a>            [<span class="fl">0.272</span>, <span class="fl">0.534</span>, <span class="fl">0.131</span>]</span>
<span id="cb3-31"><a href="#cb3-31"></a>        ])</span>
<span id="cb3-32"><a href="#cb3-32"></a>        </span>
<span id="cb3-33"><a href="#cb3-33"></a>        sepia_img <span class="op">=</span> img_float <span class="op">@</span> sepia_filter.T</span>
<span id="cb3-34"><a href="#cb3-34"></a>        sepia_img <span class="op">=</span> np.clip(sepia_img, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-35"><a href="#cb3-35"></a>        </span>
<span id="cb3-36"><a href="#cb3-36"></a>        <span class="co"># Add vignette effect</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>        h, w <span class="op">=</span> image.shape[:<span class="dv">2</span>]</span>
<span id="cb3-38"><a href="#cb3-38"></a>        X, Y <span class="op">=</span> np.meshgrid(np.arange(w), np.arange(h))</span>
<span id="cb3-39"><a href="#cb3-39"></a>        center_x, center_y <span class="op">=</span> w <span class="op">//</span> <span class="dv">2</span>, h <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb3-40"><a href="#cb3-40"></a>        </span>
<span id="cb3-41"><a href="#cb3-41"></a>        <span class="co"># Calculate distance from center</span></span>
<span id="cb3-42"><a href="#cb3-42"></a>        distance <span class="op">=</span> np.sqrt((X <span class="op">-</span> center_x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Y <span class="op">-</span> center_y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb3-43"><a href="#cb3-43"></a>        max_distance <span class="op">=</span> np.sqrt(center_x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> center_y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb3-44"><a href="#cb3-44"></a>        </span>
<span id="cb3-45"><a href="#cb3-45"></a>        <span class="co"># Create vignette mask</span></span>
<span id="cb3-46"><a href="#cb3-46"></a>        vignette <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (distance <span class="op">/</span> max_distance) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>        vignette <span class="op">=</span> np.clip(vignette, <span class="fl">0.3</span>, <span class="dv">1</span>)</span>
<span id="cb3-48"><a href="#cb3-48"></a>        </span>
<span id="cb3-49"><a href="#cb3-49"></a>        <span class="co"># Apply vignette</span></span>
<span id="cb3-50"><a href="#cb3-50"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb3-51"><a href="#cb3-51"></a>            sepia_img[:, :, i] <span class="op">*=</span> vignette</span>
<span id="cb3-52"><a href="#cb3-52"></a>        </span>
<span id="cb3-53"><a href="#cb3-53"></a>        <span class="cf">return</span> (sepia_img <span class="op">*</span> <span class="dv">255</span>).astype(np.uint8)</span>
<span id="cb3-54"><a href="#cb3-54"></a>    </span>
<span id="cb3-55"><a href="#cb3-55"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-56"><a href="#cb3-56"></a>    <span class="kw">def</span> apply_cartoon(image):</span>
<span id="cb3-57"><a href="#cb3-57"></a>        <span class="co">"""Apply cartoon effect"""</span></span>
<span id="cb3-58"><a href="#cb3-58"></a>        <span class="co"># Bilateral filter for smooth color regions</span></span>
<span id="cb3-59"><a href="#cb3-59"></a>        bilateral <span class="op">=</span> cv2.bilateralFilter(image, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">200</span>)</span>
<span id="cb3-60"><a href="#cb3-60"></a>        </span>
<span id="cb3-61"><a href="#cb3-61"></a>        <span class="co"># Edge detection</span></span>
<span id="cb3-62"><a href="#cb3-62"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb3-63"><a href="#cb3-63"></a>        edges <span class="op">=</span> cv2.adaptiveThreshold(gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_MEAN_C, </span>
<span id="cb3-64"><a href="#cb3-64"></a>                                     cv2.THRESH_BINARY, <span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb3-65"><a href="#cb3-65"></a>        edges <span class="op">=</span> cv2.cvtColor(edges, cv2.COLOR_GRAY2RGB)</span>
<span id="cb3-66"><a href="#cb3-66"></a>        </span>
<span id="cb3-67"><a href="#cb3-67"></a>        <span class="co"># Combine bilateral filter and edges</span></span>
<span id="cb3-68"><a href="#cb3-68"></a>        cartoon <span class="op">=</span> cv2.bitwise_and(bilateral, edges)</span>
<span id="cb3-69"><a href="#cb3-69"></a>        </span>
<span id="cb3-70"><a href="#cb3-70"></a>        <span class="cf">return</span> cartoon</span>
<span id="cb3-71"><a href="#cb3-71"></a>    </span>
<span id="cb3-72"><a href="#cb3-72"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-73"><a href="#cb3-73"></a>    <span class="kw">def</span> apply_oil_painting(image, size<span class="op">=</span><span class="dv">7</span>, dynRatio<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb3-74"><a href="#cb3-74"></a>        <span class="co">"""Apply oil painting effect"""</span></span>
<span id="cb3-75"><a href="#cb3-75"></a>        <span class="cf">return</span> cv2.xphoto.oilPainting(image, size, dynRatio)</span>
<span id="cb3-76"><a href="#cb3-76"></a>    </span>
<span id="cb3-77"><a href="#cb3-77"></a>    <span class="at">@staticmethod</span></span>
<span id="cb3-78"><a href="#cb3-78"></a>    <span class="kw">def</span> get_available_filters():</span>
<span id="cb3-79"><a href="#cb3-79"></a>        <span class="co">"""Get list of available filters"""</span></span>
<span id="cb3-80"><a href="#cb3-80"></a>        <span class="cf">return</span> {</span>
<span id="cb3-81"><a href="#cb3-81"></a>            <span class="st">'blur'</span>: <span class="st">'Gaussian Blur'</span>,</span>
<span id="cb3-82"><a href="#cb3-82"></a>            <span class="st">'sharpen'</span>: <span class="st">'Sharpen'</span>,</span>
<span id="cb3-83"><a href="#cb3-83"></a>            <span class="st">'edges'</span>: <span class="st">'Edge Detection'</span>,</span>
<span id="cb3-84"><a href="#cb3-84"></a>            <span class="st">'vintage'</span>: <span class="st">'Vintage'</span>,</span>
<span id="cb3-85"><a href="#cb3-85"></a>            <span class="st">'cartoon'</span>: <span class="st">'Cartoon'</span>,</span>
<span id="cb3-86"><a href="#cb3-86"></a>            <span class="st">'oil'</span>: <span class="st">'Oil Painting'</span></span>
<span id="cb3-87"><a href="#cb3-87"></a>        }</span>
<span id="cb3-88"><a href="#cb3-88"></a></span>
<span id="cb3-89"><a href="#cb3-89"></a>filters <span class="op">=</span> ImageFilters()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="similarity-search-engine" class="level3" data-number="0.4.3">
<h3 data-number="0.4.3" class="anchored" data-anchor-id="similarity-search-engine"><span class="header-section-number">0.4.3</span> 3. Similarity Search Engine</h3>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">class</span> SimilaritySearchEngine:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, analyzer):</span>
<span id="cb4-3"><a href="#cb4-3"></a>        <span class="va">self</span>.analyzer <span class="op">=</span> analyzer</span>
<span id="cb4-4"><a href="#cb4-4"></a>        <span class="va">self</span>.image_database <span class="op">=</span> {}</span>
<span id="cb4-5"><a href="#cb4-5"></a>    </span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="kw">def</span> add_image_to_database(<span class="va">self</span>, image_id, image):</span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="co">"""Add image to search database"""</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>        features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(image)</span>
<span id="cb4-9"><a href="#cb4-9"></a>        <span class="va">self</span>.image_database[image_id] <span class="op">=</span> {</span>
<span id="cb4-10"><a href="#cb4-10"></a>            <span class="st">'features'</span>: features[<span class="st">'global_features'</span>],</span>
<span id="cb4-11"><a href="#cb4-11"></a>            <span class="st">'image'</span>: image</span>
<span id="cb4-12"><a href="#cb4-12"></a>        }</span>
<span id="cb4-13"><a href="#cb4-13"></a>    </span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="kw">def</span> find_similar_images(<span class="va">self</span>, query_image, top_k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb4-15"><a href="#cb4-15"></a>        <span class="co">"""Find similar images in database"""</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>        query_features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(query_image)[<span class="st">'global_features'</span>]</span>
<span id="cb4-17"><a href="#cb4-17"></a>        </span>
<span id="cb4-18"><a href="#cb4-18"></a>        similarities <span class="op">=</span> []</span>
<span id="cb4-19"><a href="#cb4-19"></a>        </span>
<span id="cb4-20"><a href="#cb4-20"></a>        <span class="cf">for</span> image_id, data <span class="kw">in</span> <span class="va">self</span>.image_database.items():</span>
<span id="cb4-21"><a href="#cb4-21"></a>            <span class="co"># Compute cosine similarity</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>            similarity <span class="op">=</span> <span class="va">self</span>.cosine_similarity(query_features, data[<span class="st">'features'</span>])</span>
<span id="cb4-23"><a href="#cb4-23"></a>            similarities.append((image_id, similarity, data[<span class="st">'image'</span>]))</span>
<span id="cb4-24"><a href="#cb4-24"></a>        </span>
<span id="cb4-25"><a href="#cb4-25"></a>        <span class="co"># Sort by similarity</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>        similarities.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-27"><a href="#cb4-27"></a>        </span>
<span id="cb4-28"><a href="#cb4-28"></a>        <span class="cf">return</span> similarities[:top_k]</span>
<span id="cb4-29"><a href="#cb4-29"></a>    </span>
<span id="cb4-30"><a href="#cb4-30"></a>    <span class="at">@staticmethod</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>    <span class="kw">def</span> cosine_similarity(a, b):</span>
<span id="cb4-32"><a href="#cb4-32"></a>        <span class="co">"""Compute cosine similarity between two vectors"""</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>        <span class="cf">return</span> np.dot(a.flatten(), b.flatten()) <span class="op">/</span> (</span>
<span id="cb4-34"><a href="#cb4-34"></a>            np.linalg.norm(a.flatten()) <span class="op">*</span> np.linalg.norm(b.flatten())</span>
<span id="cb4-35"><a href="#cb4-35"></a>        )</span>
<span id="cb4-36"><a href="#cb4-36"></a></span>
<span id="cb4-37"><a href="#cb4-37"></a>similarity_engine <span class="op">=</span> SimilaritySearchEngine(analyzer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="building-the-web-interface-with-streamlit" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="building-the-web-interface-with-streamlit"><span class="header-section-number">0.5</span> Building the Web Interface with Streamlit</h2>
<p>Now let‚Äôs create an interactive web interface:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># app.py - Main Streamlit application</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">def</span> main():</span>
<span id="cb5-7"><a href="#cb5-7"></a>    st.set_page_config(</span>
<span id="cb5-8"><a href="#cb5-8"></a>        page_title<span class="op">=</span><span class="st">"Smart Photo Analyzer"</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a>        page_icon<span class="op">=</span><span class="st">"üì∏"</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>        layout<span class="op">=</span><span class="st">"wide"</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    )</span>
<span id="cb5-12"><a href="#cb5-12"></a>    </span>
<span id="cb5-13"><a href="#cb5-13"></a>    st.title(<span class="st">"üì∏ Smart Photo Analyzer"</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a>    st.markdown(<span class="st">"Upload an image and discover its secrets using computer vision!"</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a>    </span>
<span id="cb5-16"><a href="#cb5-16"></a>    <span class="co"># Sidebar for navigation</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>    st.sidebar.title(<span class="st">"Navigation"</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a>    page <span class="op">=</span> st.sidebar.selectbox(</span>
<span id="cb5-19"><a href="#cb5-19"></a>        <span class="st">"Choose a feature:"</span>,</span>
<span id="cb5-20"><a href="#cb5-20"></a>        [<span class="st">"Image Analysis"</span>, <span class="st">"Apply Filters"</span>, <span class="st">"Similar Images"</span>, <span class="st">"About"</span>]</span>
<span id="cb5-21"><a href="#cb5-21"></a>    )</span>
<span id="cb5-22"><a href="#cb5-22"></a>    </span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="cf">if</span> page <span class="op">==</span> <span class="st">"Image Analysis"</span>:</span>
<span id="cb5-24"><a href="#cb5-24"></a>        image_analysis_page()</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="cf">elif</span> page <span class="op">==</span> <span class="st">"Apply Filters"</span>:</span>
<span id="cb5-26"><a href="#cb5-26"></a>        filters_page()</span>
<span id="cb5-27"><a href="#cb5-27"></a>    <span class="cf">elif</span> page <span class="op">==</span> <span class="st">"Similar Images"</span>:</span>
<span id="cb5-28"><a href="#cb5-28"></a>        similarity_page()</span>
<span id="cb5-29"><a href="#cb5-29"></a>    <span class="cf">else</span>:</span>
<span id="cb5-30"><a href="#cb5-30"></a>        about_page()</span>
<span id="cb5-31"><a href="#cb5-31"></a></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="kw">def</span> image_analysis_page():</span>
<span id="cb5-33"><a href="#cb5-33"></a>    st.header(<span class="st">"üîç Image Analysis"</span>)</span>
<span id="cb5-34"><a href="#cb5-34"></a>    </span>
<span id="cb5-35"><a href="#cb5-35"></a>    <span class="co"># File uploader</span></span>
<span id="cb5-36"><a href="#cb5-36"></a>    uploaded_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb5-37"><a href="#cb5-37"></a>        <span class="st">"Choose an image file"</span>,</span>
<span id="cb5-38"><a href="#cb5-38"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb5-39"><a href="#cb5-39"></a>        <span class="bu">help</span><span class="op">=</span><span class="st">"Upload an image to analyze"</span></span>
<span id="cb5-40"><a href="#cb5-40"></a>    )</span>
<span id="cb5-41"><a href="#cb5-41"></a>    </span>
<span id="cb5-42"><a href="#cb5-42"></a>    <span class="cf">if</span> uploaded_file <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb5-43"><a href="#cb5-43"></a>        <span class="co"># Load and display image</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(uploaded_file)</span>
<span id="cb5-45"><a href="#cb5-45"></a>        image_array <span class="op">=</span> np.array(image)</span>
<span id="cb5-46"><a href="#cb5-46"></a>        </span>
<span id="cb5-47"><a href="#cb5-47"></a>        col1, col2 <span class="op">=</span> st.columns(<span class="dv">2</span>)</span>
<span id="cb5-48"><a href="#cb5-48"></a>        </span>
<span id="cb5-49"><a href="#cb5-49"></a>        <span class="cf">with</span> col1:</span>
<span id="cb5-50"><a href="#cb5-50"></a>            st.subheader(<span class="st">"Original Image"</span>)</span>
<span id="cb5-51"><a href="#cb5-51"></a>            st.image(image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-52"><a href="#cb5-52"></a>        </span>
<span id="cb5-53"><a href="#cb5-53"></a>        <span class="cf">with</span> col2:</span>
<span id="cb5-54"><a href="#cb5-54"></a>            st.subheader(<span class="st">"Analysis Results"</span>)</span>
<span id="cb5-55"><a href="#cb5-55"></a>            </span>
<span id="cb5-56"><a href="#cb5-56"></a>            <span class="co"># Basic properties</span></span>
<span id="cb5-57"><a href="#cb5-57"></a>            <span class="cf">with</span> st.expander(<span class="st">"üìä Basic Properties"</span>, expanded<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb5-58"><a href="#cb5-58"></a>                properties <span class="op">=</span> analyzer.analyze_basic_properties(image_array)</span>
<span id="cb5-59"><a href="#cb5-59"></a>                </span>
<span id="cb5-60"><a href="#cb5-60"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> properties.items():</span>
<span id="cb5-61"><a href="#cb5-61"></a>                    <span class="cf">if</span> key <span class="op">!=</span> <span class="st">'dominant_colors'</span>:</span>
<span id="cb5-62"><a href="#cb5-62"></a>                        st.metric(key.replace(<span class="st">'_'</span>, <span class="st">' '</span>).title(), value)</span>
<span id="cb5-63"><a href="#cb5-63"></a>                </span>
<span id="cb5-64"><a href="#cb5-64"></a>                <span class="co"># Display dominant colors</span></span>
<span id="cb5-65"><a href="#cb5-65"></a>                <span class="cf">if</span> properties[<span class="st">'dominant_colors'</span>]:</span>
<span id="cb5-66"><a href="#cb5-66"></a>                    st.write(<span class="st">"**Dominant Colors:**"</span>)</span>
<span id="cb5-67"><a href="#cb5-67"></a>                    colors_html <span class="op">=</span> <span class="st">""</span></span>
<span id="cb5-68"><a href="#cb5-68"></a>                    <span class="cf">for</span> color <span class="kw">in</span> properties[<span class="st">'dominant_colors'</span>]:</span>
<span id="cb5-69"><a href="#cb5-69"></a>                        hex_color <span class="op">=</span> <span class="ss">f"#</span><span class="sc">{</span>color[<span class="dv">0</span>]<span class="sc">:02x}{</span>color[<span class="dv">1</span>]<span class="sc">:02x}{</span>color[<span class="dv">2</span>]<span class="sc">:02x}</span><span class="ss">"</span></span>
<span id="cb5-70"><a href="#cb5-70"></a>                        colors_html <span class="op">+=</span> <span class="ss">f'&lt;div style="display:inline-block; width:30px; height:30px; background-color:</span><span class="sc">{</span>hex_color<span class="sc">}</span><span class="ss">; margin:2px; border:1px solid #ccc;"&gt;&lt;/div&gt;'</span></span>
<span id="cb5-71"><a href="#cb5-71"></a>                    st.markdown(colors_html, unsafe_allow_html<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-72"><a href="#cb5-72"></a>            </span>
<span id="cb5-73"><a href="#cb5-73"></a>            <span class="co"># Classification results</span></span>
<span id="cb5-74"><a href="#cb5-74"></a>            <span class="cf">with</span> st.expander(<span class="st">"üè∑Ô∏è Object Classification"</span>, expanded<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb5-75"><a href="#cb5-75"></a>                <span class="cf">with</span> st.spinner(<span class="st">"Classifying image..."</span>):</span>
<span id="cb5-76"><a href="#cb5-76"></a>                    classification_results <span class="op">=</span> analyzer.classify_image(image)</span>
<span id="cb5-77"><a href="#cb5-77"></a>                </span>
<span id="cb5-78"><a href="#cb5-78"></a>                <span class="cf">for</span> i, result <span class="kw">in</span> <span class="bu">enumerate</span>(classification_results):</span>
<span id="cb5-79"><a href="#cb5-79"></a>                    confidence_percent <span class="op">=</span> result[<span class="st">'confidence'</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-80"><a href="#cb5-80"></a>                    st.write(<span class="ss">f"**</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>result[<span class="st">'class'</span>]<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">** - </span><span class="sc">{</span>confidence_percent<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb5-81"><a href="#cb5-81"></a>                    st.progress(result[<span class="st">'confidence'</span>])</span>
<span id="cb5-82"><a href="#cb5-82"></a>            </span>
<span id="cb5-83"><a href="#cb5-83"></a>            <span class="co"># Feature visualization</span></span>
<span id="cb5-84"><a href="#cb5-84"></a>            <span class="cf">with</span> st.expander(<span class="st">"üß† Deep Learning Features"</span>):</span>
<span id="cb5-85"><a href="#cb5-85"></a>                <span class="cf">with</span> st.spinner(<span class="st">"Extracting features..."</span>):</span>
<span id="cb5-86"><a href="#cb5-86"></a>                    features <span class="op">=</span> analyzer.extract_features(image)</span>
<span id="cb5-87"><a href="#cb5-87"></a>                </span>
<span id="cb5-88"><a href="#cb5-88"></a>                st.write(<span class="ss">f"**Feature Dimension:** </span><span class="sc">{</span>features[<span class="st">'feature_dimension'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-89"><a href="#cb5-89"></a>                </span>
<span id="cb5-90"><a href="#cb5-90"></a>                <span class="co"># Plot feature distribution</span></span>
<span id="cb5-91"><a href="#cb5-91"></a>                global_features <span class="op">=</span> features[<span class="st">'global_features'</span>].flatten()</span>
<span id="cb5-92"><a href="#cb5-92"></a>                fig <span class="op">=</span> px.histogram(</span>
<span id="cb5-93"><a href="#cb5-93"></a>                    x<span class="op">=</span>global_features,</span>
<span id="cb5-94"><a href="#cb5-94"></a>                    title<span class="op">=</span><span class="st">"Global Feature Distribution"</span>,</span>
<span id="cb5-95"><a href="#cb5-95"></a>                    labels<span class="op">=</span>{<span class="st">'x'</span>: <span class="st">'Feature Value'</span>, <span class="st">'y'</span>: <span class="st">'Frequency'</span>}</span>
<span id="cb5-96"><a href="#cb5-96"></a>                )</span>
<span id="cb5-97"><a href="#cb5-97"></a>                st.plotly_chart(fig, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-98"><a href="#cb5-98"></a></span>
<span id="cb5-99"><a href="#cb5-99"></a><span class="kw">def</span> filters_page():</span>
<span id="cb5-100"><a href="#cb5-100"></a>    st.header(<span class="st">"üé® Apply Artistic Filters"</span>)</span>
<span id="cb5-101"><a href="#cb5-101"></a>    </span>
<span id="cb5-102"><a href="#cb5-102"></a>    uploaded_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb5-103"><a href="#cb5-103"></a>        <span class="st">"Choose an image file"</span>,</span>
<span id="cb5-104"><a href="#cb5-104"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb5-105"><a href="#cb5-105"></a>        key<span class="op">=</span><span class="st">"filters_uploader"</span></span>
<span id="cb5-106"><a href="#cb5-106"></a>    )</span>
<span id="cb5-107"><a href="#cb5-107"></a>    </span>
<span id="cb5-108"><a href="#cb5-108"></a>    <span class="cf">if</span> uploaded_file <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb5-109"><a href="#cb5-109"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(uploaded_file)</span>
<span id="cb5-110"><a href="#cb5-110"></a>        image_array <span class="op">=</span> np.array(image)</span>
<span id="cb5-111"><a href="#cb5-111"></a>        </span>
<span id="cb5-112"><a href="#cb5-112"></a>        <span class="co"># Filter selection</span></span>
<span id="cb5-113"><a href="#cb5-113"></a>        available_filters <span class="op">=</span> filters.get_available_filters()</span>
<span id="cb5-114"><a href="#cb5-114"></a>        selected_filter <span class="op">=</span> st.selectbox(</span>
<span id="cb5-115"><a href="#cb5-115"></a>            <span class="st">"Choose a filter:"</span>,</span>
<span id="cb5-116"><a href="#cb5-116"></a>            options<span class="op">=</span><span class="bu">list</span>(available_filters.keys()),</span>
<span id="cb5-117"><a href="#cb5-117"></a>            format_func<span class="op">=</span><span class="kw">lambda</span> x: available_filters[x]</span>
<span id="cb5-118"><a href="#cb5-118"></a>        )</span>
<span id="cb5-119"><a href="#cb5-119"></a>        </span>
<span id="cb5-120"><a href="#cb5-120"></a>        col1, col2 <span class="op">=</span> st.columns(<span class="dv">2</span>)</span>
<span id="cb5-121"><a href="#cb5-121"></a>        </span>
<span id="cb5-122"><a href="#cb5-122"></a>        <span class="cf">with</span> col1:</span>
<span id="cb5-123"><a href="#cb5-123"></a>            st.subheader(<span class="st">"Original"</span>)</span>
<span id="cb5-124"><a href="#cb5-124"></a>            st.image(image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-125"><a href="#cb5-125"></a>        </span>
<span id="cb5-126"><a href="#cb5-126"></a>        <span class="cf">with</span> col2:</span>
<span id="cb5-127"><a href="#cb5-127"></a>            st.subheader(<span class="ss">f"With </span><span class="sc">{</span>available_filters[selected_filter]<span class="sc">}</span><span class="ss"> Filter"</span>)</span>
<span id="cb5-128"><a href="#cb5-128"></a>            </span>
<span id="cb5-129"><a href="#cb5-129"></a>            <span class="cf">with</span> st.spinner(<span class="st">"Applying filter..."</span>):</span>
<span id="cb5-130"><a href="#cb5-130"></a>                <span class="cf">if</span> selected_filter <span class="op">==</span> <span class="st">'blur'</span>:</span>
<span id="cb5-131"><a href="#cb5-131"></a>                    kernel_size <span class="op">=</span> st.slider(<span class="st">"Blur intensity"</span>, <span class="dv">1</span>, <span class="dv">31</span>, <span class="dv">15</span>, step<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb5-132"><a href="#cb5-132"></a>                    filtered_image <span class="op">=</span> filters.apply_blur(image_array, kernel_size)</span>
<span id="cb5-133"><a href="#cb5-133"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'sharpen'</span>:</span>
<span id="cb5-134"><a href="#cb5-134"></a>                    filtered_image <span class="op">=</span> filters.apply_sharpen(image_array)</span>
<span id="cb5-135"><a href="#cb5-135"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'edges'</span>:</span>
<span id="cb5-136"><a href="#cb5-136"></a>                    filtered_image <span class="op">=</span> filters.apply_edge_detection(image_array)</span>
<span id="cb5-137"><a href="#cb5-137"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'vintage'</span>:</span>
<span id="cb5-138"><a href="#cb5-138"></a>                    filtered_image <span class="op">=</span> filters.apply_vintage(image_array)</span>
<span id="cb5-139"><a href="#cb5-139"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'cartoon'</span>:</span>
<span id="cb5-140"><a href="#cb5-140"></a>                    filtered_image <span class="op">=</span> filters.apply_cartoon(image_array)</span>
<span id="cb5-141"><a href="#cb5-141"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'oil'</span>:</span>
<span id="cb5-142"><a href="#cb5-142"></a>                    size <span class="op">=</span> st.slider(<span class="st">"Brush size"</span>, <span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">7</span>)</span>
<span id="cb5-143"><a href="#cb5-143"></a>                    filtered_image <span class="op">=</span> filters.apply_oil_painting(image_array, size)</span>
<span id="cb5-144"><a href="#cb5-144"></a>            </span>
<span id="cb5-145"><a href="#cb5-145"></a>            st.image(filtered_image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-146"><a href="#cb5-146"></a>            </span>
<span id="cb5-147"><a href="#cb5-147"></a>            <span class="co"># Download button</span></span>
<span id="cb5-148"><a href="#cb5-148"></a>            filtered_pil <span class="op">=</span> Image.fromarray(filtered_image)</span>
<span id="cb5-149"><a href="#cb5-149"></a>            buf <span class="op">=</span> io.BytesIO()</span>
<span id="cb5-150"><a href="#cb5-150"></a>            filtered_pil.save(buf, <span class="bu">format</span><span class="op">=</span><span class="st">'PNG'</span>)</span>
<span id="cb5-151"><a href="#cb5-151"></a>            buf.seek(<span class="dv">0</span>)</span>
<span id="cb5-152"><a href="#cb5-152"></a>            </span>
<span id="cb5-153"><a href="#cb5-153"></a>            st.download_button(</span>
<span id="cb5-154"><a href="#cb5-154"></a>                label<span class="op">=</span><span class="st">"Download Filtered Image"</span>,</span>
<span id="cb5-155"><a href="#cb5-155"></a>                data<span class="op">=</span>buf,</span>
<span id="cb5-156"><a href="#cb5-156"></a>                file_name<span class="op">=</span><span class="ss">f"filtered_</span><span class="sc">{</span>selected_filter<span class="sc">}</span><span class="ss">.png"</span>,</span>
<span id="cb5-157"><a href="#cb5-157"></a>                mime<span class="op">=</span><span class="st">"image/png"</span></span>
<span id="cb5-158"><a href="#cb5-158"></a>            )</span>
<span id="cb5-159"><a href="#cb5-159"></a></span>
<span id="cb5-160"><a href="#cb5-160"></a><span class="kw">def</span> similarity_page():</span>
<span id="cb5-161"><a href="#cb5-161"></a>    st.header(<span class="st">"üîó Find Similar Images"</span>)</span>
<span id="cb5-162"><a href="#cb5-162"></a>    </span>
<span id="cb5-163"><a href="#cb5-163"></a>    <span class="co"># Initialize session state for image database</span></span>
<span id="cb5-164"><a href="#cb5-164"></a>    <span class="cf">if</span> <span class="st">'database_images'</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb5-165"><a href="#cb5-165"></a>        st.session_state.database_images <span class="op">=</span> []</span>
<span id="cb5-166"><a href="#cb5-166"></a>    </span>
<span id="cb5-167"><a href="#cb5-167"></a>    <span class="co"># Upload images to database</span></span>
<span id="cb5-168"><a href="#cb5-168"></a>    st.subheader(<span class="st">"Step 1: Build Image Database"</span>)</span>
<span id="cb5-169"><a href="#cb5-169"></a>    uploaded_files <span class="op">=</span> st.file_uploader(</span>
<span id="cb5-170"><a href="#cb5-170"></a>        <span class="st">"Upload multiple images to build a database"</span>,</span>
<span id="cb5-171"><a href="#cb5-171"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb5-172"><a href="#cb5-172"></a>        accept_multiple_files<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-173"><a href="#cb5-173"></a>        key<span class="op">=</span><span class="st">"database_uploader"</span></span>
<span id="cb5-174"><a href="#cb5-174"></a>    )</span>
<span id="cb5-175"><a href="#cb5-175"></a>    </span>
<span id="cb5-176"><a href="#cb5-176"></a>    <span class="cf">if</span> uploaded_files:</span>
<span id="cb5-177"><a href="#cb5-177"></a>        <span class="cf">for</span> i, <span class="bu">file</span> <span class="kw">in</span> <span class="bu">enumerate</span>(uploaded_files):</span>
<span id="cb5-178"><a href="#cb5-178"></a>            image <span class="op">=</span> Image.<span class="bu">open</span>(<span class="bu">file</span>)</span>
<span id="cb5-179"><a href="#cb5-179"></a>            similarity_engine.add_image_to_database(<span class="ss">f"image_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, image)</span>
<span id="cb5-180"><a href="#cb5-180"></a>            st.session_state.database_images.append((<span class="ss">f"image_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, image))</span>
<span id="cb5-181"><a href="#cb5-181"></a>        </span>
<span id="cb5-182"><a href="#cb5-182"></a>        st.success(<span class="ss">f"Added </span><span class="sc">{</span><span class="bu">len</span>(uploaded_files)<span class="sc">}</span><span class="ss"> images to database!"</span>)</span>
<span id="cb5-183"><a href="#cb5-183"></a>    </span>
<span id="cb5-184"><a href="#cb5-184"></a>    <span class="co"># Query image</span></span>
<span id="cb5-185"><a href="#cb5-185"></a>    st.subheader(<span class="st">"Step 2: Search for Similar Images"</span>)</span>
<span id="cb5-186"><a href="#cb5-186"></a>    query_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb5-187"><a href="#cb5-187"></a>        <span class="st">"Upload a query image"</span>,</span>
<span id="cb5-188"><a href="#cb5-188"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb5-189"><a href="#cb5-189"></a>        key<span class="op">=</span><span class="st">"query_uploader"</span></span>
<span id="cb5-190"><a href="#cb5-190"></a>    )</span>
<span id="cb5-191"><a href="#cb5-191"></a>    </span>
<span id="cb5-192"><a href="#cb5-192"></a>    <span class="cf">if</span> query_file <span class="kw">and</span> st.session_state.database_images:</span>
<span id="cb5-193"><a href="#cb5-193"></a>        query_image <span class="op">=</span> Image.<span class="bu">open</span>(query_file)</span>
<span id="cb5-194"><a href="#cb5-194"></a>        </span>
<span id="cb5-195"><a href="#cb5-195"></a>        col1, col2 <span class="op">=</span> st.columns([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb5-196"><a href="#cb5-196"></a>        </span>
<span id="cb5-197"><a href="#cb5-197"></a>        <span class="cf">with</span> col1:</span>
<span id="cb5-198"><a href="#cb5-198"></a>            st.subheader(<span class="st">"Query Image"</span>)</span>
<span id="cb5-199"><a href="#cb5-199"></a>            st.image(query_image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-200"><a href="#cb5-200"></a>        </span>
<span id="cb5-201"><a href="#cb5-201"></a>        <span class="cf">with</span> col2:</span>
<span id="cb5-202"><a href="#cb5-202"></a>            st.subheader(<span class="st">"Similar Images"</span>)</span>
<span id="cb5-203"><a href="#cb5-203"></a>            </span>
<span id="cb5-204"><a href="#cb5-204"></a>            <span class="cf">with</span> st.spinner(<span class="st">"Searching for similar images..."</span>):</span>
<span id="cb5-205"><a href="#cb5-205"></a>                similar_images <span class="op">=</span> similarity_engine.find_similar_images(query_image, top_k<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb5-206"><a href="#cb5-206"></a>            </span>
<span id="cb5-207"><a href="#cb5-207"></a>            <span class="cf">for</span> i, (image_id, similarity, similar_image) <span class="kw">in</span> <span class="bu">enumerate</span>(similar_images):</span>
<span id="cb5-208"><a href="#cb5-208"></a>                st.write(<span class="ss">f"**Rank </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">** - Similarity: </span><span class="sc">{</span>similarity<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb5-209"><a href="#cb5-209"></a>                st.image(similar_image, width<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb5-210"><a href="#cb5-210"></a></span>
<span id="cb5-211"><a href="#cb5-211"></a><span class="kw">def</span> about_page():</span>
<span id="cb5-212"><a href="#cb5-212"></a>    st.header(<span class="st">"About Smart Photo Analyzer"</span>)</span>
<span id="cb5-213"><a href="#cb5-213"></a>    </span>
<span id="cb5-214"><a href="#cb5-214"></a>    st.markdown(<span class="st">"""</span></span>
<span id="cb5-215"><a href="#cb5-215"></a><span class="st">    ## üéØ What This App Does</span></span>
<span id="cb5-216"><a href="#cb5-216"></a><span class="st">    </span></span>
<span id="cb5-217"><a href="#cb5-217"></a><span class="st">    The Smart Photo Analyzer demonstrates the power of computer vision by combining:</span></span>
<span id="cb5-218"><a href="#cb5-218"></a><span class="st">    </span></span>
<span id="cb5-219"><a href="#cb5-219"></a><span class="st">    - **Classical Computer Vision** (OpenCV filters and image processing)</span></span>
<span id="cb5-220"><a href="#cb5-220"></a><span class="st">    - **Deep Learning** (ResNet for classification)</span></span>
<span id="cb5-221"><a href="#cb5-221"></a><span class="st">    - **Foundation Models** (DINOv2 for feature extraction)</span></span>
<span id="cb5-222"><a href="#cb5-222"></a><span class="st">    </span></span>
<span id="cb5-223"><a href="#cb5-223"></a><span class="st">    ## üõ†Ô∏è Technologies Used</span></span>
<span id="cb5-224"><a href="#cb5-224"></a><span class="st">    </span></span>
<span id="cb5-225"><a href="#cb5-225"></a><span class="st">    - **OpenCV**: Image processing and filters</span></span>
<span id="cb5-226"><a href="#cb5-226"></a><span class="st">    - **PyTorch**: Deep learning framework</span></span>
<span id="cb5-227"><a href="#cb5-227"></a><span class="st">    - **Transformers**: HuggingFace models</span></span>
<span id="cb5-228"><a href="#cb5-228"></a><span class="st">    - **Streamlit**: Web interface</span></span>
<span id="cb5-229"><a href="#cb5-229"></a><span class="st">    - **DINOv2**: Self-supervised feature extraction</span></span>
<span id="cb5-230"><a href="#cb5-230"></a><span class="st">    </span></span>
<span id="cb5-231"><a href="#cb5-231"></a><span class="st">    ## üìö What You've Learned</span></span>
<span id="cb5-232"><a href="#cb5-232"></a><span class="st">    </span></span>
<span id="cb5-233"><a href="#cb5-233"></a><span class="st">    By building this app, you've mastered:</span></span>
<span id="cb5-234"><a href="#cb5-234"></a><span class="st">    </span></span>
<span id="cb5-235"><a href="#cb5-235"></a><span class="st">    1. **Image basics** - Understanding pixels and arrays</span></span>
<span id="cb5-236"><a href="#cb5-236"></a><span class="st">    2. **OpenCV operations** - Resize, crop, filter, detect edges</span></span>
<span id="cb5-237"><a href="#cb5-237"></a><span class="st">    3. **Pattern recognition** - Finding shapes and contours</span></span>
<span id="cb5-238"><a href="#cb5-238"></a><span class="st">    4. **Feature matching** - Keypoints and descriptors</span></span>
<span id="cb5-239"><a href="#cb5-239"></a><span class="st">    5. **Deep learning** - CNNs and classification</span></span>
<span id="cb5-240"><a href="#cb5-240"></a><span class="st">    6. **Modern models** - Vision Transformers and foundation models</span></span>
<span id="cb5-241"><a href="#cb5-241"></a><span class="st">    7. **Application development** - Building real-world projects</span></span>
<span id="cb5-242"><a href="#cb5-242"></a><span class="st">    </span></span>
<span id="cb5-243"><a href="#cb5-243"></a><span class="st">    ## üöÄ Next Steps</span></span>
<span id="cb5-244"><a href="#cb5-244"></a><span class="st">    </span></span>
<span id="cb5-245"><a href="#cb5-245"></a><span class="st">    - Deploy this app to the cloud (Heroku, Streamlit Cloud)</span></span>
<span id="cb5-246"><a href="#cb5-246"></a><span class="st">    - Add more advanced features (object detection, segmentation)</span></span>
<span id="cb5-247"><a href="#cb5-247"></a><span class="st">    - Experiment with other foundation models</span></span>
<span id="cb5-248"><a href="#cb5-248"></a><span class="st">    - Build your own computer vision startup! üéâ</span></span>
<span id="cb5-249"><a href="#cb5-249"></a><span class="st">    """</span>)</span>
<span id="cb5-250"><a href="#cb5-250"></a></span>
<span id="cb5-251"><a href="#cb5-251"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb5-252"><a href="#cb5-252"></a>    main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="deployment-options" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="deployment-options"><span class="header-section-number">0.6</span> Deployment Options</h2>
<section id="option-1-local-deployment" class="level3" data-number="0.6.1">
<h3 data-number="0.6.1" class="anchored" data-anchor-id="option-1-local-deployment"><span class="header-section-number">0.6.1</span> Option 1: Local Deployment</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Create requirements.txt</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">pip</span> freeze <span class="op">&gt;</span> requirements.txt</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Run the app</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="ex">streamlit</span> run app.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="option-2-streamlit-cloud" class="level3" data-number="0.6.2">
<h3 data-number="0.6.2" class="anchored" data-anchor-id="option-2-streamlit-cloud"><span class="header-section-number">0.6.2</span> Option 2: Streamlit Cloud</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Create a GitHub repository with your code</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Connect to Streamlit Cloud</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Deploy with one click!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="option-3-docker-deployment" class="level3" data-number="0.6.3">
<h3 data-number="0.6.3" class="anchored" data-anchor-id="option-3-docker-deployment"><span class="header-section-number">0.6.3</span> Option 3: Docker Deployment</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource dockerfile number-lines code-with-copy"><code class="sourceCode dockerfile"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Dockerfile</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw">COPY</span> . .</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="kw">EXPOSE</span> 8501</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="kw">CMD</span> [<span class="st">"streamlit"</span>, <span class="st">"run"</span>, <span class="st">"app.py"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-features-to-add" class="level2" data-number="0.7">
<h2 data-number="0.7" class="anchored" data-anchor-id="advanced-features-to-add"><span class="header-section-number">0.7</span> Advanced Features to Add</h2>
<section id="batch-processing" class="level3" data-number="0.7.1">
<h3 data-number="0.7.1" class="anchored" data-anchor-id="batch-processing"><span class="header-section-number">0.7.1</span> 1. Batch Processing</h3>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> process_image_batch(images):</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co">"""Process multiple images at once"""</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    results <span class="op">=</span> []</span>
<span id="cb9-4"><a href="#cb9-4"></a>    </span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="cf">for</span> image <span class="kw">in</span> images:</span>
<span id="cb9-6"><a href="#cb9-6"></a>        result <span class="op">=</span> {</span>
<span id="cb9-7"><a href="#cb9-7"></a>            <span class="st">'properties'</span>: analyzer.analyze_basic_properties(image),</span>
<span id="cb9-8"><a href="#cb9-8"></a>            <span class="st">'classification'</span>: analyzer.classify_image(image),</span>
<span id="cb9-9"><a href="#cb9-9"></a>            <span class="st">'features'</span>: analyzer.extract_features(image)</span>
<span id="cb9-10"><a href="#cb9-10"></a>        }</span>
<span id="cb9-11"><a href="#cb9-11"></a>        results.append(result)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    </span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="cf">return</span> results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="custom-model-training" class="level3" data-number="0.7.2">
<h3 data-number="0.7.2" class="anchored" data-anchor-id="custom-model-training"><span class="header-section-number">0.7.2</span> 2. Custom Model Training</h3>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">class</span> CustomClassifier:</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb10-3"><a href="#cb10-3"></a>        <span class="va">self</span>.model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>        <span class="co"># Modify final layer for your specific classes</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>        <span class="va">self</span>.model.fc <span class="op">=</span> nn.Linear(<span class="va">self</span>.model.fc.in_features, num_custom_classes)</span>
<span id="cb10-6"><a href="#cb10-6"></a>    </span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="kw">def</span> train(<span class="va">self</span>, train_loader, val_loader, epochs<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb10-8"><a href="#cb10-8"></a>        <span class="co">"""Train the model on custom data"""</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>        <span class="co"># Training loop implementation</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>        <span class="cf">pass</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>    </span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="kw">def</span> save_model(<span class="va">self</span>, path):</span>
<span id="cb10-13"><a href="#cb10-13"></a>        <span class="co">"""Save trained model"""</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>        torch.save(<span class="va">self</span>.model.state_dict(), path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="real-time-video-processing" class="level3" data-number="0.7.3">
<h3 data-number="0.7.3" class="anchored" data-anchor-id="real-time-video-processing"><span class="header-section-number">0.7.3</span> 3. Real-time Video Processing</h3>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">def</span> process_video_stream():</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="co">"""Process video stream in real-time"""</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>    cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)  <span class="co"># Webcam</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>    </span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb11-6"><a href="#cb11-6"></a>        ret, frame <span class="op">=</span> cap.read()</span>
<span id="cb11-7"><a href="#cb11-7"></a>        <span class="cf">if</span> ret:</span>
<span id="cb11-8"><a href="#cb11-8"></a>            <span class="co"># Apply analysis to each frame</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>            processed_frame <span class="op">=</span> analyzer.classify_image(frame)</span>
<span id="cb11-10"><a href="#cb11-10"></a>            cv2.imshow(<span class="st">'Smart Video Analyzer'</span>, processed_frame)</span>
<span id="cb11-11"><a href="#cb11-11"></a>        </span>
<span id="cb11-12"><a href="#cb11-12"></a>        <span class="cf">if</span> cv2.waitKey(<span class="dv">1</span>) <span class="op">&amp;</span> <span class="bn">0xFF</span> <span class="op">==</span> <span class="bu">ord</span>(<span class="st">'q'</span>):</span>
<span id="cb11-13"><a href="#cb11-13"></a>            <span class="cf">break</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>    </span>
<span id="cb11-15"><a href="#cb11-15"></a>    cap.release()</span>
<span id="cb11-16"><a href="#cb11-16"></a>    cv2.destroyAllWindows()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="testing-your-application" class="level2" data-number="0.8">
<h2 data-number="0.8" class="anchored" data-anchor-id="testing-your-application"><span class="header-section-number">0.8</span> Testing Your Application</h2>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> unittest</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">class</span> TestSmartPhotoAnalyzer(unittest.TestCase):</span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="kw">def</span> setUp(<span class="va">self</span>):</span>
<span id="cb12-5"><a href="#cb12-5"></a>        <span class="va">self</span>.analyzer <span class="op">=</span> SmartImageAnalyzer()</span>
<span id="cb12-6"><a href="#cb12-6"></a>        <span class="va">self</span>.test_image <span class="op">=</span> Image.new(<span class="st">'RGB'</span>, (<span class="dv">224</span>, <span class="dv">224</span>), color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>    </span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="kw">def</span> test_basic_analysis(<span class="va">self</span>):</span>
<span id="cb12-9"><a href="#cb12-9"></a>        <span class="co">"""Test basic image analysis"""</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>        properties <span class="op">=</span> <span class="va">self</span>.analyzer.analyze_basic_properties(<span class="va">self</span>.test_image)</span>
<span id="cb12-11"><a href="#cb12-11"></a>        <span class="va">self</span>.assertIn(<span class="st">'dimensions'</span>, properties)</span>
<span id="cb12-12"><a href="#cb12-12"></a>        <span class="va">self</span>.assertIn(<span class="st">'channels'</span>, properties)</span>
<span id="cb12-13"><a href="#cb12-13"></a>    </span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="kw">def</span> test_classification(<span class="va">self</span>):</span>
<span id="cb12-15"><a href="#cb12-15"></a>        <span class="co">"""Test image classification"""</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>        results <span class="op">=</span> <span class="va">self</span>.analyzer.classify_image(<span class="va">self</span>.test_image)</span>
<span id="cb12-17"><a href="#cb12-17"></a>        <span class="va">self</span>.assertEqual(<span class="bu">len</span>(results), <span class="dv">5</span>)  <span class="co"># Top 5 predictions</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>        <span class="va">self</span>.assertTrue(<span class="bu">all</span>(<span class="st">'class'</span> <span class="kw">in</span> r <span class="kw">and</span> <span class="st">'confidence'</span> <span class="kw">in</span> r <span class="cf">for</span> r <span class="kw">in</span> results))</span>
<span id="cb12-19"><a href="#cb12-19"></a>    </span>
<span id="cb12-20"><a href="#cb12-20"></a>    <span class="kw">def</span> test_feature_extraction(<span class="va">self</span>):</span>
<span id="cb12-21"><a href="#cb12-21"></a>        <span class="co">"""Test feature extraction"""</span></span>
<span id="cb12-22"><a href="#cb12-22"></a>        features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(<span class="va">self</span>.test_image)</span>
<span id="cb12-23"><a href="#cb12-23"></a>        <span class="va">self</span>.assertIn(<span class="st">'global_features'</span>, features)</span>
<span id="cb12-24"><a href="#cb12-24"></a>        <span class="va">self</span>.assertIn(<span class="st">'feature_dimension'</span>, features)</span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb12-27"><a href="#cb12-27"></a>    unittest.main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="performance-optimization" class="level2" data-number="0.9">
<h2 data-number="0.9" class="anchored" data-anchor-id="performance-optimization"><span class="header-section-number">0.9</span> Performance Optimization</h2>
<section id="model-caching" class="level3" data-number="0.9.1">
<h3 data-number="0.9.1" class="anchored" data-anchor-id="model-caching"><span class="header-section-number">0.9.1</span> 1. Model Caching</h3>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="at">@st.cache_resource</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">def</span> load_models():</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="co">"""Cache models to avoid reloading"""</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="cf">return</span> SmartImageAnalyzer()</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># Use cached models</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>analyzer <span class="op">=</span> load_models()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="image-preprocessing-optimization" class="level3" data-number="0.9.2">
<h3 data-number="0.9.2" class="anchored" data-anchor-id="image-preprocessing-optimization"><span class="header-section-number">0.9.2</span> 2. Image Preprocessing Optimization</h3>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">def</span> optimize_image_size(image, max_size<span class="op">=</span><span class="dv">1024</span>):</span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="co">"""Resize large images for faster processing"""</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>    width, height <span class="op">=</span> image.size</span>
<span id="cb14-4"><a href="#cb14-4"></a>    </span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="cf">if</span> <span class="bu">max</span>(width, height) <span class="op">&gt;</span> max_size:</span>
<span id="cb14-6"><a href="#cb14-6"></a>        ratio <span class="op">=</span> max_size <span class="op">/</span> <span class="bu">max</span>(width, height)</span>
<span id="cb14-7"><a href="#cb14-7"></a>        new_width <span class="op">=</span> <span class="bu">int</span>(width <span class="op">*</span> ratio)</span>
<span id="cb14-8"><a href="#cb14-8"></a>        new_height <span class="op">=</span> <span class="bu">int</span>(height <span class="op">*</span> ratio)</span>
<span id="cb14-9"><a href="#cb14-9"></a>        image <span class="op">=</span> image.resize((new_width, new_height), Image.Resampling.LANCZOS)</span>
<span id="cb14-10"><a href="#cb14-10"></a>    </span>
<span id="cb14-11"><a href="#cb14-11"></a>    <span class="cf">return</span> image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="your-portfolio-showcase" class="level2" data-number="0.10">
<h2 data-number="0.10" class="anchored" data-anchor-id="your-portfolio-showcase"><span class="header-section-number">0.10</span> Your Portfolio Showcase</h2>
<section id="creating-a-professional-readme" class="level3" data-number="0.10.1">
<h3 data-number="0.10.1" class="anchored" data-anchor-id="creating-a-professional-readme"><span class="header-section-number">0.10.1</span> Creating a Professional README</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu"># Smart Photo Analyzer</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>A comprehensive computer vision application that analyzes images using classical and modern techniques.</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="fu">## Features</span></span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="ss">- </span>üîç **Image Analysis**: Extract detailed properties and statistics</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="ss">- </span>üè∑Ô∏è **Object Classification**: Identify objects using deep learning</span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="ss">- </span>üé® **Artistic Filters**: Apply creative effects using OpenCV</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="ss">- </span>üîó **Similarity Search**: Find similar images using DINOv2 features</span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="fu">## Demo</span></span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="al">![Demo GIF](demo.gif)</span></span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="fu">## Installation</span></span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="in">```bash</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="ex">streamlit</span> run app.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="technologies" class="level2" data-number="0.11">
<h2 data-number="0.11" class="anchored" data-anchor-id="technologies"><span class="header-section-number">0.11</span> Technologies</h2>
<ul>
<li>OpenCV for image processing</li>
<li>PyTorch for deep learning</li>
<li>DINOv2 for feature extraction</li>
<li>Streamlit for web interface</li>
</ul>
</section>
<section id="what-i-learned" class="level2" data-number="0.12">
<h2 data-number="0.12" class="anchored" data-anchor-id="what-i-learned"><span class="header-section-number">0.12</span> What I Learned</h2>
<p>This project demonstrates my understanding of: - Classical computer vision techniques - Deep learning for image classification - Foundation models and feature extraction - Full-stack application development</p>
<pre><code>
## What's Coming Next?

In our final post, [**"Where to Go Next: Your Computer Vision Journey"**](../09-where-to-go-next/), we'll explore:

- **Advanced topics** to study next
- **Career paths** in computer vision
- **Open source projects** to contribute to
- **Resources** for continued learning
- **Building your portfolio** and landing your first CV job

You've just built a complete computer vision application‚Äîcongratulations! üéâ

## Key Takeaways

- **Integration is key**: Combining classical and modern techniques
- **User experience matters**: Good interfaces make CV accessible
- **Testing is crucial**: Ensure your application works reliably
- **Performance optimization**: Make your app fast and responsive
- **Portfolio value**: This project showcases your CV skills
- **Real-world application**: You've built something genuinely useful!

:::{.callout-tip}
## Complete Project
Ready to build your own Smart Photo Analyzer? Get the complete code and deploy your own version: [**Smart Photo Analyzer - Complete Project**](https://colab.research.google.com/drive/1Smart_Photo_Analyzer_Complete_123456)

Make it your own and add it to your portfolio!
:::

:::{.callout-note}
## Series Navigation
- **Previous**: [Modern Vision Models: CNNs, Vision Transformers, and DINOv2](../07-modern-vision-models/)
- **Next**: [Where to Go Next: Your Computer Vision Journey](../09-where-to-go-next/)
- **Series Home**: [Computer Vision Foundations](../computer-vision-foundations.qmd)
:::

---

*You've just built a complete computer vision application that showcases everything you've learned! From pixels to deep learning to deployment‚Äîyou're now ready to tackle real-world computer vision challenges. In our final post, we'll chart your path forward in this exciting field.* 





:::{#quarto-navigation-envelope .hidden}
[Hasan's Data Science &amp; AI Blog]{.hidden render-id="quarto-int-sidebar-title"}
[Hasan's Data Science &amp; AI Blog]{.hidden render-id="quarto-int-navbar-title"}
[Data Science]{.hidden render-id="quarto-int-sidebar:quarto-sidebar-section-1"}
[Data Science Steps Series]{.hidden render-id="quarto-int-sidebar:/posts/series/data-science-steps.html"}
[Data Science Steps to Follow - 01]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part01/index.html"}
[Data Science Steps to Follow - 02]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part02/index.html"}
[Data Science Steps to Follow - 03]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part03/index.html"}
[Data Science Steps to Follow - 04]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part04/index.html"}
[Data Science Steps to Follow - 05]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part05/index.html"}
[Data Science Steps to Follow - 06]{.hidden render-id="quarto-int-sidebar:/posts/data-science-steps-to-follow-part06/index.html"}
[Computer Vision]{.hidden render-id="quarto-int-sidebar:quarto-sidebar-section-2"}
[posts/series/computer-vision-with-pytorch.qmd]{.hidden render-id="quarto-int-sidebar:undefined"}
[Anomaly Detection]{.hidden render-id="quarto-int-sidebar:quarto-sidebar-section-3"}
[Introduction]{.hidden render-id="quarto-int-sidebar:/posts/series/anomaly-detection/index.html"}
[Finding the Oddballs]{.hidden render-id="quarto-int-sidebar:/posts/series/anomaly-detection/finding-the-oddballs.html"}
[VLM Series]{.hidden render-id="quarto-int-sidebar:quarto-sidebar-section-4"}
[Introduction]{.hidden render-id="quarto-int-sidebar:/posts/series/vlm.html"}
[Qwen3-14B]{.hidden render-id="quarto-int-sidebar:/posts/series/vlm-qwen3-14b/index.html"}
[Home]{.hidden render-id="quarto-int-navbar:Home"}
[/index.html]{.hidden render-id="quarto-int-navbar:/index.html"}
[Series]{.hidden render-id="quarto-int-navbar:Series"}
[Data Science Steps]{.hidden render-id="quarto-int-navbar:Data Science Steps"}
[/posts/series/data-science-steps.html]{.hidden render-id="quarto-int-navbar:/posts/series/data-science-steps.html"}
[Computer Vision]{.hidden render-id="quarto-int-navbar:Computer Vision"}
[/posts/series/computer-vision-with-pytorch.qmd]{.hidden render-id="quarto-int-navbar:/posts/series/computer-vision-with-pytorch.qmd"}
[VLM Series]{.hidden render-id="quarto-int-navbar:VLM Series"}
[/posts/series/vlm.html]{.hidden render-id="quarto-int-navbar:/posts/series/vlm.html"}
[Anomaly Detection]{.hidden render-id="quarto-int-navbar:Anomaly Detection"}
[/posts/series/anomaly-detection/index.html]{.hidden render-id="quarto-int-navbar:/posts/series/anomaly-detection/index.html"}
[Categories]{.hidden render-id="quarto-int-navbar:Categories"}
[/categories.html]{.hidden render-id="quarto-int-navbar:/categories.html"}
[Tags]{.hidden render-id="quarto-int-navbar:Tags"}
[/tags.html]{.hidden render-id="quarto-int-navbar:/tags.html"}
[About]{.hidden render-id="quarto-int-navbar:About"}
[/about.html]{.hidden render-id="quarto-int-navbar:/about.html"}
[https://github.com/HasanGoni]{.hidden render-id="quarto-int-navbar:https://github.com/HasanGoni"}
[https://twitter.com/hasangoni]{.hidden render-id="quarto-int-navbar:https://twitter.com/hasangoni"}
:::



:::{#quarto-meta-markdown .hidden}
[Hasan's Data Science &amp; AI Blog - Your First CV Project: Putting It All Together]{.hidden render-id="quarto-metatitle"}
[Hasan's Data Science &amp; AI Blog - Your First CV Project: Putting It All Together]{.hidden render-id="quarto-twittercardtitle"}
[Hasan's Data Science &amp; AI Blog - Your First CV Project: Putting It All Together]{.hidden render-id="quarto-ogcardtitle"}
[Hasan's Data Science &amp; AI Blog]{.hidden render-id="quarto-metasitename"}
[]{.hidden render-id="quarto-twittercarddesc"}
[]{.hidden render-id="quarto-ogcardddesc"}
:::




&lt;!-- --&gt;

::: {.quarto-embedded-source-code}
```````````````````{.markdown shortcodes="false"}
---
title: "Your First CV Project: Putting It All Together"
author: "Hasan"
date: 2025-01-22
categories: [computer-vision, project, application, deployment]
tags: [project, streamlit, gradio, deployment, portfolio]
image: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2069&amp;q=80"
toc: true
series:
  name: "Computer Vision Foundations"
  number: 8
format:
  html: default
jupyter: python3
---

## The Moment of Truth: Building Something Real

You've learned about pixels, mastered OpenCV, detected patterns, matched features, and explored cutting-edge deep learning models. Now comes the exciting part: **building a complete computer vision application that showcases everything you've learned!**

Today, we're going to create the **"Smart Photo Analyzer"**‚Äîan interactive web app that can:
- üîç **Analyze any image** you upload
- üè∑Ô∏è **Classify objects** using deep learning
- üé® **Apply artistic filters** using classical CV
- üîó **Find similar images** using DINOv2 features
- üìä **Extract detailed statistics** about the image

By the end of this post, you'll have a portfolio-worthy project that demonstrates your computer vision skills!

## Project Overview: Smart Photo Analyzer

### What We're Building

Our Smart Photo Analyzer will have these features:

1. **Image Upload &amp; Display**
2. **Basic Image Analysis** (size, colors, etc.)
3. **Object Classification** (using pre-trained models)
4. **Artistic Filters** (using OpenCV)
5. **Feature Extraction** (using DINOv2)
6. **Similar Image Search**
7. **Interactive Web Interface**

### The Tech Stack

- **Backend**: Python with OpenCV, PyTorch, Transformers
- **Frontend**: Streamlit (for quick deployment) or Gradio
- **Models**: ResNet for classification, DINOv2 for features
- **Deployment**: Local first, then optional cloud deployment

## Setting Up the Project Structure

Let's start by organizing our project:

quarto-executable-code-5450563D

```python
#| eval: false
# Project structure
"""
smart_photo_analyzer/
‚îú‚îÄ‚îÄ app.py                 # Main Streamlit app
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ image_analyzer.py  # Core analysis functions
‚îÇ   ‚îú‚îÄ‚îÄ filters.py         # OpenCV filters
‚îÇ   ‚îú‚îÄ‚îÄ classifier.py      # Deep learning classification
‚îÇ   ‚îî‚îÄ‚îÄ feature_extractor.py  # DINOv2 features
‚îú‚îÄ‚îÄ models/                # Saved models (if any)
‚îú‚îÄ‚îÄ sample_images/         # Test images
‚îú‚îÄ‚îÄ requirements.txt       # Dependencies
‚îî‚îÄ‚îÄ README.md             # Project documentation
"""

# Let's create the core modules
import os
import numpy as np
import cv2
import torch
import torch.nn as nn
import torchvision.models as models
import torchvision.transforms as transforms
from transformers import AutoImageProcessor, AutoModel
from PIL import Image
import matplotlib.pyplot as plt
import streamlit as st</code></pre>
<p><strong>üéØ Try it yourself!</strong> <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-08-first-cv-project.ipynb">Open in Colab</a></p>
</section>
<section id="building-the-core-components-1" class="level2" data-number="0.13">
<h2 data-number="0.13" class="anchored" data-anchor-id="building-the-core-components-1"><span class="header-section-number">0.13</span> Building the Core Components</h2>
<section id="image-analyzer-class-1" class="level3" data-number="0.13.1">
<h3 data-number="0.13.1" class="anchored" data-anchor-id="image-analyzer-class-1"><span class="header-section-number">0.13.1</span> 1. Image Analyzer Class</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">class</span> SmartImageAnalyzer:</span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb17-4"><a href="#cb17-4"></a>        <span class="va">self</span>.setup_models()</span>
<span id="cb17-5"><a href="#cb17-5"></a>        <span class="va">self</span>.setup_transforms()</span>
<span id="cb17-6"><a href="#cb17-6"></a>    </span>
<span id="cb17-7"><a href="#cb17-7"></a>    <span class="kw">def</span> setup_models(<span class="va">self</span>):</span>
<span id="cb17-8"><a href="#cb17-8"></a>        <span class="co">"""Initialize all models"""</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>        <span class="bu">print</span>(<span class="st">"Loading models..."</span>)</span>
<span id="cb17-10"><a href="#cb17-10"></a>        </span>
<span id="cb17-11"><a href="#cb17-11"></a>        <span class="co"># Classification model</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>        <span class="va">self</span>.classifier <span class="op">=</span> models.resnet50(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-13"><a href="#cb17-13"></a>        <span class="va">self</span>.classifier.<span class="bu">eval</span>()</span>
<span id="cb17-14"><a href="#cb17-14"></a>        </span>
<span id="cb17-15"><a href="#cb17-15"></a>        <span class="co"># DINOv2 for feature extraction</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>        <span class="va">self</span>.dinov2_processor <span class="op">=</span> AutoImageProcessor.from_pretrained(<span class="st">"facebook/dinov2-base"</span>)</span>
<span id="cb17-17"><a href="#cb17-17"></a>        <span class="va">self</span>.dinov2_model <span class="op">=</span> AutoModel.from_pretrained(<span class="st">"facebook/dinov2-base"</span>)</span>
<span id="cb17-18"><a href="#cb17-18"></a>        <span class="va">self</span>.dinov2_model.<span class="bu">eval</span>()</span>
<span id="cb17-19"><a href="#cb17-19"></a>        </span>
<span id="cb17-20"><a href="#cb17-20"></a>        <span class="co"># ImageNet class labels</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>        <span class="va">self</span>.load_imagenet_labels()</span>
<span id="cb17-22"><a href="#cb17-22"></a>        </span>
<span id="cb17-23"><a href="#cb17-23"></a>        <span class="bu">print</span>(<span class="st">"Models loaded successfully!"</span>)</span>
<span id="cb17-24"><a href="#cb17-24"></a>    </span>
<span id="cb17-25"><a href="#cb17-25"></a>    <span class="kw">def</span> setup_transforms(<span class="va">self</span>):</span>
<span id="cb17-26"><a href="#cb17-26"></a>        <span class="co">"""Setup image transforms"""</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>        <span class="va">self</span>.classification_transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb17-28"><a href="#cb17-28"></a>            transforms.Resize(<span class="dv">256</span>),</span>
<span id="cb17-29"><a href="#cb17-29"></a>            transforms.CenterCrop(<span class="dv">224</span>),</span>
<span id="cb17-30"><a href="#cb17-30"></a>            transforms.ToTensor(),</span>
<span id="cb17-31"><a href="#cb17-31"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb17-32"><a href="#cb17-32"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb17-33"><a href="#cb17-33"></a>        ])</span>
<span id="cb17-34"><a href="#cb17-34"></a>    </span>
<span id="cb17-35"><a href="#cb17-35"></a>    <span class="kw">def</span> load_imagenet_labels(<span class="va">self</span>):</span>
<span id="cb17-36"><a href="#cb17-36"></a>        <span class="co">"""Load ImageNet class labels"""</span></span>
<span id="cb17-37"><a href="#cb17-37"></a>        <span class="co"># Simplified version - you would load the full ImageNet labels</span></span>
<span id="cb17-38"><a href="#cb17-38"></a>        <span class="va">self</span>.imagenet_labels <span class="op">=</span> [</span>
<span id="cb17-39"><a href="#cb17-39"></a>            <span class="st">"tench"</span>, <span class="st">"goldfish"</span>, <span class="st">"great white shark"</span>, <span class="st">"tiger shark"</span>,</span>
<span id="cb17-40"><a href="#cb17-40"></a>            <span class="st">"hammerhead"</span>, <span class="st">"electric ray"</span>, <span class="st">"stingray"</span>, <span class="st">"cock"</span>, <span class="st">"hen"</span>, <span class="st">"ostrich"</span></span>
<span id="cb17-41"><a href="#cb17-41"></a>            <span class="co"># ... (1000 total classes)</span></span>
<span id="cb17-42"><a href="#cb17-42"></a>        ]</span>
<span id="cb17-43"><a href="#cb17-43"></a>    </span>
<span id="cb17-44"><a href="#cb17-44"></a>    <span class="kw">def</span> analyze_basic_properties(<span class="va">self</span>, image):</span>
<span id="cb17-45"><a href="#cb17-45"></a>        <span class="co">"""Analyze basic image properties"""</span></span>
<span id="cb17-46"><a href="#cb17-46"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, PIL.Image.Image):</span>
<span id="cb17-47"><a href="#cb17-47"></a>            image_array <span class="op">=</span> np.array(image)</span>
<span id="cb17-48"><a href="#cb17-48"></a>        <span class="cf">else</span>:</span>
<span id="cb17-49"><a href="#cb17-49"></a>            image_array <span class="op">=</span> image</span>
<span id="cb17-50"><a href="#cb17-50"></a>        </span>
<span id="cb17-51"><a href="#cb17-51"></a>        height, width <span class="op">=</span> image_array.shape[:<span class="dv">2</span>]</span>
<span id="cb17-52"><a href="#cb17-52"></a>        channels <span class="op">=</span> image_array.shape[<span class="dv">2</span>] <span class="cf">if</span> <span class="bu">len</span>(image_array.shape) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb17-53"><a href="#cb17-53"></a>        </span>
<span id="cb17-54"><a href="#cb17-54"></a>        <span class="co"># Color analysis</span></span>
<span id="cb17-55"><a href="#cb17-55"></a>        <span class="cf">if</span> channels <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-56"><a href="#cb17-56"></a>            <span class="co"># Convert to different color spaces</span></span>
<span id="cb17-57"><a href="#cb17-57"></a>            hsv <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2HSV)</span>
<span id="cb17-58"><a href="#cb17-58"></a>            lab <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2LAB)</span>
<span id="cb17-59"><a href="#cb17-59"></a>            </span>
<span id="cb17-60"><a href="#cb17-60"></a>            <span class="co"># Dominant colors (simplified)</span></span>
<span id="cb17-61"><a href="#cb17-61"></a>            dominant_colors <span class="op">=</span> <span class="va">self</span>.extract_dominant_colors(image_array)</span>
<span id="cb17-62"><a href="#cb17-62"></a>            </span>
<span id="cb17-63"><a href="#cb17-63"></a>            <span class="co"># Brightness and contrast</span></span>
<span id="cb17-64"><a href="#cb17-64"></a>            gray <span class="op">=</span> cv2.cvtColor(image_array, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-65"><a href="#cb17-65"></a>            brightness <span class="op">=</span> np.mean(gray)</span>
<span id="cb17-66"><a href="#cb17-66"></a>            contrast <span class="op">=</span> np.std(gray)</span>
<span id="cb17-67"><a href="#cb17-67"></a>        <span class="cf">else</span>:</span>
<span id="cb17-68"><a href="#cb17-68"></a>            brightness <span class="op">=</span> np.mean(image_array)</span>
<span id="cb17-69"><a href="#cb17-69"></a>            contrast <span class="op">=</span> np.std(image_array)</span>
<span id="cb17-70"><a href="#cb17-70"></a>            dominant_colors <span class="op">=</span> <span class="va">None</span></span>
<span id="cb17-71"><a href="#cb17-71"></a>        </span>
<span id="cb17-72"><a href="#cb17-72"></a>        <span class="cf">return</span> {</span>
<span id="cb17-73"><a href="#cb17-73"></a>            <span class="st">'dimensions'</span>: <span class="ss">f"</span><span class="sc">{</span>width<span class="sc">}</span><span class="ss"> x </span><span class="sc">{</span>height<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb17-74"><a href="#cb17-74"></a>            <span class="st">'channels'</span>: channels,</span>
<span id="cb17-75"><a href="#cb17-75"></a>            <span class="st">'file_size'</span>: <span class="ss">f"</span><span class="sc">{</span>width <span class="op">*</span> height <span class="op">*</span> channels <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">1024</span><span class="sc">:.1f}</span><span class="ss"> KB"</span>,</span>
<span id="cb17-76"><a href="#cb17-76"></a>            <span class="st">'brightness'</span>: <span class="ss">f"</span><span class="sc">{</span>brightness<span class="sc">:.1f}</span><span class="ss">"</span>,</span>
<span id="cb17-77"><a href="#cb17-77"></a>            <span class="st">'contrast'</span>: <span class="ss">f"</span><span class="sc">{</span>contrast<span class="sc">:.1f}</span><span class="ss">"</span>,</span>
<span id="cb17-78"><a href="#cb17-78"></a>            <span class="st">'dominant_colors'</span>: dominant_colors</span>
<span id="cb17-79"><a href="#cb17-79"></a>        }</span>
<span id="cb17-80"><a href="#cb17-80"></a>    </span>
<span id="cb17-81"><a href="#cb17-81"></a>    <span class="kw">def</span> extract_dominant_colors(<span class="va">self</span>, image, k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb17-82"><a href="#cb17-82"></a>        <span class="co">"""Extract dominant colors using K-means"""</span></span>
<span id="cb17-83"><a href="#cb17-83"></a>        <span class="co"># Reshape image to be a list of pixels</span></span>
<span id="cb17-84"><a href="#cb17-84"></a>        pixels <span class="op">=</span> image.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb17-85"><a href="#cb17-85"></a>        pixels <span class="op">=</span> np.float32(pixels)</span>
<span id="cb17-86"><a href="#cb17-86"></a>        </span>
<span id="cb17-87"><a href="#cb17-87"></a>        <span class="co"># K-means clustering</span></span>
<span id="cb17-88"><a href="#cb17-88"></a>        criteria <span class="op">=</span> (cv2.TERM_CRITERIA_EPS <span class="op">+</span> cv2.TERM_CRITERIA_MAX_ITER, <span class="dv">100</span>, <span class="fl">0.2</span>)</span>
<span id="cb17-89"><a href="#cb17-89"></a>        _, labels, centers <span class="op">=</span> cv2.kmeans(pixels, k, <span class="va">None</span>, criteria, <span class="dv">10</span>, cv2.KMEANS_RANDOM_CENTERS)</span>
<span id="cb17-90"><a href="#cb17-90"></a>        </span>
<span id="cb17-91"><a href="#cb17-91"></a>        <span class="co"># Convert back to uint8</span></span>
<span id="cb17-92"><a href="#cb17-92"></a>        centers <span class="op">=</span> np.uint8(centers)</span>
<span id="cb17-93"><a href="#cb17-93"></a>        </span>
<span id="cb17-94"><a href="#cb17-94"></a>        <span class="cf">return</span> centers.tolist()</span>
<span id="cb17-95"><a href="#cb17-95"></a>    </span>
<span id="cb17-96"><a href="#cb17-96"></a>    <span class="kw">def</span> classify_image(<span class="va">self</span>, image):</span>
<span id="cb17-97"><a href="#cb17-97"></a>        <span class="co">"""Classify image using ResNet"""</span></span>
<span id="cb17-98"><a href="#cb17-98"></a>        <span class="co"># Preprocess image</span></span>
<span id="cb17-99"><a href="#cb17-99"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb17-100"><a href="#cb17-100"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb17-101"><a href="#cb17-101"></a>        </span>
<span id="cb17-102"><a href="#cb17-102"></a>        input_tensor <span class="op">=</span> <span class="va">self</span>.classification_transform(image).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb17-103"><a href="#cb17-103"></a>        </span>
<span id="cb17-104"><a href="#cb17-104"></a>        <span class="co"># Make prediction</span></span>
<span id="cb17-105"><a href="#cb17-105"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb17-106"><a href="#cb17-106"></a>            outputs <span class="op">=</span> <span class="va">self</span>.classifier(input_tensor)</span>
<span id="cb17-107"><a href="#cb17-107"></a>            probabilities <span class="op">=</span> torch.softmax(outputs, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-108"><a href="#cb17-108"></a>            top5_prob, top5_indices <span class="op">=</span> torch.topk(probabilities, <span class="dv">5</span>)</span>
<span id="cb17-109"><a href="#cb17-109"></a>        </span>
<span id="cb17-110"><a href="#cb17-110"></a>        <span class="co"># Format results</span></span>
<span id="cb17-111"><a href="#cb17-111"></a>        results <span class="op">=</span> []</span>
<span id="cb17-112"><a href="#cb17-112"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb17-113"><a href="#cb17-113"></a>            class_idx <span class="op">=</span> top5_indices[<span class="dv">0</span>][i].item()</span>
<span id="cb17-114"><a href="#cb17-114"></a>            prob <span class="op">=</span> top5_prob[<span class="dv">0</span>][i].item()</span>
<span id="cb17-115"><a href="#cb17-115"></a>            class_name <span class="op">=</span> <span class="va">self</span>.imagenet_labels[class_idx] <span class="cf">if</span> class_idx <span class="op">&lt;</span> <span class="bu">len</span>(<span class="va">self</span>.imagenet_labels) <span class="cf">else</span> <span class="ss">f"Class_</span><span class="sc">{</span>class_idx<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb17-116"><a href="#cb17-116"></a>            results.append({</span>
<span id="cb17-117"><a href="#cb17-117"></a>                <span class="st">'class'</span>: class_name,</span>
<span id="cb17-118"><a href="#cb17-118"></a>                <span class="st">'confidence'</span>: prob</span>
<span id="cb17-119"><a href="#cb17-119"></a>            })</span>
<span id="cb17-120"><a href="#cb17-120"></a>        </span>
<span id="cb17-121"><a href="#cb17-121"></a>        <span class="cf">return</span> results</span>
<span id="cb17-122"><a href="#cb17-122"></a>    </span>
<span id="cb17-123"><a href="#cb17-123"></a>    <span class="kw">def</span> extract_features(<span class="va">self</span>, image):</span>
<span id="cb17-124"><a href="#cb17-124"></a>        <span class="co">"""Extract DINOv2 features"""</span></span>
<span id="cb17-125"><a href="#cb17-125"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb17-126"><a href="#cb17-126"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb17-127"><a href="#cb17-127"></a>        </span>
<span id="cb17-128"><a href="#cb17-128"></a>        <span class="co"># Process image</span></span>
<span id="cb17-129"><a href="#cb17-129"></a>        inputs <span class="op">=</span> <span class="va">self</span>.dinov2_processor(images<span class="op">=</span>image, return_tensors<span class="op">=</span><span class="st">"pt"</span>)</span>
<span id="cb17-130"><a href="#cb17-130"></a>        </span>
<span id="cb17-131"><a href="#cb17-131"></a>        <span class="co"># Extract features</span></span>
<span id="cb17-132"><a href="#cb17-132"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb17-133"><a href="#cb17-133"></a>            outputs <span class="op">=</span> <span class="va">self</span>.dinov2_model(<span class="op">**</span>inputs)</span>
<span id="cb17-134"><a href="#cb17-134"></a>            cls_features <span class="op">=</span> outputs.last_hidden_state[:, <span class="dv">0</span>]  <span class="co"># Global features</span></span>
<span id="cb17-135"><a href="#cb17-135"></a>            patch_features <span class="op">=</span> outputs.last_hidden_state[:, <span class="dv">1</span>:]  <span class="co"># Local features</span></span>
<span id="cb17-136"><a href="#cb17-136"></a>        </span>
<span id="cb17-137"><a href="#cb17-137"></a>        <span class="cf">return</span> {</span>
<span id="cb17-138"><a href="#cb17-138"></a>            <span class="st">'global_features'</span>: cls_features.numpy(),</span>
<span id="cb17-139"><a href="#cb17-139"></a>            <span class="st">'patch_features'</span>: patch_features.numpy(),</span>
<span id="cb17-140"><a href="#cb17-140"></a>            <span class="st">'feature_dimension'</span>: cls_features.shape[<span class="dv">1</span>]</span>
<span id="cb17-141"><a href="#cb17-141"></a>        }</span>
<span id="cb17-142"><a href="#cb17-142"></a></span>
<span id="cb17-143"><a href="#cb17-143"></a><span class="co"># Initialize the analyzer</span></span>
<span id="cb17-144"><a href="#cb17-144"></a>analyzer <span class="op">=</span> SmartImageAnalyzer()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="image-filters-module-1" class="level3" data-number="0.13.2">
<h3 data-number="0.13.2" class="anchored" data-anchor-id="image-filters-module-1"><span class="header-section-number">0.13.2</span> 2. Image Filters Module</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#| eval: false</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">class</span> ImageFilters:</span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="kw">def</span> apply_blur(image, kernel_size<span class="op">=</span><span class="dv">15</span>):</span>
<span id="cb18-5"><a href="#cb18-5"></a>        <span class="co">"""Apply Gaussian blur"""</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>        <span class="cf">return</span> cv2.GaussianBlur(image, (kernel_size, kernel_size), <span class="dv">0</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>    </span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>    <span class="kw">def</span> apply_sharpen(image):</span>
<span id="cb18-10"><a href="#cb18-10"></a>        <span class="co">"""Apply sharpening filter"""</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>        kernel <span class="op">=</span> np.array([[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>,<span class="dv">9</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb18-12"><a href="#cb18-12"></a>        <span class="cf">return</span> cv2.filter2D(image, <span class="op">-</span><span class="dv">1</span>, kernel)</span>
<span id="cb18-13"><a href="#cb18-13"></a>    </span>
<span id="cb18-14"><a href="#cb18-14"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="kw">def</span> apply_edge_detection(image):</span>
<span id="cb18-16"><a href="#cb18-16"></a>        <span class="co">"""Apply Canny edge detection"""</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb18-18"><a href="#cb18-18"></a>        edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb18-19"><a href="#cb18-19"></a>        <span class="cf">return</span> cv2.cvtColor(edges, cv2.COLOR_GRAY2RGB)</span>
<span id="cb18-20"><a href="#cb18-20"></a>    </span>
<span id="cb18-21"><a href="#cb18-21"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-22"><a href="#cb18-22"></a>    <span class="kw">def</span> apply_vintage(image):</span>
<span id="cb18-23"><a href="#cb18-23"></a>        <span class="co">"""Apply vintage filter"""</span></span>
<span id="cb18-24"><a href="#cb18-24"></a>        <span class="co"># Convert to float for calculations</span></span>
<span id="cb18-25"><a href="#cb18-25"></a>        img_float <span class="op">=</span> image.astype(np.float32) <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb18-26"><a href="#cb18-26"></a>        </span>
<span id="cb18-27"><a href="#cb18-27"></a>        <span class="co"># Apply sepia effect</span></span>
<span id="cb18-28"><a href="#cb18-28"></a>        sepia_filter <span class="op">=</span> np.array([</span>
<span id="cb18-29"><a href="#cb18-29"></a>            [<span class="fl">0.393</span>, <span class="fl">0.769</span>, <span class="fl">0.189</span>],</span>
<span id="cb18-30"><a href="#cb18-30"></a>            [<span class="fl">0.349</span>, <span class="fl">0.686</span>, <span class="fl">0.168</span>],</span>
<span id="cb18-31"><a href="#cb18-31"></a>            [<span class="fl">0.272</span>, <span class="fl">0.534</span>, <span class="fl">0.131</span>]</span>
<span id="cb18-32"><a href="#cb18-32"></a>        ])</span>
<span id="cb18-33"><a href="#cb18-33"></a>        </span>
<span id="cb18-34"><a href="#cb18-34"></a>        sepia_img <span class="op">=</span> img_float <span class="op">@</span> sepia_filter.T</span>
<span id="cb18-35"><a href="#cb18-35"></a>        sepia_img <span class="op">=</span> np.clip(sepia_img, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb18-36"><a href="#cb18-36"></a>        </span>
<span id="cb18-37"><a href="#cb18-37"></a>        <span class="co"># Add vignette effect</span></span>
<span id="cb18-38"><a href="#cb18-38"></a>        h, w <span class="op">=</span> image.shape[:<span class="dv">2</span>]</span>
<span id="cb18-39"><a href="#cb18-39"></a>        X, Y <span class="op">=</span> np.meshgrid(np.arange(w), np.arange(h))</span>
<span id="cb18-40"><a href="#cb18-40"></a>        center_x, center_y <span class="op">=</span> w <span class="op">//</span> <span class="dv">2</span>, h <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb18-41"><a href="#cb18-41"></a>        </span>
<span id="cb18-42"><a href="#cb18-42"></a>        <span class="co"># Calculate distance from center</span></span>
<span id="cb18-43"><a href="#cb18-43"></a>        distance <span class="op">=</span> np.sqrt((X <span class="op">-</span> center_x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Y <span class="op">-</span> center_y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb18-44"><a href="#cb18-44"></a>        max_distance <span class="op">=</span> np.sqrt(center_x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> center_y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb18-45"><a href="#cb18-45"></a>        </span>
<span id="cb18-46"><a href="#cb18-46"></a>        <span class="co"># Create vignette mask</span></span>
<span id="cb18-47"><a href="#cb18-47"></a>        vignette <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (distance <span class="op">/</span> max_distance) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb18-48"><a href="#cb18-48"></a>        vignette <span class="op">=</span> np.clip(vignette, <span class="fl">0.3</span>, <span class="dv">1</span>)</span>
<span id="cb18-49"><a href="#cb18-49"></a>        </span>
<span id="cb18-50"><a href="#cb18-50"></a>        <span class="co"># Apply vignette</span></span>
<span id="cb18-51"><a href="#cb18-51"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb18-52"><a href="#cb18-52"></a>            sepia_img[:, :, i] <span class="op">*=</span> vignette</span>
<span id="cb18-53"><a href="#cb18-53"></a>        </span>
<span id="cb18-54"><a href="#cb18-54"></a>        <span class="cf">return</span> (sepia_img <span class="op">*</span> <span class="dv">255</span>).astype(np.uint8)</span>
<span id="cb18-55"><a href="#cb18-55"></a>    </span>
<span id="cb18-56"><a href="#cb18-56"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-57"><a href="#cb18-57"></a>    <span class="kw">def</span> apply_cartoon(image):</span>
<span id="cb18-58"><a href="#cb18-58"></a>        <span class="co">"""Apply cartoon effect"""</span></span>
<span id="cb18-59"><a href="#cb18-59"></a>        <span class="co"># Bilateral filter for smooth color regions</span></span>
<span id="cb18-60"><a href="#cb18-60"></a>        bilateral <span class="op">=</span> cv2.bilateralFilter(image, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">200</span>)</span>
<span id="cb18-61"><a href="#cb18-61"></a>        </span>
<span id="cb18-62"><a href="#cb18-62"></a>        <span class="co"># Edge detection</span></span>
<span id="cb18-63"><a href="#cb18-63"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb18-64"><a href="#cb18-64"></a>        edges <span class="op">=</span> cv2.adaptiveThreshold(gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_MEAN_C, </span>
<span id="cb18-65"><a href="#cb18-65"></a>                                     cv2.THRESH_BINARY, <span class="dv">7</span>, <span class="dv">7</span>)</span>
<span id="cb18-66"><a href="#cb18-66"></a>        edges <span class="op">=</span> cv2.cvtColor(edges, cv2.COLOR_GRAY2RGB)</span>
<span id="cb18-67"><a href="#cb18-67"></a>        </span>
<span id="cb18-68"><a href="#cb18-68"></a>        <span class="co"># Combine bilateral filter and edges</span></span>
<span id="cb18-69"><a href="#cb18-69"></a>        cartoon <span class="op">=</span> cv2.bitwise_and(bilateral, edges)</span>
<span id="cb18-70"><a href="#cb18-70"></a>        </span>
<span id="cb18-71"><a href="#cb18-71"></a>        <span class="cf">return</span> cartoon</span>
<span id="cb18-72"><a href="#cb18-72"></a>    </span>
<span id="cb18-73"><a href="#cb18-73"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-74"><a href="#cb18-74"></a>    <span class="kw">def</span> apply_oil_painting(image, size<span class="op">=</span><span class="dv">7</span>, dynRatio<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb18-75"><a href="#cb18-75"></a>        <span class="co">"""Apply oil painting effect"""</span></span>
<span id="cb18-76"><a href="#cb18-76"></a>        <span class="cf">return</span> cv2.xphoto.oilPainting(image, size, dynRatio)</span>
<span id="cb18-77"><a href="#cb18-77"></a>    </span>
<span id="cb18-78"><a href="#cb18-78"></a>    <span class="at">@staticmethod</span></span>
<span id="cb18-79"><a href="#cb18-79"></a>    <span class="kw">def</span> get_available_filters():</span>
<span id="cb18-80"><a href="#cb18-80"></a>        <span class="co">"""Get list of available filters"""</span></span>
<span id="cb18-81"><a href="#cb18-81"></a>        <span class="cf">return</span> {</span>
<span id="cb18-82"><a href="#cb18-82"></a>            <span class="st">'blur'</span>: <span class="st">'Gaussian Blur'</span>,</span>
<span id="cb18-83"><a href="#cb18-83"></a>            <span class="st">'sharpen'</span>: <span class="st">'Sharpen'</span>,</span>
<span id="cb18-84"><a href="#cb18-84"></a>            <span class="st">'edges'</span>: <span class="st">'Edge Detection'</span>,</span>
<span id="cb18-85"><a href="#cb18-85"></a>            <span class="st">'vintage'</span>: <span class="st">'Vintage'</span>,</span>
<span id="cb18-86"><a href="#cb18-86"></a>            <span class="st">'cartoon'</span>: <span class="st">'Cartoon'</span>,</span>
<span id="cb18-87"><a href="#cb18-87"></a>            <span class="st">'oil'</span>: <span class="st">'Oil Painting'</span></span>
<span id="cb18-88"><a href="#cb18-88"></a>        }</span>
<span id="cb18-89"><a href="#cb18-89"></a></span>
<span id="cb18-90"><a href="#cb18-90"></a>filters <span class="op">=</span> ImageFilters()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="similarity-search-engine-1" class="level3" data-number="0.13.3">
<h3 data-number="0.13.3" class="anchored" data-anchor-id="similarity-search-engine-1"><span class="header-section-number">0.13.3</span> 3. Similarity Search Engine</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#| eval: false</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">class</span> SimilaritySearchEngine:</span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, analyzer):</span>
<span id="cb19-4"><a href="#cb19-4"></a>        <span class="va">self</span>.analyzer <span class="op">=</span> analyzer</span>
<span id="cb19-5"><a href="#cb19-5"></a>        <span class="va">self</span>.image_database <span class="op">=</span> {}</span>
<span id="cb19-6"><a href="#cb19-6"></a>    </span>
<span id="cb19-7"><a href="#cb19-7"></a>    <span class="kw">def</span> add_image_to_database(<span class="va">self</span>, image_id, image):</span>
<span id="cb19-8"><a href="#cb19-8"></a>        <span class="co">"""Add image to search database"""</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>        features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(image)</span>
<span id="cb19-10"><a href="#cb19-10"></a>        <span class="va">self</span>.image_database[image_id] <span class="op">=</span> {</span>
<span id="cb19-11"><a href="#cb19-11"></a>            <span class="st">'features'</span>: features[<span class="st">'global_features'</span>],</span>
<span id="cb19-12"><a href="#cb19-12"></a>            <span class="st">'image'</span>: image</span>
<span id="cb19-13"><a href="#cb19-13"></a>        }</span>
<span id="cb19-14"><a href="#cb19-14"></a>    </span>
<span id="cb19-15"><a href="#cb19-15"></a>    <span class="kw">def</span> find_similar_images(<span class="va">self</span>, query_image, top_k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb19-16"><a href="#cb19-16"></a>        <span class="co">"""Find similar images in database"""</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>        query_features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(query_image)[<span class="st">'global_features'</span>]</span>
<span id="cb19-18"><a href="#cb19-18"></a>        </span>
<span id="cb19-19"><a href="#cb19-19"></a>        similarities <span class="op">=</span> []</span>
<span id="cb19-20"><a href="#cb19-20"></a>        </span>
<span id="cb19-21"><a href="#cb19-21"></a>        <span class="cf">for</span> image_id, data <span class="kw">in</span> <span class="va">self</span>.image_database.items():</span>
<span id="cb19-22"><a href="#cb19-22"></a>            <span class="co"># Compute cosine similarity</span></span>
<span id="cb19-23"><a href="#cb19-23"></a>            similarity <span class="op">=</span> <span class="va">self</span>.cosine_similarity(query_features, data[<span class="st">'features'</span>])</span>
<span id="cb19-24"><a href="#cb19-24"></a>            similarities.append((image_id, similarity, data[<span class="st">'image'</span>]))</span>
<span id="cb19-25"><a href="#cb19-25"></a>        </span>
<span id="cb19-26"><a href="#cb19-26"></a>        <span class="co"># Sort by similarity</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>        similarities.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-28"><a href="#cb19-28"></a>        </span>
<span id="cb19-29"><a href="#cb19-29"></a>        <span class="cf">return</span> similarities[:top_k]</span>
<span id="cb19-30"><a href="#cb19-30"></a>    </span>
<span id="cb19-31"><a href="#cb19-31"></a>    <span class="at">@staticmethod</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>    <span class="kw">def</span> cosine_similarity(a, b):</span>
<span id="cb19-33"><a href="#cb19-33"></a>        <span class="co">"""Compute cosine similarity between two vectors"""</span></span>
<span id="cb19-34"><a href="#cb19-34"></a>        <span class="cf">return</span> np.dot(a.flatten(), b.flatten()) <span class="op">/</span> (</span>
<span id="cb19-35"><a href="#cb19-35"></a>            np.linalg.norm(a.flatten()) <span class="op">*</span> np.linalg.norm(b.flatten())</span>
<span id="cb19-36"><a href="#cb19-36"></a>        )</span>
<span id="cb19-37"><a href="#cb19-37"></a></span>
<span id="cb19-38"><a href="#cb19-38"></a>similarity_engine <span class="op">=</span> SimilaritySearchEngine(analyzer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="building-the-web-interface-with-streamlit-1" class="level2" data-number="0.14">
<h2 data-number="0.14" class="anchored" data-anchor-id="building-the-web-interface-with-streamlit-1"><span class="header-section-number">0.14</span> Building the Web Interface with Streamlit</h2>
<p>Now let‚Äôs create an interactive web interface:</p>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># app.py - Main Streamlit application</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">def</span> main():</span>
<span id="cb20-8"><a href="#cb20-8"></a>    st.set_page_config(</span>
<span id="cb20-9"><a href="#cb20-9"></a>        page_title<span class="op">=</span><span class="st">"Smart Photo Analyzer"</span>,</span>
<span id="cb20-10"><a href="#cb20-10"></a>        page_icon<span class="op">=</span><span class="st">"üì∏"</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>        layout<span class="op">=</span><span class="st">"wide"</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>    )</span>
<span id="cb20-13"><a href="#cb20-13"></a>    </span>
<span id="cb20-14"><a href="#cb20-14"></a>    st.title(<span class="st">"üì∏ Smart Photo Analyzer"</span>)</span>
<span id="cb20-15"><a href="#cb20-15"></a>    st.markdown(<span class="st">"Upload an image and discover its secrets using computer vision!"</span>)</span>
<span id="cb20-16"><a href="#cb20-16"></a>    </span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="co"># Sidebar for navigation</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>    st.sidebar.title(<span class="st">"Navigation"</span>)</span>
<span id="cb20-19"><a href="#cb20-19"></a>    page <span class="op">=</span> st.sidebar.selectbox(</span>
<span id="cb20-20"><a href="#cb20-20"></a>        <span class="st">"Choose a feature:"</span>,</span>
<span id="cb20-21"><a href="#cb20-21"></a>        [<span class="st">"Image Analysis"</span>, <span class="st">"Apply Filters"</span>, <span class="st">"Similar Images"</span>, <span class="st">"About"</span>]</span>
<span id="cb20-22"><a href="#cb20-22"></a>    )</span>
<span id="cb20-23"><a href="#cb20-23"></a>    </span>
<span id="cb20-24"><a href="#cb20-24"></a>    <span class="cf">if</span> page <span class="op">==</span> <span class="st">"Image Analysis"</span>:</span>
<span id="cb20-25"><a href="#cb20-25"></a>        image_analysis_page()</span>
<span id="cb20-26"><a href="#cb20-26"></a>    <span class="cf">elif</span> page <span class="op">==</span> <span class="st">"Apply Filters"</span>:</span>
<span id="cb20-27"><a href="#cb20-27"></a>        filters_page()</span>
<span id="cb20-28"><a href="#cb20-28"></a>    <span class="cf">elif</span> page <span class="op">==</span> <span class="st">"Similar Images"</span>:</span>
<span id="cb20-29"><a href="#cb20-29"></a>        similarity_page()</span>
<span id="cb20-30"><a href="#cb20-30"></a>    <span class="cf">else</span>:</span>
<span id="cb20-31"><a href="#cb20-31"></a>        about_page()</span>
<span id="cb20-32"><a href="#cb20-32"></a></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="kw">def</span> image_analysis_page():</span>
<span id="cb20-34"><a href="#cb20-34"></a>    st.header(<span class="st">"üîç Image Analysis"</span>)</span>
<span id="cb20-35"><a href="#cb20-35"></a>    </span>
<span id="cb20-36"><a href="#cb20-36"></a>    <span class="co"># File uploader</span></span>
<span id="cb20-37"><a href="#cb20-37"></a>    uploaded_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb20-38"><a href="#cb20-38"></a>        <span class="st">"Choose an image file"</span>,</span>
<span id="cb20-39"><a href="#cb20-39"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb20-40"><a href="#cb20-40"></a>        <span class="bu">help</span><span class="op">=</span><span class="st">"Upload an image to analyze"</span></span>
<span id="cb20-41"><a href="#cb20-41"></a>    )</span>
<span id="cb20-42"><a href="#cb20-42"></a>    </span>
<span id="cb20-43"><a href="#cb20-43"></a>    <span class="cf">if</span> uploaded_file <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb20-44"><a href="#cb20-44"></a>        <span class="co"># Load and display image</span></span>
<span id="cb20-45"><a href="#cb20-45"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(uploaded_file)</span>
<span id="cb20-46"><a href="#cb20-46"></a>        image_array <span class="op">=</span> np.array(image)</span>
<span id="cb20-47"><a href="#cb20-47"></a>        </span>
<span id="cb20-48"><a href="#cb20-48"></a>        col1, col2 <span class="op">=</span> st.columns(<span class="dv">2</span>)</span>
<span id="cb20-49"><a href="#cb20-49"></a>        </span>
<span id="cb20-50"><a href="#cb20-50"></a>        <span class="cf">with</span> col1:</span>
<span id="cb20-51"><a href="#cb20-51"></a>            st.subheader(<span class="st">"Original Image"</span>)</span>
<span id="cb20-52"><a href="#cb20-52"></a>            st.image(image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-53"><a href="#cb20-53"></a>        </span>
<span id="cb20-54"><a href="#cb20-54"></a>        <span class="cf">with</span> col2:</span>
<span id="cb20-55"><a href="#cb20-55"></a>            st.subheader(<span class="st">"Analysis Results"</span>)</span>
<span id="cb20-56"><a href="#cb20-56"></a>            </span>
<span id="cb20-57"><a href="#cb20-57"></a>            <span class="co"># Basic properties</span></span>
<span id="cb20-58"><a href="#cb20-58"></a>            <span class="cf">with</span> st.expander(<span class="st">"üìä Basic Properties"</span>, expanded<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb20-59"><a href="#cb20-59"></a>                properties <span class="op">=</span> analyzer.analyze_basic_properties(image_array)</span>
<span id="cb20-60"><a href="#cb20-60"></a>                </span>
<span id="cb20-61"><a href="#cb20-61"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> properties.items():</span>
<span id="cb20-62"><a href="#cb20-62"></a>                    <span class="cf">if</span> key <span class="op">!=</span> <span class="st">'dominant_colors'</span>:</span>
<span id="cb20-63"><a href="#cb20-63"></a>                        st.metric(key.replace(<span class="st">'_'</span>, <span class="st">' '</span>).title(), value)</span>
<span id="cb20-64"><a href="#cb20-64"></a>                </span>
<span id="cb20-65"><a href="#cb20-65"></a>                <span class="co"># Display dominant colors</span></span>
<span id="cb20-66"><a href="#cb20-66"></a>                <span class="cf">if</span> properties[<span class="st">'dominant_colors'</span>]:</span>
<span id="cb20-67"><a href="#cb20-67"></a>                    st.write(<span class="st">"**Dominant Colors:**"</span>)</span>
<span id="cb20-68"><a href="#cb20-68"></a>                    colors_html <span class="op">=</span> <span class="st">""</span></span>
<span id="cb20-69"><a href="#cb20-69"></a>                    <span class="cf">for</span> color <span class="kw">in</span> properties[<span class="st">'dominant_colors'</span>]:</span>
<span id="cb20-70"><a href="#cb20-70"></a>                        hex_color <span class="op">=</span> <span class="ss">f"#</span><span class="sc">{</span>color[<span class="dv">0</span>]<span class="sc">:02x}{</span>color[<span class="dv">1</span>]<span class="sc">:02x}{</span>color[<span class="dv">2</span>]<span class="sc">:02x}</span><span class="ss">"</span></span>
<span id="cb20-71"><a href="#cb20-71"></a>                        colors_html <span class="op">+=</span> <span class="ss">f'&lt;div style="display:inline-block; width:30px; height:30px; background-color:</span><span class="sc">{</span>hex_color<span class="sc">}</span><span class="ss">; margin:2px; border:1px solid #ccc;"&gt;&lt;/div&gt;'</span></span>
<span id="cb20-72"><a href="#cb20-72"></a>                    st.markdown(colors_html, unsafe_allow_html<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-73"><a href="#cb20-73"></a>            </span>
<span id="cb20-74"><a href="#cb20-74"></a>            <span class="co"># Classification results</span></span>
<span id="cb20-75"><a href="#cb20-75"></a>            <span class="cf">with</span> st.expander(<span class="st">"üè∑Ô∏è Object Classification"</span>, expanded<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb20-76"><a href="#cb20-76"></a>                <span class="cf">with</span> st.spinner(<span class="st">"Classifying image..."</span>):</span>
<span id="cb20-77"><a href="#cb20-77"></a>                    classification_results <span class="op">=</span> analyzer.classify_image(image)</span>
<span id="cb20-78"><a href="#cb20-78"></a>                </span>
<span id="cb20-79"><a href="#cb20-79"></a>                <span class="cf">for</span> i, result <span class="kw">in</span> <span class="bu">enumerate</span>(classification_results):</span>
<span id="cb20-80"><a href="#cb20-80"></a>                    confidence_percent <span class="op">=</span> result[<span class="st">'confidence'</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb20-81"><a href="#cb20-81"></a>                    st.write(<span class="ss">f"**</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>result[<span class="st">'class'</span>]<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">** - </span><span class="sc">{</span>confidence_percent<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb20-82"><a href="#cb20-82"></a>                    st.progress(result[<span class="st">'confidence'</span>])</span>
<span id="cb20-83"><a href="#cb20-83"></a>            </span>
<span id="cb20-84"><a href="#cb20-84"></a>            <span class="co"># Feature visualization</span></span>
<span id="cb20-85"><a href="#cb20-85"></a>            <span class="cf">with</span> st.expander(<span class="st">"üß† Deep Learning Features"</span>):</span>
<span id="cb20-86"><a href="#cb20-86"></a>                <span class="cf">with</span> st.spinner(<span class="st">"Extracting features..."</span>):</span>
<span id="cb20-87"><a href="#cb20-87"></a>                    features <span class="op">=</span> analyzer.extract_features(image)</span>
<span id="cb20-88"><a href="#cb20-88"></a>                </span>
<span id="cb20-89"><a href="#cb20-89"></a>                st.write(<span class="ss">f"**Feature Dimension:** </span><span class="sc">{</span>features[<span class="st">'feature_dimension'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-90"><a href="#cb20-90"></a>                </span>
<span id="cb20-91"><a href="#cb20-91"></a>                <span class="co"># Plot feature distribution</span></span>
<span id="cb20-92"><a href="#cb20-92"></a>                global_features <span class="op">=</span> features[<span class="st">'global_features'</span>].flatten()</span>
<span id="cb20-93"><a href="#cb20-93"></a>                fig <span class="op">=</span> px.histogram(</span>
<span id="cb20-94"><a href="#cb20-94"></a>                    x<span class="op">=</span>global_features,</span>
<span id="cb20-95"><a href="#cb20-95"></a>                    title<span class="op">=</span><span class="st">"Global Feature Distribution"</span>,</span>
<span id="cb20-96"><a href="#cb20-96"></a>                    labels<span class="op">=</span>{<span class="st">'x'</span>: <span class="st">'Feature Value'</span>, <span class="st">'y'</span>: <span class="st">'Frequency'</span>}</span>
<span id="cb20-97"><a href="#cb20-97"></a>                )</span>
<span id="cb20-98"><a href="#cb20-98"></a>                st.plotly_chart(fig, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-99"><a href="#cb20-99"></a></span>
<span id="cb20-100"><a href="#cb20-100"></a><span class="kw">def</span> filters_page():</span>
<span id="cb20-101"><a href="#cb20-101"></a>    st.header(<span class="st">"üé® Apply Artistic Filters"</span>)</span>
<span id="cb20-102"><a href="#cb20-102"></a>    </span>
<span id="cb20-103"><a href="#cb20-103"></a>    uploaded_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb20-104"><a href="#cb20-104"></a>        <span class="st">"Choose an image file"</span>,</span>
<span id="cb20-105"><a href="#cb20-105"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb20-106"><a href="#cb20-106"></a>        key<span class="op">=</span><span class="st">"filters_uploader"</span></span>
<span id="cb20-107"><a href="#cb20-107"></a>    )</span>
<span id="cb20-108"><a href="#cb20-108"></a>    </span>
<span id="cb20-109"><a href="#cb20-109"></a>    <span class="cf">if</span> uploaded_file <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb20-110"><a href="#cb20-110"></a>        image <span class="op">=</span> Image.<span class="bu">open</span>(uploaded_file)</span>
<span id="cb20-111"><a href="#cb20-111"></a>        image_array <span class="op">=</span> np.array(image)</span>
<span id="cb20-112"><a href="#cb20-112"></a>        </span>
<span id="cb20-113"><a href="#cb20-113"></a>        <span class="co"># Filter selection</span></span>
<span id="cb20-114"><a href="#cb20-114"></a>        available_filters <span class="op">=</span> filters.get_available_filters()</span>
<span id="cb20-115"><a href="#cb20-115"></a>        selected_filter <span class="op">=</span> st.selectbox(</span>
<span id="cb20-116"><a href="#cb20-116"></a>            <span class="st">"Choose a filter:"</span>,</span>
<span id="cb20-117"><a href="#cb20-117"></a>            options<span class="op">=</span><span class="bu">list</span>(available_filters.keys()),</span>
<span id="cb20-118"><a href="#cb20-118"></a>            format_func<span class="op">=</span><span class="kw">lambda</span> x: available_filters[x]</span>
<span id="cb20-119"><a href="#cb20-119"></a>        )</span>
<span id="cb20-120"><a href="#cb20-120"></a>        </span>
<span id="cb20-121"><a href="#cb20-121"></a>        col1, col2 <span class="op">=</span> st.columns(<span class="dv">2</span>)</span>
<span id="cb20-122"><a href="#cb20-122"></a>        </span>
<span id="cb20-123"><a href="#cb20-123"></a>        <span class="cf">with</span> col1:</span>
<span id="cb20-124"><a href="#cb20-124"></a>            st.subheader(<span class="st">"Original"</span>)</span>
<span id="cb20-125"><a href="#cb20-125"></a>            st.image(image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-126"><a href="#cb20-126"></a>        </span>
<span id="cb20-127"><a href="#cb20-127"></a>        <span class="cf">with</span> col2:</span>
<span id="cb20-128"><a href="#cb20-128"></a>            st.subheader(<span class="ss">f"With </span><span class="sc">{</span>available_filters[selected_filter]<span class="sc">}</span><span class="ss"> Filter"</span>)</span>
<span id="cb20-129"><a href="#cb20-129"></a>            </span>
<span id="cb20-130"><a href="#cb20-130"></a>            <span class="cf">with</span> st.spinner(<span class="st">"Applying filter..."</span>):</span>
<span id="cb20-131"><a href="#cb20-131"></a>                <span class="cf">if</span> selected_filter <span class="op">==</span> <span class="st">'blur'</span>:</span>
<span id="cb20-132"><a href="#cb20-132"></a>                    kernel_size <span class="op">=</span> st.slider(<span class="st">"Blur intensity"</span>, <span class="dv">1</span>, <span class="dv">31</span>, <span class="dv">15</span>, step<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb20-133"><a href="#cb20-133"></a>                    filtered_image <span class="op">=</span> filters.apply_blur(image_array, kernel_size)</span>
<span id="cb20-134"><a href="#cb20-134"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'sharpen'</span>:</span>
<span id="cb20-135"><a href="#cb20-135"></a>                    filtered_image <span class="op">=</span> filters.apply_sharpen(image_array)</span>
<span id="cb20-136"><a href="#cb20-136"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'edges'</span>:</span>
<span id="cb20-137"><a href="#cb20-137"></a>                    filtered_image <span class="op">=</span> filters.apply_edge_detection(image_array)</span>
<span id="cb20-138"><a href="#cb20-138"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'vintage'</span>:</span>
<span id="cb20-139"><a href="#cb20-139"></a>                    filtered_image <span class="op">=</span> filters.apply_vintage(image_array)</span>
<span id="cb20-140"><a href="#cb20-140"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'cartoon'</span>:</span>
<span id="cb20-141"><a href="#cb20-141"></a>                    filtered_image <span class="op">=</span> filters.apply_cartoon(image_array)</span>
<span id="cb20-142"><a href="#cb20-142"></a>                <span class="cf">elif</span> selected_filter <span class="op">==</span> <span class="st">'oil'</span>:</span>
<span id="cb20-143"><a href="#cb20-143"></a>                    size <span class="op">=</span> st.slider(<span class="st">"Brush size"</span>, <span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">7</span>)</span>
<span id="cb20-144"><a href="#cb20-144"></a>                    filtered_image <span class="op">=</span> filters.apply_oil_painting(image_array, size)</span>
<span id="cb20-145"><a href="#cb20-145"></a>            </span>
<span id="cb20-146"><a href="#cb20-146"></a>            st.image(filtered_image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-147"><a href="#cb20-147"></a>            </span>
<span id="cb20-148"><a href="#cb20-148"></a>            <span class="co"># Download button</span></span>
<span id="cb20-149"><a href="#cb20-149"></a>            filtered_pil <span class="op">=</span> Image.fromarray(filtered_image)</span>
<span id="cb20-150"><a href="#cb20-150"></a>            buf <span class="op">=</span> io.BytesIO()</span>
<span id="cb20-151"><a href="#cb20-151"></a>            filtered_pil.save(buf, <span class="bu">format</span><span class="op">=</span><span class="st">'PNG'</span>)</span>
<span id="cb20-152"><a href="#cb20-152"></a>            buf.seek(<span class="dv">0</span>)</span>
<span id="cb20-153"><a href="#cb20-153"></a>            </span>
<span id="cb20-154"><a href="#cb20-154"></a>            st.download_button(</span>
<span id="cb20-155"><a href="#cb20-155"></a>                label<span class="op">=</span><span class="st">"Download Filtered Image"</span>,</span>
<span id="cb20-156"><a href="#cb20-156"></a>                data<span class="op">=</span>buf,</span>
<span id="cb20-157"><a href="#cb20-157"></a>                file_name<span class="op">=</span><span class="ss">f"filtered_</span><span class="sc">{</span>selected_filter<span class="sc">}</span><span class="ss">.png"</span>,</span>
<span id="cb20-158"><a href="#cb20-158"></a>                mime<span class="op">=</span><span class="st">"image/png"</span></span>
<span id="cb20-159"><a href="#cb20-159"></a>            )</span>
<span id="cb20-160"><a href="#cb20-160"></a></span>
<span id="cb20-161"><a href="#cb20-161"></a><span class="kw">def</span> similarity_page():</span>
<span id="cb20-162"><a href="#cb20-162"></a>    st.header(<span class="st">"üîó Find Similar Images"</span>)</span>
<span id="cb20-163"><a href="#cb20-163"></a>    </span>
<span id="cb20-164"><a href="#cb20-164"></a>    <span class="co"># Initialize session state for image database</span></span>
<span id="cb20-165"><a href="#cb20-165"></a>    <span class="cf">if</span> <span class="st">'database_images'</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb20-166"><a href="#cb20-166"></a>        st.session_state.database_images <span class="op">=</span> []</span>
<span id="cb20-167"><a href="#cb20-167"></a>    </span>
<span id="cb20-168"><a href="#cb20-168"></a>    <span class="co"># Upload images to database</span></span>
<span id="cb20-169"><a href="#cb20-169"></a>    st.subheader(<span class="st">"Step 1: Build Image Database"</span>)</span>
<span id="cb20-170"><a href="#cb20-170"></a>    uploaded_files <span class="op">=</span> st.file_uploader(</span>
<span id="cb20-171"><a href="#cb20-171"></a>        <span class="st">"Upload multiple images to build a database"</span>,</span>
<span id="cb20-172"><a href="#cb20-172"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb20-173"><a href="#cb20-173"></a>        accept_multiple_files<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb20-174"><a href="#cb20-174"></a>        key<span class="op">=</span><span class="st">"database_uploader"</span></span>
<span id="cb20-175"><a href="#cb20-175"></a>    )</span>
<span id="cb20-176"><a href="#cb20-176"></a>    </span>
<span id="cb20-177"><a href="#cb20-177"></a>    <span class="cf">if</span> uploaded_files:</span>
<span id="cb20-178"><a href="#cb20-178"></a>        <span class="cf">for</span> i, <span class="bu">file</span> <span class="kw">in</span> <span class="bu">enumerate</span>(uploaded_files):</span>
<span id="cb20-179"><a href="#cb20-179"></a>            image <span class="op">=</span> Image.<span class="bu">open</span>(<span class="bu">file</span>)</span>
<span id="cb20-180"><a href="#cb20-180"></a>            similarity_engine.add_image_to_database(<span class="ss">f"image_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, image)</span>
<span id="cb20-181"><a href="#cb20-181"></a>            st.session_state.database_images.append((<span class="ss">f"image_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, image))</span>
<span id="cb20-182"><a href="#cb20-182"></a>        </span>
<span id="cb20-183"><a href="#cb20-183"></a>        st.success(<span class="ss">f"Added </span><span class="sc">{</span><span class="bu">len</span>(uploaded_files)<span class="sc">}</span><span class="ss"> images to database!"</span>)</span>
<span id="cb20-184"><a href="#cb20-184"></a>    </span>
<span id="cb20-185"><a href="#cb20-185"></a>    <span class="co"># Query image</span></span>
<span id="cb20-186"><a href="#cb20-186"></a>    st.subheader(<span class="st">"Step 2: Search for Similar Images"</span>)</span>
<span id="cb20-187"><a href="#cb20-187"></a>    query_file <span class="op">=</span> st.file_uploader(</span>
<span id="cb20-188"><a href="#cb20-188"></a>        <span class="st">"Upload a query image"</span>,</span>
<span id="cb20-189"><a href="#cb20-189"></a>        <span class="bu">type</span><span class="op">=</span>[<span class="st">'png'</span>, <span class="st">'jpg'</span>, <span class="st">'jpeg'</span>],</span>
<span id="cb20-190"><a href="#cb20-190"></a>        key<span class="op">=</span><span class="st">"query_uploader"</span></span>
<span id="cb20-191"><a href="#cb20-191"></a>    )</span>
<span id="cb20-192"><a href="#cb20-192"></a>    </span>
<span id="cb20-193"><a href="#cb20-193"></a>    <span class="cf">if</span> query_file <span class="kw">and</span> st.session_state.database_images:</span>
<span id="cb20-194"><a href="#cb20-194"></a>        query_image <span class="op">=</span> Image.<span class="bu">open</span>(query_file)</span>
<span id="cb20-195"><a href="#cb20-195"></a>        </span>
<span id="cb20-196"><a href="#cb20-196"></a>        col1, col2 <span class="op">=</span> st.columns([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb20-197"><a href="#cb20-197"></a>        </span>
<span id="cb20-198"><a href="#cb20-198"></a>        <span class="cf">with</span> col1:</span>
<span id="cb20-199"><a href="#cb20-199"></a>            st.subheader(<span class="st">"Query Image"</span>)</span>
<span id="cb20-200"><a href="#cb20-200"></a>            st.image(query_image, use_column_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-201"><a href="#cb20-201"></a>        </span>
<span id="cb20-202"><a href="#cb20-202"></a>        <span class="cf">with</span> col2:</span>
<span id="cb20-203"><a href="#cb20-203"></a>            st.subheader(<span class="st">"Similar Images"</span>)</span>
<span id="cb20-204"><a href="#cb20-204"></a>            </span>
<span id="cb20-205"><a href="#cb20-205"></a>            <span class="cf">with</span> st.spinner(<span class="st">"Searching for similar images..."</span>):</span>
<span id="cb20-206"><a href="#cb20-206"></a>                similar_images <span class="op">=</span> similarity_engine.find_similar_images(query_image, top_k<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb20-207"><a href="#cb20-207"></a>            </span>
<span id="cb20-208"><a href="#cb20-208"></a>            <span class="cf">for</span> i, (image_id, similarity, similar_image) <span class="kw">in</span> <span class="bu">enumerate</span>(similar_images):</span>
<span id="cb20-209"><a href="#cb20-209"></a>                st.write(<span class="ss">f"**Rank </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">** - Similarity: </span><span class="sc">{</span>similarity<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb20-210"><a href="#cb20-210"></a>                st.image(similar_image, width<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb20-211"><a href="#cb20-211"></a></span>
<span id="cb20-212"><a href="#cb20-212"></a><span class="kw">def</span> about_page():</span>
<span id="cb20-213"><a href="#cb20-213"></a>    st.header(<span class="st">"About Smart Photo Analyzer"</span>)</span>
<span id="cb20-214"><a href="#cb20-214"></a>    </span>
<span id="cb20-215"><a href="#cb20-215"></a>    st.markdown(<span class="st">"""</span></span>
<span id="cb20-216"><a href="#cb20-216"></a><span class="st">    ## üéØ What This App Does</span></span>
<span id="cb20-217"><a href="#cb20-217"></a><span class="st">    </span></span>
<span id="cb20-218"><a href="#cb20-218"></a><span class="st">    The Smart Photo Analyzer demonstrates the power of computer vision by combining:</span></span>
<span id="cb20-219"><a href="#cb20-219"></a><span class="st">    </span></span>
<span id="cb20-220"><a href="#cb20-220"></a><span class="st">    - **Classical Computer Vision** (OpenCV filters and image processing)</span></span>
<span id="cb20-221"><a href="#cb20-221"></a><span class="st">    - **Deep Learning** (ResNet for classification)</span></span>
<span id="cb20-222"><a href="#cb20-222"></a><span class="st">    - **Foundation Models** (DINOv2 for feature extraction)</span></span>
<span id="cb20-223"><a href="#cb20-223"></a><span class="st">    </span></span>
<span id="cb20-224"><a href="#cb20-224"></a><span class="st">    ## üõ†Ô∏è Technologies Used</span></span>
<span id="cb20-225"><a href="#cb20-225"></a><span class="st">    </span></span>
<span id="cb20-226"><a href="#cb20-226"></a><span class="st">    - **OpenCV**: Image processing and filters</span></span>
<span id="cb20-227"><a href="#cb20-227"></a><span class="st">    - **PyTorch**: Deep learning framework</span></span>
<span id="cb20-228"><a href="#cb20-228"></a><span class="st">    - **Transformers**: HuggingFace models</span></span>
<span id="cb20-229"><a href="#cb20-229"></a><span class="st">    - **Streamlit**: Web interface</span></span>
<span id="cb20-230"><a href="#cb20-230"></a><span class="st">    - **DINOv2**: Self-supervised feature extraction</span></span>
<span id="cb20-231"><a href="#cb20-231"></a><span class="st">    </span></span>
<span id="cb20-232"><a href="#cb20-232"></a><span class="st">    ## üìö What You've Learned</span></span>
<span id="cb20-233"><a href="#cb20-233"></a><span class="st">    </span></span>
<span id="cb20-234"><a href="#cb20-234"></a><span class="st">    By building this app, you've mastered:</span></span>
<span id="cb20-235"><a href="#cb20-235"></a><span class="st">    </span></span>
<span id="cb20-236"><a href="#cb20-236"></a><span class="st">    1. **Image basics** - Understanding pixels and arrays</span></span>
<span id="cb20-237"><a href="#cb20-237"></a><span class="st">    2. **OpenCV operations** - Resize, crop, filter, detect edges</span></span>
<span id="cb20-238"><a href="#cb20-238"></a><span class="st">    3. **Pattern recognition** - Finding shapes and contours</span></span>
<span id="cb20-239"><a href="#cb20-239"></a><span class="st">    4. **Feature matching** - Keypoints and descriptors</span></span>
<span id="cb20-240"><a href="#cb20-240"></a><span class="st">    5. **Deep learning** - CNNs and classification</span></span>
<span id="cb20-241"><a href="#cb20-241"></a><span class="st">    6. **Modern models** - Vision Transformers and foundation models</span></span>
<span id="cb20-242"><a href="#cb20-242"></a><span class="st">    7. **Application development** - Building real-world projects</span></span>
<span id="cb20-243"><a href="#cb20-243"></a><span class="st">    </span></span>
<span id="cb20-244"><a href="#cb20-244"></a><span class="st">    ## üöÄ Next Steps</span></span>
<span id="cb20-245"><a href="#cb20-245"></a><span class="st">    </span></span>
<span id="cb20-246"><a href="#cb20-246"></a><span class="st">    - Deploy this app to the cloud (Heroku, Streamlit Cloud)</span></span>
<span id="cb20-247"><a href="#cb20-247"></a><span class="st">    - Add more advanced features (object detection, segmentation)</span></span>
<span id="cb20-248"><a href="#cb20-248"></a><span class="st">    - Experiment with other foundation models</span></span>
<span id="cb20-249"><a href="#cb20-249"></a><span class="st">    - Build your own computer vision startup! üéâ</span></span>
<span id="cb20-250"><a href="#cb20-250"></a><span class="st">    """</span>)</span>
<span id="cb20-251"><a href="#cb20-251"></a></span>
<span id="cb20-252"><a href="#cb20-252"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb20-253"><a href="#cb20-253"></a>    main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="deployment-options-1" class="level2" data-number="0.15">
<h2 data-number="0.15" class="anchored" data-anchor-id="deployment-options-1"><span class="header-section-number">0.15</span> Deployment Options</h2>
<section id="option-1-local-deployment-1" class="level3" data-number="0.15.1">
<h3 data-number="0.15.1" class="anchored" data-anchor-id="option-1-local-deployment-1"><span class="header-section-number">0.15.1</span> Option 1: Local Deployment</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Create requirements.txt</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="ex">pip</span> freeze <span class="op">&gt;</span> requirements.txt</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># Run the app</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="ex">streamlit</span> run app.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="option-2-streamlit-cloud-1" class="level3" data-number="0.15.2">
<h3 data-number="0.15.2" class="anchored" data-anchor-id="option-2-streamlit-cloud-1"><span class="header-section-number">0.15.2</span> Option 2: Streamlit Cloud</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Create a GitHub repository with your code</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># Connect to Streamlit Cloud</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># Deploy with one click!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="option-3-docker-deployment-1" class="level3" data-number="0.15.3">
<h3 data-number="0.15.3" class="anchored" data-anchor-id="option-3-docker-deployment-1"><span class="header-section-number">0.15.3</span> Option 3: Docker Deployment</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource dockerfile number-lines code-with-copy"><code class="sourceCode dockerfile"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Dockerfile</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">FROM</span> python:3.9-slim</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">WORKDIR</span> /app</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="kw">COPY</span> requirements.txt .</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="kw">RUN</span> <span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="kw">COPY</span> . .</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="kw">EXPOSE</span> 8501</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="kw">CMD</span> [<span class="st">"streamlit"</span>, <span class="st">"run"</span>, <span class="st">"app.py"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-features-to-add-1" class="level2" data-number="0.16">
<h2 data-number="0.16" class="anchored" data-anchor-id="advanced-features-to-add-1"><span class="header-section-number">0.16</span> Advanced Features to Add</h2>
<section id="batch-processing-1" class="level3" data-number="0.16.1">
<h3 data-number="0.16.1" class="anchored" data-anchor-id="batch-processing-1"><span class="header-section-number">0.16.1</span> 1. Batch Processing</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">#| eval: false</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">def</span> process_image_batch(images):</span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="co">"""Process multiple images at once"""</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>    results <span class="op">=</span> []</span>
<span id="cb24-5"><a href="#cb24-5"></a>    </span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="cf">for</span> image <span class="kw">in</span> images:</span>
<span id="cb24-7"><a href="#cb24-7"></a>        result <span class="op">=</span> {</span>
<span id="cb24-8"><a href="#cb24-8"></a>            <span class="st">'properties'</span>: analyzer.analyze_basic_properties(image),</span>
<span id="cb24-9"><a href="#cb24-9"></a>            <span class="st">'classification'</span>: analyzer.classify_image(image),</span>
<span id="cb24-10"><a href="#cb24-10"></a>            <span class="st">'features'</span>: analyzer.extract_features(image)</span>
<span id="cb24-11"><a href="#cb24-11"></a>        }</span>
<span id="cb24-12"><a href="#cb24-12"></a>        results.append(result)</span>
<span id="cb24-13"><a href="#cb24-13"></a>    </span>
<span id="cb24-14"><a href="#cb24-14"></a>    <span class="cf">return</span> results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="custom-model-training-1" class="level3" data-number="0.16.2">
<h3 data-number="0.16.2" class="anchored" data-anchor-id="custom-model-training-1"><span class="header-section-number">0.16.2</span> 2. Custom Model Training</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">#| eval: false</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">class</span> CustomClassifier:</span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb25-4"><a href="#cb25-4"></a>        <span class="va">self</span>.model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>        <span class="co"># Modify final layer for your specific classes</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>        <span class="va">self</span>.model.fc <span class="op">=</span> nn.Linear(<span class="va">self</span>.model.fc.in_features, num_custom_classes)</span>
<span id="cb25-7"><a href="#cb25-7"></a>    </span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="kw">def</span> train(<span class="va">self</span>, train_loader, val_loader, epochs<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb25-9"><a href="#cb25-9"></a>        <span class="co">"""Train the model on custom data"""</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>        <span class="co"># Training loop implementation</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>        <span class="cf">pass</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>    </span>
<span id="cb25-13"><a href="#cb25-13"></a>    <span class="kw">def</span> save_model(<span class="va">self</span>, path):</span>
<span id="cb25-14"><a href="#cb25-14"></a>        <span class="co">"""Save trained model"""</span></span>
<span id="cb25-15"><a href="#cb25-15"></a>        torch.save(<span class="va">self</span>.model.state_dict(), path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="real-time-video-processing-1" class="level3" data-number="0.16.3">
<h3 data-number="0.16.3" class="anchored" data-anchor-id="real-time-video-processing-1"><span class="header-section-number">0.16.3</span> 3. Real-time Video Processing</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#| eval: false</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw">def</span> process_video_stream():</span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="co">"""Process video stream in real-time"""</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>    cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)  <span class="co"># Webcam</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>    </span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb26-7"><a href="#cb26-7"></a>        ret, frame <span class="op">=</span> cap.read()</span>
<span id="cb26-8"><a href="#cb26-8"></a>        <span class="cf">if</span> ret:</span>
<span id="cb26-9"><a href="#cb26-9"></a>            <span class="co"># Apply analysis to each frame</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>            processed_frame <span class="op">=</span> analyzer.classify_image(frame)</span>
<span id="cb26-11"><a href="#cb26-11"></a>            cv2.imshow(<span class="st">'Smart Video Analyzer'</span>, processed_frame)</span>
<span id="cb26-12"><a href="#cb26-12"></a>        </span>
<span id="cb26-13"><a href="#cb26-13"></a>        <span class="cf">if</span> cv2.waitKey(<span class="dv">1</span>) <span class="op">&amp;</span> <span class="bn">0xFF</span> <span class="op">==</span> <span class="bu">ord</span>(<span class="st">'q'</span>):</span>
<span id="cb26-14"><a href="#cb26-14"></a>            <span class="cf">break</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>    </span>
<span id="cb26-16"><a href="#cb26-16"></a>    cap.release()</span>
<span id="cb26-17"><a href="#cb26-17"></a>    cv2.destroyAllWindows()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="testing-your-application-1" class="level2" data-number="0.17">
<h2 data-number="0.17" class="anchored" data-anchor-id="testing-your-application-1"><span class="header-section-number">0.17</span> Testing Your Application</h2>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#| eval: false</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="im">import</span> unittest</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="kw">class</span> TestSmartPhotoAnalyzer(unittest.TestCase):</span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="kw">def</span> setUp(<span class="va">self</span>):</span>
<span id="cb27-6"><a href="#cb27-6"></a>        <span class="va">self</span>.analyzer <span class="op">=</span> SmartImageAnalyzer()</span>
<span id="cb27-7"><a href="#cb27-7"></a>        <span class="va">self</span>.test_image <span class="op">=</span> Image.new(<span class="st">'RGB'</span>, (<span class="dv">224</span>, <span class="dv">224</span>), color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a>    </span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="kw">def</span> test_basic_analysis(<span class="va">self</span>):</span>
<span id="cb27-10"><a href="#cb27-10"></a>        <span class="co">"""Test basic image analysis"""</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>        properties <span class="op">=</span> <span class="va">self</span>.analyzer.analyze_basic_properties(<span class="va">self</span>.test_image)</span>
<span id="cb27-12"><a href="#cb27-12"></a>        <span class="va">self</span>.assertIn(<span class="st">'dimensions'</span>, properties)</span>
<span id="cb27-13"><a href="#cb27-13"></a>        <span class="va">self</span>.assertIn(<span class="st">'channels'</span>, properties)</span>
<span id="cb27-14"><a href="#cb27-14"></a>    </span>
<span id="cb27-15"><a href="#cb27-15"></a>    <span class="kw">def</span> test_classification(<span class="va">self</span>):</span>
<span id="cb27-16"><a href="#cb27-16"></a>        <span class="co">"""Test image classification"""</span></span>
<span id="cb27-17"><a href="#cb27-17"></a>        results <span class="op">=</span> <span class="va">self</span>.analyzer.classify_image(<span class="va">self</span>.test_image)</span>
<span id="cb27-18"><a href="#cb27-18"></a>        <span class="va">self</span>.assertEqual(<span class="bu">len</span>(results), <span class="dv">5</span>)  <span class="co"># Top 5 predictions</span></span>
<span id="cb27-19"><a href="#cb27-19"></a>        <span class="va">self</span>.assertTrue(<span class="bu">all</span>(<span class="st">'class'</span> <span class="kw">in</span> r <span class="kw">and</span> <span class="st">'confidence'</span> <span class="kw">in</span> r <span class="cf">for</span> r <span class="kw">in</span> results))</span>
<span id="cb27-20"><a href="#cb27-20"></a>    </span>
<span id="cb27-21"><a href="#cb27-21"></a>    <span class="kw">def</span> test_feature_extraction(<span class="va">self</span>):</span>
<span id="cb27-22"><a href="#cb27-22"></a>        <span class="co">"""Test feature extraction"""</span></span>
<span id="cb27-23"><a href="#cb27-23"></a>        features <span class="op">=</span> <span class="va">self</span>.analyzer.extract_features(<span class="va">self</span>.test_image)</span>
<span id="cb27-24"><a href="#cb27-24"></a>        <span class="va">self</span>.assertIn(<span class="st">'global_features'</span>, features)</span>
<span id="cb27-25"><a href="#cb27-25"></a>        <span class="va">self</span>.assertIn(<span class="st">'feature_dimension'</span>, features)</span>
<span id="cb27-26"><a href="#cb27-26"></a></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb27-28"><a href="#cb27-28"></a>    unittest.main()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="performance-optimization-1" class="level2" data-number="0.18">
<h2 data-number="0.18" class="anchored" data-anchor-id="performance-optimization-1"><span class="header-section-number">0.18</span> Performance Optimization</h2>
<section id="model-caching-1" class="level3" data-number="0.18.1">
<h3 data-number="0.18.1" class="anchored" data-anchor-id="model-caching-1"><span class="header-section-number">0.18.1</span> 1. Model Caching</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">#| eval: false</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="at">@st.cache_resource</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="kw">def</span> load_models():</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="co">"""Cache models to avoid reloading"""</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="cf">return</span> SmartImageAnalyzer()</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co"># Use cached models</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>analyzer <span class="op">=</span> load_models()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="image-preprocessing-optimization-1" class="level3" data-number="0.18.2">
<h3 data-number="0.18.2" class="anchored" data-anchor-id="image-preprocessing-optimization-1"><span class="header-section-number">0.18.2</span> 2. Image Preprocessing Optimization</h3>
<p>quarto-executable-code-5450563D</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">def</span> optimize_image_size(image, max_size<span class="op">=</span><span class="dv">1024</span>):</span>
<span id="cb29-3"><a href="#cb29-3"></a>    <span class="co">"""Resize large images for faster processing"""</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>    width, height <span class="op">=</span> image.size</span>
<span id="cb29-5"><a href="#cb29-5"></a>    </span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="cf">if</span> <span class="bu">max</span>(width, height) <span class="op">&gt;</span> max_size:</span>
<span id="cb29-7"><a href="#cb29-7"></a>        ratio <span class="op">=</span> max_size <span class="op">/</span> <span class="bu">max</span>(width, height)</span>
<span id="cb29-8"><a href="#cb29-8"></a>        new_width <span class="op">=</span> <span class="bu">int</span>(width <span class="op">*</span> ratio)</span>
<span id="cb29-9"><a href="#cb29-9"></a>        new_height <span class="op">=</span> <span class="bu">int</span>(height <span class="op">*</span> ratio)</span>
<span id="cb29-10"><a href="#cb29-10"></a>        image <span class="op">=</span> image.resize((new_width, new_height), Image.Resampling.LANCZOS)</span>
<span id="cb29-11"><a href="#cb29-11"></a>    </span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="cf">return</span> image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="your-portfolio-showcase-1" class="level2" data-number="0.19">
<h2 data-number="0.19" class="anchored" data-anchor-id="your-portfolio-showcase-1"><span class="header-section-number">0.19</span> Your Portfolio Showcase</h2>
<section id="creating-a-professional-readme-1" class="level3" data-number="0.19.1">
<h3 data-number="0.19.1" class="anchored" data-anchor-id="creating-a-professional-readme-1"><span class="header-section-number">0.19.1</span> Creating a Professional README</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu"># Smart Photo Analyzer</span></span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>A comprehensive computer vision application that analyzes images using classical and modern techniques.</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="fu">## Features</span></span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="ss">- </span>üîç **Image Analysis**: Extract detailed properties and statistics</span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="ss">- </span>üè∑Ô∏è **Object Classification**: Identify objects using deep learning</span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="ss">- </span>üé® **Artistic Filters**: Apply creative effects using OpenCV</span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="ss">- </span>üîó **Similarity Search**: Find similar images using DINOv2 features</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="fu">## Demo</span></span>
<span id="cb30-13"><a href="#cb30-13"></a></span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="al">![Demo GIF](demo.gif)</span></span>
<span id="cb30-15"><a href="#cb30-15"></a></span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="fu">## Installation</span></span>
<span id="cb30-17"><a href="#cb30-17"></a></span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="in">```bash</span></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="ex">streamlit</span> run app.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="technologies-1" class="level2" data-number="0.20">
<h2 data-number="0.20" class="anchored" data-anchor-id="technologies-1"><span class="header-section-number">0.20</span> Technologies</h2>
<ul>
<li>OpenCV for image processing</li>
<li>PyTorch for deep learning</li>
<li>DINOv2 for feature extraction</li>
<li>Streamlit for web interface</li>
</ul>
</section>
<section id="what-i-learned-1" class="level2" data-number="0.21">
<h2 data-number="0.21" class="anchored" data-anchor-id="what-i-learned-1"><span class="header-section-number">0.21</span> What I Learned</h2>
<p>This project demonstrates my understanding of: - Classical computer vision techniques - Deep learning for image classification - Foundation models and feature extraction - Full-stack application development</p>
<pre><code>
## What's Coming Next?

In our final post, [**"Where to Go Next: Your Computer Vision Journey"**](../09-where-to-go-next/), we'll explore:

- **Advanced topics** to study next
- **Career paths** in computer vision
- **Open source projects** to contribute to
- **Resources** for continued learning
- **Building your portfolio** and landing your first CV job

You've just built a complete computer vision application‚Äîcongratulations! üéâ

## Key Takeaways

- **Integration is key**: Combining classical and modern techniques
- **User experience matters**: Good interfaces make CV accessible
- **Testing is crucial**: Ensure your application works reliably
- **Performance optimization**: Make your app fast and responsive
- **Portfolio value**: This project showcases your CV skills
- **Real-world application**: You've built something genuinely useful!

:::{.callout-tip}
## Complete Project
Ready to build your own Smart Photo Analyzer? Get the complete code and deploy your own version: [**Smart Photo Analyzer - Complete Project**](https://colab.research.google.com/drive/1Smart_Photo_Analyzer_Complete_123456)

Make it your own and add it to your portfolio!
:::

:::{.callout-note}
## Series Navigation
- **Previous**: [Modern Vision Models: CNNs, Vision Transformers, and DINOv2](../07-modern-vision-models/)
- **Next**: [Where to Go Next: Your Computer Vision Journey](../09-where-to-go-next/)
- **Series Home**: [Computer Vision Foundations](../computer-vision-foundations.qmd)
:::

---

*You've just built a complete computer vision application that showcases everything you've learned! From pixels to deep learning to deployment‚Äîyou're now ready to tackle real-world computer vision challenges. In our final post, we'll chart your path forward in this exciting field.* </code></pre>
<p>:::</p>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div>CC BY-NC-SA 4.0</div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2025,
  author = {, Hasan},
  title = {Your {First} {CV} {Project:} {Putting} {It} {All} {Together}},
  date = {2025-01-22},
  url = {https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/08-first-cv-project.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Hasan. 2025. <span>‚ÄúYour First CV Project: Putting It All
Together.‚Äù</span> January 22, 2025. <a href="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/08-first-cv-project.html">https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/08-first-cv-project.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="yourusername/quarto_blog_hasan" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<script src="https://giscus.app/client.js" data-repo="HasanGoni/quarto_blog_hasan" data-repo-id="" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>