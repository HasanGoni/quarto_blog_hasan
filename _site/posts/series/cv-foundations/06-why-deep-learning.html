<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hasan">
<meta name="dcterms.date" content="2025-01-22">

<title>Hasan’s Data Science &amp; AI Blog - Why Deep Learning? When Classical Methods Hit the Wall</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hasan’s Data Science &amp; AI Blog - Why Deep Learning? When Classical Methods Hit the Wall">
<meta property="og:description" content="">
<meta property="og:image" content="https://images.unsplash.com/photo-1677442136019-21780ecad995?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2032&amp;q=80">
<meta property="og:site-name" content="Hasan's Data Science &amp; AI Blog">
<meta name="twitter:title" content="Hasan’s Data Science &amp; AI Blog - Why Deep Learning? When Classical Methods Hit the Wall">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1677442136019-21780ecad995?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2032&amp;q=80">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hasan’s Data Science &amp; AI Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-series" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-series">    
        <li>
    <a class="dropdown-item" href="../../../posts/series/data-science-steps.html" rel="" target="">
 <span class="dropdown-text">Data Science Steps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/computer-vision-with-pytorch.qmd" rel="" target="">
 <span class="dropdown-text">Computer Vision</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/vlm.html" rel="" target="">
 <span class="dropdown-text">VLM Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/anomaly-detection/index.html" rel="" target="">
 <span class="dropdown-text">Anomaly Detection</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../categories.html" rel="" target="">
 <span class="menu-text">Categories</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tags.html" rel="" target="">
 <span class="menu-text">Tags</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HasanGoni" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/hasangoni" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Why Deep Learning? When Classical Methods Hit the Wall</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Why Deep Learning? When Classical Methods Hit the Wall</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">computer-vision</div>
                <div class="quarto-category">deep-learning</div>
                <div class="quarto-category">neural-networks</div>
                <div class="quarto-category">pytorch</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hasan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 22, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">June 28, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/data-science-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 06</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Computer Vision</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">posts/series/computer-vision-with-pytorch.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Anomaly Detection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/finding-the-oddballs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding the Oddballs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">VLM Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm-qwen3-14b/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen3-14B</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-great-computer-vision-crisis-of-2010" id="toc-the-great-computer-vision-crisis-of-2010" class="nav-link active" data-scroll-target="#the-great-computer-vision-crisis-of-2010"><span class="header-section-number">0.1</span> The Great Computer Vision Crisis of 2010</a></li>
  <li><a href="#the-imagenet-moment-2012" id="toc-the-imagenet-moment-2012" class="nav-link" data-scroll-target="#the-imagenet-moment-2012"><span class="header-section-number">0.2</span> The ImageNet Moment: 2012</a></li>
  <li><a href="#what-makes-deep-learning-different" id="toc-what-makes-deep-learning-different" class="nav-link" data-scroll-target="#what-makes-deep-learning-different"><span class="header-section-number">0.3</span> What Makes Deep Learning Different?</a>
  <ul class="collapse">
  <li><a href="#classical-approach-hand-crafted-features" id="toc-classical-approach-hand-crafted-features" class="nav-link" data-scroll-target="#classical-approach-hand-crafted-features"><span class="header-section-number">0.3.1</span> Classical Approach: Hand-Crafted Features</a></li>
  <li><a href="#deep-learning-approach-learned-features" id="toc-deep-learning-approach-learned-features" class="nav-link" data-scroll-target="#deep-learning-approach-learned-features"><span class="header-section-number">0.3.2</span> Deep Learning Approach: Learned Features</a></li>
  </ul></li>
  <li><a href="#your-first-neural-network" id="toc-your-first-neural-network" class="nav-link" data-scroll-target="#your-first-neural-network"><span class="header-section-number">0.4</span> Your First Neural Network</a></li>
  <li><a href="#the-convolutional-revolution" id="toc-the-convolutional-revolution" class="nav-link" data-scroll-target="#the-convolutional-revolution"><span class="header-section-number">0.5</span> The Convolutional Revolution</a></li>
  <li><a href="#understanding-convolutions-the-sliding-window" id="toc-understanding-convolutions-the-sliding-window" class="nav-link" data-scroll-target="#understanding-convolutions-the-sliding-window"><span class="header-section-number">0.6</span> Understanding Convolutions: The Sliding Window</a></li>
  <li><a href="#transfer-learning-standing-on-giants-shoulders" id="toc-transfer-learning-standing-on-giants-shoulders" class="nav-link" data-scroll-target="#transfer-learning-standing-on-giants-shoulders"><span class="header-section-number">0.7</span> Transfer Learning: Standing on Giants’ Shoulders</a></li>
  <li><a href="#your-first-image-classifier" id="toc-your-first-image-classifier" class="nav-link" data-scroll-target="#your-first-image-classifier"><span class="header-section-number">0.8</span> Your First Image Classifier</a></li>
  <li><a href="#visualizing-what-neural-networks-learn" id="toc-visualizing-what-neural-networks-learn" class="nav-link" data-scroll-target="#visualizing-what-neural-networks-learn"><span class="header-section-number">0.9</span> Visualizing What Neural Networks Learn</a></li>
  <li><a href="#feature-maps-seeing-through-the-networks-eyes" id="toc-feature-maps-seeing-through-the-networks-eyes" class="nav-link" data-scroll-target="#feature-maps-seeing-through-the-networks-eyes"><span class="header-section-number">0.10</span> Feature Maps: Seeing Through the Network’s Eyes</a></li>
  <li><a href="#the-deep-learning-advantage-why-it-works" id="toc-the-deep-learning-advantage-why-it-works" class="nav-link" data-scroll-target="#the-deep-learning-advantage-why-it-works"><span class="header-section-number">0.11</span> The Deep Learning Advantage: Why It Works</a></li>
  <li><a href="#why-deep-learning-won" id="toc-why-deep-learning-won" class="nav-link" data-scroll-target="#why-deep-learning-won"><span class="header-section-number">0.12</span> Why Deep Learning Won</a>
  <ul class="collapse">
  <li><a href="#automatic-feature-learning" id="toc-automatic-feature-learning" class="nav-link" data-scroll-target="#automatic-feature-learning"><span class="header-section-number">0.12.1</span> 1. <strong>Automatic Feature Learning</strong></a></li>
  <li><a href="#hierarchical-representations" id="toc-hierarchical-representations" class="nav-link" data-scroll-target="#hierarchical-representations"><span class="header-section-number">0.12.2</span> 2. <strong>Hierarchical Representations</strong></a></li>
  <li><a href="#end-to-end-learning" id="toc-end-to-end-learning" class="nav-link" data-scroll-target="#end-to-end-learning"><span class="header-section-number">0.12.3</span> 3. <strong>End-to-End Learning</strong></a></li>
  <li><a href="#scalability" id="toc-scalability" class="nav-link" data-scroll-target="#scalability"><span class="header-section-number">0.12.4</span> 4. <strong>Scalability</strong></a></li>
  </ul></li>
  <li><a href="#the-modern-deep-learning-pipeline" id="toc-the-modern-deep-learning-pipeline" class="nav-link" data-scroll-target="#the-modern-deep-learning-pipeline"><span class="header-section-number">0.13</span> The Modern Deep Learning Pipeline</a></li>
  <li><a href="#whats-coming-next" id="toc-whats-coming-next" class="nav-link" data-scroll-target="#whats-coming-next"><span class="header-section-number">0.14</span> What’s Coming Next?</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">0.15</span> Key Takeaways</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="the-great-computer-vision-crisis-of-2010" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="the-great-computer-vision-crisis-of-2010"><span class="header-section-number">0.1</span> The Great Computer Vision Crisis of 2010</h2>
<p>Picture this: It’s 2010, and computer vision researchers are frustrated. They’ve spent decades perfecting edge detection, feature matching, and object recognition. Their algorithms can find corners, match keypoints, and even stitch panoramas.</p>
<p>But there’s one problem they can’t solve: <strong>telling cats from dogs.</strong></p>
<p>Seriously! While a 3-year-old child could easily distinguish between cats and dogs, the best computer vision systems struggled with this “simple” task. The classical approach required hand-crafting features for every possible variation—different breeds, lighting conditions, poses, backgrounds. It was like trying to write rules for every possible way a cat could look. Impossible!</p>
<p>Then something revolutionary happened…</p>
</section>
<section id="the-imagenet-moment-2012" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="the-imagenet-moment-2012"><span class="header-section-number">0.2</span> The ImageNet Moment: 2012</h2>
<p>In 2012, a team led by Alex Krizhevsky entered the ImageNet competition with something called <strong>AlexNet</strong>—a deep neural network. The results were shocking:</p>
<ul>
<li><strong>Previous best accuracy</strong>: 74.3%</li>
<li><strong>AlexNet accuracy</strong>: 84.7%</li>
<li><strong>Improvement</strong>: A massive 10+ percentage point jump!</li>
</ul>
<p>This wasn’t just an incremental improvement—it was a paradigm shift. Deep learning had arrived, and computer vision would never be the same.</p>
</section>
<section id="what-makes-deep-learning-different" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="what-makes-deep-learning-different"><span class="header-section-number">0.3</span> What Makes Deep Learning Different?</h2>
<p>Let’s understand why neural networks succeeded where classical methods struggled:</p>
<section id="classical-approach-hand-crafted-features" class="level3" data-number="0.3.1">
<h3 data-number="0.3.1" class="anchored" data-anchor-id="classical-approach-hand-crafted-features"><span class="header-section-number">0.3.1</span> Classical Approach: Hand-Crafted Features</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Classical computer vision pipeline</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">def</span> classical_cat_detector(image):</span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="co"># Step 1: Extract hand-crafted features</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    edges <span class="op">=</span> detect_edges(image)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    corners <span class="op">=</span> detect_corners(image)</span>
<span id="cb1-6"><a href="#cb1-6"></a>    textures <span class="op">=</span> analyze_textures(image)</span>
<span id="cb1-7"><a href="#cb1-7"></a>    </span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="co"># Step 2: Combine features with rules</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="cf">if</span> (pointy_ears <span class="kw">and</span> whiskers <span class="kw">and</span> fur_texture):</span>
<span id="cb1-10"><a href="#cb1-10"></a>        <span class="cf">return</span> <span class="st">"cat"</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="cf">else</span>:</span>
<span id="cb1-12"><a href="#cb1-12"></a>        <span class="cf">return</span> <span class="st">"not_cat"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Problems:</strong> - Features had to be manually designed - Rules were brittle and specific - Couldn’t adapt to new variations - Required domain expertise</p>
</section>
<section id="deep-learning-approach-learned-features" class="level3" data-number="0.3.2">
<h3 data-number="0.3.2" class="anchored" data-anchor-id="deep-learning-approach-learned-features"><span class="header-section-number">0.3.2</span> Deep Learning Approach: Learned Features</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Deep learning pipeline</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">def</span> deep_cat_detector(image):</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="co"># The network learns its own features!</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    features <span class="op">=</span> neural_network.extract_features(image)</span>
<span id="cb2-5"><a href="#cb2-5"></a>    prediction <span class="op">=</span> neural_network.classify(features)</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="cf">return</span> prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Advantages:</strong> - Features are learned automatically - Adapts to data variations - Improves with more data - Works across different domains</p>
</section>
</section>
<section id="your-first-neural-network" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="your-first-neural-network"><span class="header-section-number">0.4</span> Your First Neural Network</h2>
<p>Let’s build a simple neural network to understand the magic:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> torch</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="im">import</span> torchvision</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> transforms</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Simple neural network for image classification</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">class</span> SimpleNet(nn.Module):</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes<span class="op">=</span><span class="dv">2</span>):  <span class="co"># 2 classes: cat vs dog</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>        <span class="bu">super</span>(SimpleNet, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a>        </span>
<span id="cb3-14"><a href="#cb3-14"></a>        <span class="co"># Flatten 224x224x3 image to 150,528 features</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb3-16"><a href="#cb3-16"></a>        </span>
<span id="cb3-17"><a href="#cb3-17"></a>        <span class="co"># Simple fully connected layers</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">224</span> <span class="op">*</span> <span class="dv">224</span> <span class="op">*</span> <span class="dv">3</span>, <span class="dv">512</span>)</span>
<span id="cb3-19"><a href="#cb3-19"></a>        <span class="va">self</span>.relu1 <span class="op">=</span> nn.ReLU()</span>
<span id="cb3-20"><a href="#cb3-20"></a>        <span class="va">self</span>.dropout1 <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a>        </span>
<span id="cb3-22"><a href="#cb3-22"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">128</span>)</span>
<span id="cb3-23"><a href="#cb3-23"></a>        <span class="va">self</span>.relu2 <span class="op">=</span> nn.ReLU()</span>
<span id="cb3-24"><a href="#cb3-24"></a>        <span class="va">self</span>.dropout2 <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb3-25"><a href="#cb3-25"></a>        </span>
<span id="cb3-26"><a href="#cb3-26"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">128</span>, num_classes)</span>
<span id="cb3-27"><a href="#cb3-27"></a>    </span>
<span id="cb3-28"><a href="#cb3-28"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb3-29"><a href="#cb3-29"></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb3-30"><a href="#cb3-30"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout1(<span class="va">self</span>.relu1(<span class="va">self</span>.fc1(x)))</span>
<span id="cb3-31"><a href="#cb3-31"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout2(<span class="va">self</span>.relu2(<span class="va">self</span>.fc2(x)))</span>
<span id="cb3-32"><a href="#cb3-32"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb3-33"><a href="#cb3-33"></a>        <span class="cf">return</span> x</span>
<span id="cb3-34"><a href="#cb3-34"></a></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="co"># Create the network</span></span>
<span id="cb3-36"><a href="#cb3-36"></a>simple_net <span class="op">=</span> SimpleNet(num_classes<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="bu">print</span>(<span class="st">"Simple Neural Network:"</span>)</span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="bu">print</span>(simple_net)</span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="co"># Count parameters</span></span>
<span id="cb3-41"><a href="#cb3-41"></a>total_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> simple_net.parameters())</span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>🎯 Try it yourself!</strong> <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-06-why-deep-learning.ipynb">Open in Colab</a></p>
</section>
<section id="the-convolutional-revolution" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="the-convolutional-revolution"><span class="header-section-number">0.5</span> The Convolutional Revolution</h2>
<p>But wait—there’s a problem with our simple network. It treats each pixel independently, ignoring spatial relationships. That’s like reading a book by looking at each letter separately!</p>
<p>Enter <strong>Convolutional Neural Networks (CNNs)</strong>—networks designed specifically for images:</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">class</span> ConvNet(nn.Module):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb4-3"><a href="#cb4-3"></a>        <span class="bu">super</span>(ConvNet, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb4-4"><a href="#cb4-4"></a>        </span>
<span id="cb4-5"><a href="#cb4-5"></a>        <span class="co"># Convolutional layers (feature extractors)</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="va">self</span>.conv1 <span class="op">=</span> nn.Conv2d(<span class="dv">3</span>, <span class="dv">32</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="va">self</span>.conv2 <span class="op">=</span> nn.Conv2d(<span class="dv">32</span>, <span class="dv">64</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="va">self</span>.conv3 <span class="op">=</span> nn.Conv2d(<span class="dv">64</span>, <span class="dv">128</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>        </span>
<span id="cb4-10"><a href="#cb4-10"></a>        <span class="co"># Pooling layers (downsampling)</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>        <span class="va">self</span>.pool <span class="op">=</span> nn.MaxPool2d(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a>        </span>
<span id="cb4-13"><a href="#cb4-13"></a>        <span class="co"># Fully connected layers (classifier)</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">128</span> <span class="op">*</span> <span class="dv">28</span> <span class="op">*</span> <span class="dv">28</span>, <span class="dv">512</span>)  <span class="co"># 224/8 = 28 after 3 pooling layers</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, num_classes)</span>
<span id="cb4-16"><a href="#cb4-16"></a>        </span>
<span id="cb4-17"><a href="#cb4-17"></a>        <span class="co"># Activation and regularization</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb4-19"><a href="#cb4-19"></a>        <span class="va">self</span>.dropout <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb4-20"><a href="#cb4-20"></a>    </span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb4-22"><a href="#cb4-22"></a>        <span class="co"># Feature extraction</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv1(x)))  <span class="co"># 224x224 -&gt; 112x112</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv2(x)))  <span class="co"># 112x112 -&gt; 56x56</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv3(x)))  <span class="co"># 56x56 -&gt; 28x28</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>        </span>
<span id="cb4-27"><a href="#cb4-27"></a>        <span class="co"># Flatten and classify</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>        x <span class="op">=</span> x.view(x.size(<span class="dv">0</span>), <span class="op">-</span><span class="dv">1</span>)  <span class="co"># Flatten</span></span>
<span id="cb4-29"><a href="#cb4-29"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout(<span class="va">self</span>.relu(<span class="va">self</span>.fc1(x)))</span>
<span id="cb4-30"><a href="#cb4-30"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb4-31"><a href="#cb4-31"></a>        </span>
<span id="cb4-32"><a href="#cb4-32"></a>        <span class="cf">return</span> x</span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="co"># Create CNN</span></span>
<span id="cb4-35"><a href="#cb4-35"></a>cnn <span class="op">=</span> ConvNet(num_classes<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="bu">print</span>(<span class="st">"Convolutional Neural Network:"</span>)</span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="bu">print</span>(cnn)</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="co"># Count parameters</span></span>
<span id="cb4-40"><a href="#cb4-40"></a>cnn_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> cnn.parameters())</span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">CNN parameters: </span><span class="sc">{</span>cnn_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="bu">print</span>(<span class="ss">f"Simple net parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="bu">print</span>(<span class="ss">f"CNN has </span><span class="sc">{</span>(total_params <span class="op">-</span> cnn_params) <span class="op">/</span> total_params <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% fewer parameters!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="understanding-convolutions-the-sliding-window" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="understanding-convolutions-the-sliding-window"><span class="header-section-number">0.6</span> Understanding Convolutions: The Sliding Window</h2>
<p>Let’s visualize what convolutions actually do:</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> visualize_convolution():</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="co">"""Show how convolution works"""</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="co"># Create a simple image</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    image <span class="op">=</span> np.array([</span>
<span id="cb5-5"><a href="#cb5-5"></a>        [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb5-6"><a href="#cb5-6"></a>        [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb5-7"><a href="#cb5-7"></a>        [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb5-8"><a href="#cb5-8"></a>        [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb5-9"><a href="#cb5-9"></a>        [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb5-10"><a href="#cb5-10"></a>    ])</span>
<span id="cb5-11"><a href="#cb5-11"></a>    </span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="co"># Edge detection kernel</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    kernel <span class="op">=</span> np.array([</span>
<span id="cb5-14"><a href="#cb5-14"></a>        [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb5-15"><a href="#cb5-15"></a>        [<span class="op">-</span><span class="dv">1</span>,  <span class="dv">8</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb5-16"><a href="#cb5-16"></a>        [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-17"><a href="#cb5-17"></a>    ])</span>
<span id="cb5-18"><a href="#cb5-18"></a>    </span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="co"># Apply convolution manually</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>    result <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb5-21"><a href="#cb5-21"></a>    </span>
<span id="cb5-22"><a href="#cb5-22"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb5-23"><a href="#cb5-23"></a>    </span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="co"># Show original image</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb5-26"><a href="#cb5-26"></a>    plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-27"><a href="#cb5-27"></a>    plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb5-28"><a href="#cb5-28"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-29"><a href="#cb5-29"></a>    </span>
<span id="cb5-30"><a href="#cb5-30"></a>    <span class="co"># Show kernel</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb5-32"><a href="#cb5-32"></a>    plt.imshow(kernel, cmap<span class="op">=</span><span class="st">'RdBu'</span>)</span>
<span id="cb5-33"><a href="#cb5-33"></a>    plt.title(<span class="st">"Edge Detection Kernel"</span>)</span>
<span id="cb5-34"><a href="#cb5-34"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-35"><a href="#cb5-35"></a>    </span>
<span id="cb5-36"><a href="#cb5-36"></a>    <span class="co"># Show convolution process</span></span>
<span id="cb5-37"><a href="#cb5-37"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb5-38"><a href="#cb5-38"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb5-39"><a href="#cb5-39"></a>            patch <span class="op">=</span> image[i:i<span class="op">+</span><span class="dv">3</span>, j:j<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb5-40"><a href="#cb5-40"></a>            result[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(patch <span class="op">*</span> kernel)</span>
<span id="cb5-41"><a href="#cb5-41"></a>    </span>
<span id="cb5-42"><a href="#cb5-42"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb5-43"><a href="#cb5-43"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-44"><a href="#cb5-44"></a>    plt.title(<span class="st">"Convolution Result"</span>)</span>
<span id="cb5-45"><a href="#cb5-45"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-46"><a href="#cb5-46"></a>    </span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="co"># Show using PyTorch</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>    image_tensor <span class="op">=</span> torch.FloatTensor(image).unsqueeze(<span class="dv">0</span>).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb5-49"><a href="#cb5-49"></a>    kernel_tensor <span class="op">=</span> torch.FloatTensor(kernel).unsqueeze(<span class="dv">0</span>).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb5-50"><a href="#cb5-50"></a>    </span>
<span id="cb5-51"><a href="#cb5-51"></a>    conv_layer <span class="op">=</span> nn.Conv2d(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-52"><a href="#cb5-52"></a>    conv_layer.weight.data <span class="op">=</span> kernel_tensor</span>
<span id="cb5-53"><a href="#cb5-53"></a>    </span>
<span id="cb5-54"><a href="#cb5-54"></a>    pytorch_result <span class="op">=</span> conv_layer(image_tensor).squeeze().detach().numpy()</span>
<span id="cb5-55"><a href="#cb5-55"></a>    </span>
<span id="cb5-56"><a href="#cb5-56"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb5-57"><a href="#cb5-57"></a>    plt.imshow(pytorch_result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-58"><a href="#cb5-58"></a>    plt.title(<span class="st">"PyTorch Result"</span>)</span>
<span id="cb5-59"><a href="#cb5-59"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-60"><a href="#cb5-60"></a>    </span>
<span id="cb5-61"><a href="#cb5-61"></a>    plt.tight_layout()</span>
<span id="cb5-62"><a href="#cb5-62"></a>    plt.show()</span>
<span id="cb5-63"><a href="#cb5-63"></a></span>
<span id="cb5-64"><a href="#cb5-64"></a>visualize_convolution()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="transfer-learning-standing-on-giants-shoulders" class="level2" data-number="0.7">
<h2 data-number="0.7" class="anchored" data-anchor-id="transfer-learning-standing-on-giants-shoulders"><span class="header-section-number">0.7</span> Transfer Learning: Standing on Giants’ Shoulders</h2>
<p>Here’s the secret that makes deep learning practical: <strong>Transfer Learning</strong>. Instead of training from scratch, we use pre-trained models and adapt them to our needs:</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> torchvision.models <span class="im">as</span> models</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Load a pre-trained ResNet model</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>pretrained_model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="bu">print</span>(<span class="st">"Pre-trained ResNet-18:"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="bu">print</span>(pretrained_model)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># Modify for our task (cat vs dog classification)</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>num_classes <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>pretrained_model.fc <span class="op">=</span> nn.Linear(pretrained_model.fc.in_features, num_classes)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Modified final layer for </span><span class="sc">{</span>num_classes<span class="sc">}</span><span class="ss"> classes"</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="bu">print</span>(<span class="ss">f"Final layer: </span><span class="sc">{</span>pretrained_model<span class="sc">.</span>fc<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co"># Freeze early layers (optional)</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="cf">for</span> param <span class="kw">in</span> pretrained_model.parameters():</span>
<span id="cb6-17"><a href="#cb6-17"></a>    param.requires_grad <span class="op">=</span> <span class="va">False</span></span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co"># Only train the final layer</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="cf">for</span> param <span class="kw">in</span> pretrained_model.fc.parameters():</span>
<span id="cb6-21"><a href="#cb6-21"></a>    param.requires_grad <span class="op">=</span> <span class="va">True</span></span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a>trainable_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> pretrained_model.parameters() <span class="cf">if</span> p.requires_grad)</span>
<span id="cb6-24"><a href="#cb6-24"></a>total_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> pretrained_model.parameters())</span>
<span id="cb6-25"><a href="#cb6-25"></a></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Trainable parameters: </span><span class="sc">{</span>trainable_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="bu">print</span>(<span class="ss">f"Total parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="bu">print</span>(<span class="ss">f"Training only </span><span class="sc">{</span>trainable_params<span class="op">/</span>total_params<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of parameters!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="your-first-image-classifier" class="level2" data-number="0.8">
<h2 data-number="0.8" class="anchored" data-anchor-id="your-first-image-classifier"><span class="header-section-number">0.8</span> Your First Image Classifier</h2>
<p>Let’s build a complete image classification system:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">class</span> ImageClassifier:</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_name<span class="op">=</span><span class="st">'resnet18'</span>, num_classes<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb7-3"><a href="#cb7-3"></a>        <span class="va">self</span>.device <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="bu">print</span>(<span class="ss">f"Using device: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>device<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>        </span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="co"># Load pre-trained model</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="cf">if</span> model_name <span class="op">==</span> <span class="st">'resnet18'</span>:</span>
<span id="cb7-8"><a href="#cb7-8"></a>            <span class="va">self</span>.model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>            <span class="va">self</span>.model.fc <span class="op">=</span> nn.Linear(<span class="va">self</span>.model.fc.in_features, num_classes)</span>
<span id="cb7-10"><a href="#cb7-10"></a>        </span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">self</span>.model.to(<span class="va">self</span>.device)</span>
<span id="cb7-12"><a href="#cb7-12"></a>        </span>
<span id="cb7-13"><a href="#cb7-13"></a>        <span class="co"># Define transforms</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>        <span class="va">self</span>.transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb7-15"><a href="#cb7-15"></a>            transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb7-16"><a href="#cb7-16"></a>            transforms.ToTensor(),</span>
<span id="cb7-17"><a href="#cb7-17"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb7-18"><a href="#cb7-18"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb7-19"><a href="#cb7-19"></a>        ])</span>
<span id="cb7-20"><a href="#cb7-20"></a>        </span>
<span id="cb7-21"><a href="#cb7-21"></a>        <span class="va">self</span>.classes <span class="op">=</span> [<span class="st">'cat'</span>, <span class="st">'dog'</span>]  <span class="co"># Update based on your classes</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>    </span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, image):</span>
<span id="cb7-24"><a href="#cb7-24"></a>        <span class="co">"""Predict class of a single image"""</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb7-26"><a href="#cb7-26"></a>        </span>
<span id="cb7-27"><a href="#cb7-27"></a>        <span class="co"># Preprocess image</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb7-29"><a href="#cb7-29"></a>            <span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb7-30"><a href="#cb7-30"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb7-31"><a href="#cb7-31"></a>        </span>
<span id="cb7-32"><a href="#cb7-32"></a>        input_tensor <span class="op">=</span> <span class="va">self</span>.transform(image).unsqueeze(<span class="dv">0</span>).to(<span class="va">self</span>.device)</span>
<span id="cb7-33"><a href="#cb7-33"></a>        </span>
<span id="cb7-34"><a href="#cb7-34"></a>        <span class="co"># Make prediction</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb7-36"><a href="#cb7-36"></a>            outputs <span class="op">=</span> <span class="va">self</span>.model(input_tensor)</span>
<span id="cb7-37"><a href="#cb7-37"></a>            probabilities <span class="op">=</span> torch.softmax(outputs, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-38"><a href="#cb7-38"></a>            predicted_class <span class="op">=</span> torch.argmax(probabilities, dim<span class="op">=</span><span class="dv">1</span>).item()</span>
<span id="cb7-39"><a href="#cb7-39"></a>            confidence <span class="op">=</span> probabilities[<span class="dv">0</span>][predicted_class].item()</span>
<span id="cb7-40"><a href="#cb7-40"></a>        </span>
<span id="cb7-41"><a href="#cb7-41"></a>        <span class="cf">return</span> {</span>
<span id="cb7-42"><a href="#cb7-42"></a>            <span class="st">'class'</span>: <span class="va">self</span>.classes[predicted_class],</span>
<span id="cb7-43"><a href="#cb7-43"></a>            <span class="st">'confidence'</span>: confidence,</span>
<span id="cb7-44"><a href="#cb7-44"></a>            <span class="st">'probabilities'</span>: probabilities.cpu().numpy()[<span class="dv">0</span>]</span>
<span id="cb7-45"><a href="#cb7-45"></a>        }</span>
<span id="cb7-46"><a href="#cb7-46"></a>    </span>
<span id="cb7-47"><a href="#cb7-47"></a>    <span class="kw">def</span> predict_batch(<span class="va">self</span>, images):</span>
<span id="cb7-48"><a href="#cb7-48"></a>        <span class="co">"""Predict classes for multiple images"""</span></span>
<span id="cb7-49"><a href="#cb7-49"></a>        results <span class="op">=</span> []</span>
<span id="cb7-50"><a href="#cb7-50"></a>        <span class="cf">for</span> image <span class="kw">in</span> images:</span>
<span id="cb7-51"><a href="#cb7-51"></a>            result <span class="op">=</span> <span class="va">self</span>.predict(image)</span>
<span id="cb7-52"><a href="#cb7-52"></a>            results.append(result)</span>
<span id="cb7-53"><a href="#cb7-53"></a>        <span class="cf">return</span> results</span>
<span id="cb7-54"><a href="#cb7-54"></a></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="co"># Create classifier</span></span>
<span id="cb7-56"><a href="#cb7-56"></a>classifier <span class="op">=</span> ImageClassifier()</span>
<span id="cb7-57"><a href="#cb7-57"></a></span>
<span id="cb7-58"><a href="#cb7-58"></a><span class="co"># Test with a sample image (you would load your own)</span></span>
<span id="cb7-59"><a href="#cb7-59"></a><span class="kw">def</span> test_classifier(image_path):</span>
<span id="cb7-60"><a href="#cb7-60"></a>    <span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb7-61"><a href="#cb7-61"></a>    </span>
<span id="cb7-62"><a href="#cb7-62"></a>    <span class="co"># Load image</span></span>
<span id="cb7-63"><a href="#cb7-63"></a>    image <span class="op">=</span> Image.<span class="bu">open</span>(image_path)</span>
<span id="cb7-64"><a href="#cb7-64"></a>    </span>
<span id="cb7-65"><a href="#cb7-65"></a>    <span class="co"># Make prediction</span></span>
<span id="cb7-66"><a href="#cb7-66"></a>    result <span class="op">=</span> classifier.predict(image)</span>
<span id="cb7-67"><a href="#cb7-67"></a>    </span>
<span id="cb7-68"><a href="#cb7-68"></a>    <span class="co"># Display result</span></span>
<span id="cb7-69"><a href="#cb7-69"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb7-70"><a href="#cb7-70"></a>    </span>
<span id="cb7-71"><a href="#cb7-71"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb7-72"><a href="#cb7-72"></a>    plt.imshow(image)</span>
<span id="cb7-73"><a href="#cb7-73"></a>    plt.title(<span class="ss">f"Input Image"</span>)</span>
<span id="cb7-74"><a href="#cb7-74"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-75"><a href="#cb7-75"></a>    </span>
<span id="cb7-76"><a href="#cb7-76"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb7-77"><a href="#cb7-77"></a>    plt.bar(classifier.classes, result[<span class="st">'probabilities'</span>])</span>
<span id="cb7-78"><a href="#cb7-78"></a>    plt.title(<span class="ss">f"Prediction: </span><span class="sc">{</span>result[<span class="st">'class'</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>result[<span class="st">'confidence'</span>]<span class="sc">:.2f}</span><span class="ss">)"</span>)</span>
<span id="cb7-79"><a href="#cb7-79"></a>    plt.ylabel(<span class="st">"Probability"</span>)</span>
<span id="cb7-80"><a href="#cb7-80"></a>    </span>
<span id="cb7-81"><a href="#cb7-81"></a>    plt.tight_layout()</span>
<span id="cb7-82"><a href="#cb7-82"></a>    plt.show()</span>
<span id="cb7-83"><a href="#cb7-83"></a>    </span>
<span id="cb7-84"><a href="#cb7-84"></a>    <span class="cf">return</span> result</span>
<span id="cb7-85"><a href="#cb7-85"></a></span>
<span id="cb7-86"><a href="#cb7-86"></a><span class="co"># Test the classifier</span></span>
<span id="cb7-87"><a href="#cb7-87"></a><span class="co"># result = test_classifier('your_image.jpg')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualizing-what-neural-networks-learn" class="level2" data-number="0.9">
<h2 data-number="0.9" class="anchored" data-anchor-id="visualizing-what-neural-networks-learn"><span class="header-section-number">0.9</span> Visualizing What Neural Networks Learn</h2>
<p>One of the coolest things about deep learning is visualizing what the network actually learns:</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> visualize_filters(model, layer_name<span class="op">=</span><span class="st">'conv1'</span>):</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="co">"""Visualize the filters learned by a convolutional layer"""</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>    </span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="co"># Get the layer</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    layer <span class="op">=</span> <span class="bu">dict</span>(model.named_modules())[layer_name]</span>
<span id="cb8-6"><a href="#cb8-6"></a>    </span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="co"># Get the weights</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    weights <span class="op">=</span> layer.weight.data.cpu()</span>
<span id="cb8-9"><a href="#cb8-9"></a>    </span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="co"># Normalize weights for visualization</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    weights <span class="op">=</span> (weights <span class="op">-</span> weights.<span class="bu">min</span>()) <span class="op">/</span> (weights.<span class="bu">max</span>() <span class="op">-</span> weights.<span class="bu">min</span>())</span>
<span id="cb8-12"><a href="#cb8-12"></a>    </span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="co"># Plot filters</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    num_filters <span class="op">=</span> <span class="bu">min</span>(<span class="dv">16</span>, weights.shape[<span class="dv">0</span>])  <span class="co"># Show first 16 filters</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    </span>
<span id="cb8-16"><a href="#cb8-16"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb8-17"><a href="#cb8-17"></a>    </span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_filters):</span>
<span id="cb8-19"><a href="#cb8-19"></a>        plt.subplot(<span class="dv">4</span>, <span class="dv">4</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-20"><a href="#cb8-20"></a>        </span>
<span id="cb8-21"><a href="#cb8-21"></a>        <span class="cf">if</span> weights.shape[<span class="dv">1</span>] <span class="op">==</span> <span class="dv">3</span>:  <span class="co"># RGB filters</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>            <span class="co"># Transpose from (C, H, W) to (H, W, C)</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>            filter_img <span class="op">=</span> weights[i].permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a>            plt.imshow(filter_img)</span>
<span id="cb8-25"><a href="#cb8-25"></a>        <span class="cf">else</span>:  <span class="co"># Grayscale filters</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>            plt.imshow(weights[i, <span class="dv">0</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb8-27"><a href="#cb8-27"></a>        </span>
<span id="cb8-28"><a href="#cb8-28"></a>        plt.title(<span class="ss">f"Filter </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-29"><a href="#cb8-29"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb8-30"><a href="#cb8-30"></a>    </span>
<span id="cb8-31"><a href="#cb8-31"></a>    plt.suptitle(<span class="ss">f"Learned Filters in </span><span class="sc">{</span>layer_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-32"><a href="#cb8-32"></a>    plt.tight_layout()</span>
<span id="cb8-33"><a href="#cb8-33"></a>    plt.show()</span>
<span id="cb8-34"><a href="#cb8-34"></a></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co"># Visualize filters from our pre-trained model</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>visualize_filters(pretrained_model, <span class="st">'conv1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="feature-maps-seeing-through-the-networks-eyes" class="level2" data-number="0.10">
<h2 data-number="0.10" class="anchored" data-anchor-id="feature-maps-seeing-through-the-networks-eyes"><span class="header-section-number">0.10</span> Feature Maps: Seeing Through the Network’s Eyes</h2>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> visualize_feature_maps(model, image, layer_name<span class="op">=</span><span class="st">'layer1'</span>):</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co">"""Visualize feature maps from a specific layer"""</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    </span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="co"># Hook to capture feature maps</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    feature_maps <span class="op">=</span> []</span>
<span id="cb9-6"><a href="#cb9-6"></a>    </span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="kw">def</span> hook_fn(module, <span class="bu">input</span>, output):</span>
<span id="cb9-8"><a href="#cb9-8"></a>        feature_maps.append(output.cpu())</span>
<span id="cb9-9"><a href="#cb9-9"></a>    </span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="co"># Register hook</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>    layer <span class="op">=</span> <span class="bu">dict</span>(model.named_modules())[layer_name]</span>
<span id="cb9-12"><a href="#cb9-12"></a>    hook <span class="op">=</span> layer.register_forward_hook(hook_fn)</span>
<span id="cb9-13"><a href="#cb9-13"></a>    </span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="co"># Forward pass</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb9-17"><a href="#cb9-17"></a>        _ <span class="op">=</span> model(image.unsqueeze(<span class="dv">0</span>))</span>
<span id="cb9-18"><a href="#cb9-18"></a>    </span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="co"># Remove hook</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>    hook.remove()</span>
<span id="cb9-21"><a href="#cb9-21"></a>    </span>
<span id="cb9-22"><a href="#cb9-22"></a>    <span class="co"># Get feature maps</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>    fmaps <span class="op">=</span> feature_maps[<span class="dv">0</span>].squeeze(<span class="dv">0</span>)  <span class="co"># Remove batch dimension</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>    </span>
<span id="cb9-25"><a href="#cb9-25"></a>    <span class="co"># Plot feature maps</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>    num_maps <span class="op">=</span> <span class="bu">min</span>(<span class="dv">16</span>, fmaps.shape[<span class="dv">0</span>])</span>
<span id="cb9-27"><a href="#cb9-27"></a>    </span>
<span id="cb9-28"><a href="#cb9-28"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb9-29"><a href="#cb9-29"></a>    </span>
<span id="cb9-30"><a href="#cb9-30"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_maps):</span>
<span id="cb9-31"><a href="#cb9-31"></a>        plt.subplot(<span class="dv">4</span>, <span class="dv">4</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb9-32"><a href="#cb9-32"></a>        plt.imshow(fmaps[i], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb9-33"><a href="#cb9-33"></a>        plt.title(<span class="ss">f"Feature Map </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-34"><a href="#cb9-34"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb9-35"><a href="#cb9-35"></a>    </span>
<span id="cb9-36"><a href="#cb9-36"></a>    plt.suptitle(<span class="ss">f"Feature Maps from </span><span class="sc">{</span>layer_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-37"><a href="#cb9-37"></a>    plt.tight_layout()</span>
<span id="cb9-38"><a href="#cb9-38"></a>    plt.show()</span>
<span id="cb9-39"><a href="#cb9-39"></a></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co"># Create a sample input</span></span>
<span id="cb9-41"><a href="#cb9-41"></a>sample_input <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">224</span>, <span class="dv">224</span>)</span>
<span id="cb9-42"><a href="#cb9-42"></a>visualize_feature_maps(pretrained_model, sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="the-deep-learning-advantage-why-it-works" class="level2" data-number="0.11">
<h2 data-number="0.11" class="anchored" data-anchor-id="the-deep-learning-advantage-why-it-works"><span class="header-section-number">0.11</span> The Deep Learning Advantage: Why It Works</h2>
<p>Let’s compare classical vs deep learning approaches on a real problem:</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">def</span> compare_approaches(image):</span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="co">"""Compare classical and deep learning approaches"""</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>    </span>
<span id="cb10-4"><a href="#cb10-4"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb10-5"><a href="#cb10-5"></a>    </span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="co"># Original image</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a>    plt.imshow(image)</span>
<span id="cb10-9"><a href="#cb10-9"></a>    plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb10-10"><a href="#cb10-10"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>    </span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="co"># Classical approach: hand-crafted features</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb10-14"><a href="#cb10-14"></a>    </span>
<span id="cb10-15"><a href="#cb10-15"></a>    <span class="co"># Edge features</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>    edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a>    plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb10-19"><a href="#cb10-19"></a>    plt.title(<span class="st">"Classical: Edge Features"</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-21"><a href="#cb10-21"></a>    </span>
<span id="cb10-22"><a href="#cb10-22"></a>    <span class="co"># Texture features (using LBP-like approach)</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>    <span class="im">from</span> skimage.feature <span class="im">import</span> local_binary_pattern</span>
<span id="cb10-24"><a href="#cb10-24"></a>    lbp <span class="op">=</span> local_binary_pattern(gray, <span class="dv">24</span>, <span class="dv">8</span>, method<span class="op">=</span><span class="st">'uniform'</span>)</span>
<span id="cb10-25"><a href="#cb10-25"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb10-26"><a href="#cb10-26"></a>    plt.imshow(lbp, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb10-27"><a href="#cb10-27"></a>    plt.title(<span class="st">"Classical: Texture Features"</span>)</span>
<span id="cb10-28"><a href="#cb10-28"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-29"><a href="#cb10-29"></a>    </span>
<span id="cb10-30"><a href="#cb10-30"></a>    <span class="co"># Deep learning approach: learned features</span></span>
<span id="cb10-31"><a href="#cb10-31"></a>    <span class="co"># Transform image for the model</span></span>
<span id="cb10-32"><a href="#cb10-32"></a>    transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb10-33"><a href="#cb10-33"></a>        transforms.ToPILImage(),</span>
<span id="cb10-34"><a href="#cb10-34"></a>        transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb10-35"><a href="#cb10-35"></a>        transforms.ToTensor(),</span>
<span id="cb10-36"><a href="#cb10-36"></a>        transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb10-37"><a href="#cb10-37"></a>                           std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb10-38"><a href="#cb10-38"></a>    ])</span>
<span id="cb10-39"><a href="#cb10-39"></a>    </span>
<span id="cb10-40"><a href="#cb10-40"></a>    input_tensor <span class="op">=</span> transform(image).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb10-41"><a href="#cb10-41"></a>    </span>
<span id="cb10-42"><a href="#cb10-42"></a>    <span class="co"># Get feature maps from different layers</span></span>
<span id="cb10-43"><a href="#cb10-43"></a>    feature_maps <span class="op">=</span> []</span>
<span id="cb10-44"><a href="#cb10-44"></a>    </span>
<span id="cb10-45"><a href="#cb10-45"></a>    <span class="kw">def</span> get_features(name):</span>
<span id="cb10-46"><a href="#cb10-46"></a>        <span class="kw">def</span> hook(model, <span class="bu">input</span>, output):</span>
<span id="cb10-47"><a href="#cb10-47"></a>            feature_maps.append((name, output.cpu()))</span>
<span id="cb10-48"><a href="#cb10-48"></a>        <span class="cf">return</span> hook</span>
<span id="cb10-49"><a href="#cb10-49"></a>    </span>
<span id="cb10-50"><a href="#cb10-50"></a>    <span class="co"># Register hooks</span></span>
<span id="cb10-51"><a href="#cb10-51"></a>    pretrained_model.layer1.register_forward_hook(get_features(<span class="st">'Low-level'</span>))</span>
<span id="cb10-52"><a href="#cb10-52"></a>    pretrained_model.layer3.register_forward_hook(get_features(<span class="st">'Mid-level'</span>))</span>
<span id="cb10-53"><a href="#cb10-53"></a>    pretrained_model.layer4.register_forward_hook(get_features(<span class="st">'High-level'</span>))</span>
<span id="cb10-54"><a href="#cb10-54"></a>    </span>
<span id="cb10-55"><a href="#cb10-55"></a>    <span class="co"># Forward pass</span></span>
<span id="cb10-56"><a href="#cb10-56"></a>    pretrained_model.<span class="bu">eval</span>()</span>
<span id="cb10-57"><a href="#cb10-57"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb10-58"><a href="#cb10-58"></a>        _ <span class="op">=</span> pretrained_model(input_tensor)</span>
<span id="cb10-59"><a href="#cb10-59"></a>    </span>
<span id="cb10-60"><a href="#cb10-60"></a>    <span class="co"># Visualize learned features</span></span>
<span id="cb10-61"><a href="#cb10-61"></a>    <span class="cf">for</span> i, (name, fmaps) <span class="kw">in</span> <span class="bu">enumerate</span>(feature_maps):</span>
<span id="cb10-62"><a href="#cb10-62"></a>        plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">+</span> i)</span>
<span id="cb10-63"><a href="#cb10-63"></a>        <span class="co"># Average across channels for visualization</span></span>
<span id="cb10-64"><a href="#cb10-64"></a>        avg_fmap <span class="op">=</span> torch.mean(fmaps.squeeze(<span class="dv">0</span>), dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-65"><a href="#cb10-65"></a>        plt.imshow(avg_fmap, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb10-66"><a href="#cb10-66"></a>        plt.title(<span class="ss">f"Deep Learning: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Features"</span>)</span>
<span id="cb10-67"><a href="#cb10-67"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-68"><a href="#cb10-68"></a>    </span>
<span id="cb10-69"><a href="#cb10-69"></a>    plt.tight_layout()</span>
<span id="cb10-70"><a href="#cb10-70"></a>    plt.show()</span>
<span id="cb10-71"><a href="#cb10-71"></a></span>
<span id="cb10-72"><a href="#cb10-72"></a><span class="co"># Compare approaches (you would use your own image)</span></span>
<span id="cb10-73"><a href="#cb10-73"></a><span class="co"># compare_approaches(your_image)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="why-deep-learning-won" class="level2" data-number="0.12">
<h2 data-number="0.12" class="anchored" data-anchor-id="why-deep-learning-won"><span class="header-section-number">0.12</span> Why Deep Learning Won</h2>
<p>Here’s why deep learning revolutionized computer vision:</p>
<section id="automatic-feature-learning" class="level3" data-number="0.12.1">
<h3 data-number="0.12.1" class="anchored" data-anchor-id="automatic-feature-learning"><span class="header-section-number">0.12.1</span> 1. <strong>Automatic Feature Learning</strong></h3>
<ul>
<li>No need to hand-craft features</li>
<li>Learns optimal representations for the task</li>
<li>Adapts to data variations</li>
</ul>
</section>
<section id="hierarchical-representations" class="level3" data-number="0.12.2">
<h3 data-number="0.12.2" class="anchored" data-anchor-id="hierarchical-representations"><span class="header-section-number">0.12.2</span> 2. <strong>Hierarchical Representations</strong></h3>
<ul>
<li>Low-level features (edges, textures)</li>
<li>Mid-level features (parts, patterns)<br>
</li>
<li>High-level features (objects, concepts)</li>
</ul>
</section>
<section id="end-to-end-learning" class="level3" data-number="0.12.3">
<h3 data-number="0.12.3" class="anchored" data-anchor-id="end-to-end-learning"><span class="header-section-number">0.12.3</span> 3. <strong>End-to-End Learning</strong></h3>
<ul>
<li>Optimizes entire pipeline together</li>
<li>Features and classifier learned jointly</li>
<li>Better overall performance</li>
</ul>
</section>
<section id="scalability" class="level3" data-number="0.12.4">
<h3 data-number="0.12.4" class="anchored" data-anchor-id="scalability"><span class="header-section-number">0.12.4</span> 4. <strong>Scalability</strong></h3>
<ul>
<li>Performance improves with more data</li>
<li>Can handle complex, real-world variations</li>
<li>Generalizes across domains</li>
</ul>
</section>
</section>
<section id="the-modern-deep-learning-pipeline" class="level2" data-number="0.13">
<h2 data-number="0.13" class="anchored" data-anchor-id="the-modern-deep-learning-pipeline"><span class="header-section-number">0.13</span> The Modern Deep Learning Pipeline</h2>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">class</span> ModernVisionPipeline:</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb11-3"><a href="#cb11-3"></a>        <span class="va">self</span>.device <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a>        </span>
<span id="cb11-5"><a href="#cb11-5"></a>        <span class="co"># 1. Data preprocessing</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>        <span class="va">self</span>.transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb11-7"><a href="#cb11-7"></a>            transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb11-8"><a href="#cb11-8"></a>            transforms.RandomHorizontalFlip(p<span class="op">=</span><span class="fl">0.5</span>),  <span class="co"># Data augmentation</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>            transforms.RandomRotation(<span class="dv">10</span>),</span>
<span id="cb11-10"><a href="#cb11-10"></a>            transforms.ColorJitter(brightness<span class="op">=</span><span class="fl">0.2</span>, contrast<span class="op">=</span><span class="fl">0.2</span>),</span>
<span id="cb11-11"><a href="#cb11-11"></a>            transforms.ToTensor(),</span>
<span id="cb11-12"><a href="#cb11-12"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb11-13"><a href="#cb11-13"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb11-14"><a href="#cb11-14"></a>        ])</span>
<span id="cb11-15"><a href="#cb11-15"></a>        </span>
<span id="cb11-16"><a href="#cb11-16"></a>        <span class="co"># 2. Model architecture</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>        <span class="va">self</span>.model <span class="op">=</span> models.resnet50(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a>        </span>
<span id="cb11-19"><a href="#cb11-19"></a>        <span class="co"># 3. Transfer learning setup</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>        <span class="co"># Freeze early layers</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>        <span class="cf">for</span> param <span class="kw">in</span> <span class="bu">list</span>(<span class="va">self</span>.model.parameters())[:<span class="op">-</span><span class="dv">10</span>]:</span>
<span id="cb11-22"><a href="#cb11-22"></a>            param.requires_grad <span class="op">=</span> <span class="va">False</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>        </span>
<span id="cb11-24"><a href="#cb11-24"></a>        <span class="co"># 4. Optimizer and loss</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>        <span class="va">self</span>.optimizer <span class="op">=</span> optim.Adam(</span>
<span id="cb11-26"><a href="#cb11-26"></a>            <span class="bu">filter</span>(<span class="kw">lambda</span> p: p.requires_grad, <span class="va">self</span>.model.parameters()),</span>
<span id="cb11-27"><a href="#cb11-27"></a>            lr<span class="op">=</span><span class="fl">0.001</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>        )</span>
<span id="cb11-29"><a href="#cb11-29"></a>        <span class="va">self</span>.criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb11-30"><a href="#cb11-30"></a>    </span>
<span id="cb11-31"><a href="#cb11-31"></a>    <span class="kw">def</span> train_step(<span class="va">self</span>, images, labels):</span>
<span id="cb11-32"><a href="#cb11-32"></a>        <span class="co">"""Single training step"""</span></span>
<span id="cb11-33"><a href="#cb11-33"></a>        <span class="va">self</span>.model.train()</span>
<span id="cb11-34"><a href="#cb11-34"></a>        </span>
<span id="cb11-35"><a href="#cb11-35"></a>        <span class="co"># Forward pass</span></span>
<span id="cb11-36"><a href="#cb11-36"></a>        outputs <span class="op">=</span> <span class="va">self</span>.model(images)</span>
<span id="cb11-37"><a href="#cb11-37"></a>        loss <span class="op">=</span> <span class="va">self</span>.criterion(outputs, labels)</span>
<span id="cb11-38"><a href="#cb11-38"></a>        </span>
<span id="cb11-39"><a href="#cb11-39"></a>        <span class="co"># Backward pass</span></span>
<span id="cb11-40"><a href="#cb11-40"></a>        <span class="va">self</span>.optimizer.zero_grad()</span>
<span id="cb11-41"><a href="#cb11-41"></a>        loss.backward()</span>
<span id="cb11-42"><a href="#cb11-42"></a>        <span class="va">self</span>.optimizer.step()</span>
<span id="cb11-43"><a href="#cb11-43"></a>        </span>
<span id="cb11-44"><a href="#cb11-44"></a>        <span class="cf">return</span> loss.item()</span>
<span id="cb11-45"><a href="#cb11-45"></a>    </span>
<span id="cb11-46"><a href="#cb11-46"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>, images, labels):</span>
<span id="cb11-47"><a href="#cb11-47"></a>        <span class="co">"""Evaluation step"""</span></span>
<span id="cb11-48"><a href="#cb11-48"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb11-49"><a href="#cb11-49"></a>        </span>
<span id="cb11-50"><a href="#cb11-50"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb11-51"><a href="#cb11-51"></a>            outputs <span class="op">=</span> <span class="va">self</span>.model(images)</span>
<span id="cb11-52"><a href="#cb11-52"></a>            _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb11-53"><a href="#cb11-53"></a>            accuracy <span class="op">=</span> (predicted <span class="op">==</span> labels).<span class="bu">float</span>().mean()</span>
<span id="cb11-54"><a href="#cb11-54"></a>        </span>
<span id="cb11-55"><a href="#cb11-55"></a>        <span class="cf">return</span> accuracy.item()</span>
<span id="cb11-56"><a href="#cb11-56"></a></span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="co"># Create modern pipeline</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>pipeline <span class="op">=</span> ModernVisionPipeline()</span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="bu">print</span>(<span class="st">"Modern deep learning pipeline ready!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="whats-coming-next" class="level2" data-number="0.14">
<h2 data-number="0.14" class="anchored" data-anchor-id="whats-coming-next"><span class="header-section-number">0.14</span> What’s Coming Next?</h2>
<p>In our next post, <a href="../07-modern-vision-models/"><strong>“Modern Vision Models: CNNs, Vision Transformers, and DINOv2”</strong></a>, we’ll explore:</p>
<ul>
<li><strong>State-of-the-art architectures</strong> (ResNet, EfficientNet, Vision Transformers)</li>
<li><strong>Foundation models</strong> like DINOv2</li>
<li><strong>Self-supervised learning</strong> (learning without labels)</li>
<li><strong>Building your own DINOv2 feature extractor</strong></li>
</ul>
<p>You’ve just learned why deep learning revolutionized computer vision—next, we’ll explore the cutting-edge models that are shaping the future!</p>
</section>
<section id="key-takeaways" class="level2" data-number="0.15">
<h2 data-number="0.15" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">0.15</span> Key Takeaways</h2>
<ul>
<li><strong>Classical methods hit a wall</strong> with complex real-world variations</li>
<li><strong>Deep learning learns features automatically</strong> instead of hand-crafting them</li>
<li><strong>CNNs are designed for images</strong> with spatial understanding</li>
<li><strong>Transfer learning</strong> makes deep learning practical for everyone</li>
<li><strong>Hierarchical features</strong> enable understanding at multiple levels</li>
<li><strong>Modern pipelines</strong> combine data augmentation, pre-training, and fine-tuning</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hands-On Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ready to build your first deep learning classifier? Try the complete interactive notebook: <a href="https://colab.research.google.com/drive/1Deep_Learning_Basics_123456"><strong>Deep Learning Basics Lab</strong></a></p>
<p>Train your own cat vs dog classifier and see the power of neural networks!</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Series Navigation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Previous</strong>: <a href="../05-feature-magic/">Feature Magic: What Makes Images Unique</a></li>
<li><strong>Next</strong>: <a href="../07-modern-vision-models/">Modern Vision Models: CNNs, Vision Transformers, and DINOv2</a></li>
<li><strong>Series Home</strong>: <a href="../../../posts/series/computer-vision-foundations.html">Computer Vision Foundations</a></li>
</ul>
</div>
</div>
<hr>
<p><em>You’ve just witnessed the deep learning revolution! From struggling with cat vs dog classification to achieving superhuman performance on complex tasks—this is why deep learning changed everything. Next, we’ll explore the latest and greatest models that are pushing the boundaries even further.</em></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div>CC BY-NC-SA 4.0</div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2025,
  author = {, Hasan},
  title = {Why {Deep} {Learning?} {When} {Classical} {Methods} {Hit} the
    {Wall}},
  date = {2025-01-22},
  url = {https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/06-why-deep-learning.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Hasan. 2025. <span>“Why Deep Learning? When Classical Methods Hit the
Wall.”</span> January 22, 2025. <a href="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/06-why-deep-learning.html">https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/06-why-deep-learning.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="yourusername/quarto_blog_hasan" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<script src="https://giscus.app/client.js" data-repo="HasanGoni/quarto_blog_hasan" data-repo-id="" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">---</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="an">title:</span><span class="co"> "Why Deep Learning? When Classical Methods Hit the Wall"</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="an">author:</span><span class="co"> "Hasan"</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="an">date:</span><span class="co"> 2025-01-22</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="an">categories:</span><span class="co"> [computer-vision, deep-learning, neural-networks, pytorch]</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="an">tags:</span><span class="co"> [cnn, transfer-learning, pytorch, classification]</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="an">image:</span><span class="co"> "https://images.unsplash.com/photo-1677442136019-21780ecad995?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=2032&amp;q=80"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="an">series:</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">  name: "Computer Vision Foundations"</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">  number: 6</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="an">format:</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">  html: default</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">---</span></span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="fu">## The Great Computer Vision Crisis of 2010</span></span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>Picture this: It's 2010, and computer vision researchers are frustrated. They've spent decades perfecting edge detection, feature matching, and object recognition. Their algorithms can find corners, match keypoints, and even stitch panoramas.</span>
<span id="cb12-20"><a href="#cb12-20"></a></span>
<span id="cb12-21"><a href="#cb12-21"></a>But there's one problem they can't solve: **telling cats from dogs.**</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a>Seriously! While a 3-year-old child could easily distinguish between cats and dogs, the best computer vision systems struggled with this "simple" task. The classical approach required hand-crafting features for every possible variation—different breeds, lighting conditions, poses, backgrounds. It was like trying to write rules for every possible way a cat could look. Impossible!</span>
<span id="cb12-24"><a href="#cb12-24"></a></span>
<span id="cb12-25"><a href="#cb12-25"></a>Then something revolutionary happened...</span>
<span id="cb12-26"><a href="#cb12-26"></a></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="fu">## The ImageNet Moment: 2012</span></span>
<span id="cb12-28"><a href="#cb12-28"></a></span>
<span id="cb12-29"><a href="#cb12-29"></a>In 2012, a team led by Alex Krizhevsky entered the ImageNet competition with something called **AlexNet**—a deep neural network. The results were shocking:</span>
<span id="cb12-30"><a href="#cb12-30"></a></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="ss">- </span>**Previous best accuracy**: 74.3%</span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="ss">- </span>**AlexNet accuracy**: 84.7%</span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="ss">- </span>**Improvement**: A massive 10+ percentage point jump!</span>
<span id="cb12-34"><a href="#cb12-34"></a></span>
<span id="cb12-35"><a href="#cb12-35"></a>This wasn't just an incremental improvement—it was a paradigm shift. Deep learning had arrived, and computer vision would never be the same.</span>
<span id="cb12-36"><a href="#cb12-36"></a></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="fu">## What Makes Deep Learning Different?</span></span>
<span id="cb12-38"><a href="#cb12-38"></a></span>
<span id="cb12-39"><a href="#cb12-39"></a>Let's understand why neural networks succeeded where classical methods struggled:</span>
<span id="cb12-40"><a href="#cb12-40"></a></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="fu">### Classical Approach: Hand-Crafted Features</span></span>
<span id="cb12-42"><a href="#cb12-42"></a><span class="in">```python</span></span>
<span id="cb12-43"><a href="#cb12-43"></a><span class="co"># Classical computer vision pipeline</span></span>
<span id="cb12-44"><a href="#cb12-44"></a><span class="kw">def</span> classical_cat_detector(image):</span>
<span id="cb12-45"><a href="#cb12-45"></a>    <span class="co"># Step 1: Extract hand-crafted features</span></span>
<span id="cb12-46"><a href="#cb12-46"></a>    edges <span class="op">=</span> detect_edges(image)</span>
<span id="cb12-47"><a href="#cb12-47"></a>    corners <span class="op">=</span> detect_corners(image)</span>
<span id="cb12-48"><a href="#cb12-48"></a>    textures <span class="op">=</span> analyze_textures(image)</span>
<span id="cb12-49"><a href="#cb12-49"></a>    </span>
<span id="cb12-50"><a href="#cb12-50"></a>    <span class="co"># Step 2: Combine features with rules</span></span>
<span id="cb12-51"><a href="#cb12-51"></a>    <span class="cf">if</span> (pointy_ears <span class="kw">and</span> whiskers <span class="kw">and</span> fur_texture):</span>
<span id="cb12-52"><a href="#cb12-52"></a>        <span class="cf">return</span> <span class="st">"cat"</span></span>
<span id="cb12-53"><a href="#cb12-53"></a>    <span class="cf">else</span>:</span>
<span id="cb12-54"><a href="#cb12-54"></a>        <span class="cf">return</span> <span class="st">"not_cat"</span></span>
<span id="cb12-55"><a href="#cb12-55"></a><span class="in">```</span></span>
<span id="cb12-56"><a href="#cb12-56"></a></span>
<span id="cb12-57"><a href="#cb12-57"></a>**Problems:**</span>
<span id="cb12-58"><a href="#cb12-58"></a><span class="ss">- </span>Features had to be manually designed</span>
<span id="cb12-59"><a href="#cb12-59"></a><span class="ss">- </span>Rules were brittle and specific</span>
<span id="cb12-60"><a href="#cb12-60"></a><span class="ss">- </span>Couldn't adapt to new variations</span>
<span id="cb12-61"><a href="#cb12-61"></a><span class="ss">- </span>Required domain expertise</span>
<span id="cb12-62"><a href="#cb12-62"></a></span>
<span id="cb12-63"><a href="#cb12-63"></a><span class="fu">### Deep Learning Approach: Learned Features</span></span>
<span id="cb12-64"><a href="#cb12-64"></a><span class="in">```python</span></span>
<span id="cb12-65"><a href="#cb12-65"></a><span class="co"># Deep learning pipeline</span></span>
<span id="cb12-66"><a href="#cb12-66"></a><span class="kw">def</span> deep_cat_detector(image):</span>
<span id="cb12-67"><a href="#cb12-67"></a>    <span class="co"># The network learns its own features!</span></span>
<span id="cb12-68"><a href="#cb12-68"></a>    features <span class="op">=</span> neural_network.extract_features(image)</span>
<span id="cb12-69"><a href="#cb12-69"></a>    prediction <span class="op">=</span> neural_network.classify(features)</span>
<span id="cb12-70"><a href="#cb12-70"></a>    <span class="cf">return</span> prediction</span>
<span id="cb12-71"><a href="#cb12-71"></a><span class="in">```</span></span>
<span id="cb12-72"><a href="#cb12-72"></a></span>
<span id="cb12-73"><a href="#cb12-73"></a>**Advantages:**</span>
<span id="cb12-74"><a href="#cb12-74"></a><span class="ss">- </span>Features are learned automatically</span>
<span id="cb12-75"><a href="#cb12-75"></a><span class="ss">- </span>Adapts to data variations</span>
<span id="cb12-76"><a href="#cb12-76"></a><span class="ss">- </span>Improves with more data</span>
<span id="cb12-77"><a href="#cb12-77"></a><span class="ss">- </span>Works across different domains</span>
<span id="cb12-78"><a href="#cb12-78"></a></span>
<span id="cb12-79"><a href="#cb12-79"></a><span class="fu">## Your First Neural Network</span></span>
<span id="cb12-80"><a href="#cb12-80"></a></span>
<span id="cb12-81"><a href="#cb12-81"></a>Let's build a simple neural network to understand the magic:</span>
<span id="cb12-82"><a href="#cb12-82"></a></span>
<span id="cb12-85"><a href="#cb12-85"></a><span class="in">```{python}</span></span>
<span id="cb12-86"><a href="#cb12-86"></a><span class="co">#| eval: false</span></span>
<span id="cb12-87"><a href="#cb12-87"></a><span class="im">import</span> torch</span>
<span id="cb12-88"><a href="#cb12-88"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb12-89"><a href="#cb12-89"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb12-90"><a href="#cb12-90"></a><span class="im">import</span> torchvision</span>
<span id="cb12-91"><a href="#cb12-91"></a><span class="im">import</span> torchvision.transforms <span class="im">as</span> transforms</span>
<span id="cb12-92"><a href="#cb12-92"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-93"><a href="#cb12-93"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-94"><a href="#cb12-94"></a></span>
<span id="cb12-95"><a href="#cb12-95"></a><span class="co"># Simple neural network for image classification</span></span>
<span id="cb12-96"><a href="#cb12-96"></a><span class="kw">class</span> SimpleNet(nn.Module):</span>
<span id="cb12-97"><a href="#cb12-97"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes<span class="op">=</span><span class="dv">2</span>):  <span class="co"># 2 classes: cat vs dog</span></span>
<span id="cb12-98"><a href="#cb12-98"></a>        <span class="bu">super</span>(SimpleNet, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb12-99"><a href="#cb12-99"></a>        </span>
<span id="cb12-100"><a href="#cb12-100"></a>        <span class="co"># Flatten 224x224x3 image to 150,528 features</span></span>
<span id="cb12-101"><a href="#cb12-101"></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb12-102"><a href="#cb12-102"></a>        </span>
<span id="cb12-103"><a href="#cb12-103"></a>        <span class="co"># Simple fully connected layers</span></span>
<span id="cb12-104"><a href="#cb12-104"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">224</span> <span class="op">*</span> <span class="dv">224</span> <span class="op">*</span> <span class="dv">3</span>, <span class="dv">512</span>)</span>
<span id="cb12-105"><a href="#cb12-105"></a>        <span class="va">self</span>.relu1 <span class="op">=</span> nn.ReLU()</span>
<span id="cb12-106"><a href="#cb12-106"></a>        <span class="va">self</span>.dropout1 <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb12-107"><a href="#cb12-107"></a>        </span>
<span id="cb12-108"><a href="#cb12-108"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">128</span>)</span>
<span id="cb12-109"><a href="#cb12-109"></a>        <span class="va">self</span>.relu2 <span class="op">=</span> nn.ReLU()</span>
<span id="cb12-110"><a href="#cb12-110"></a>        <span class="va">self</span>.dropout2 <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb12-111"><a href="#cb12-111"></a>        </span>
<span id="cb12-112"><a href="#cb12-112"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">128</span>, num_classes)</span>
<span id="cb12-113"><a href="#cb12-113"></a>    </span>
<span id="cb12-114"><a href="#cb12-114"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb12-115"><a href="#cb12-115"></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb12-116"><a href="#cb12-116"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout1(<span class="va">self</span>.relu1(<span class="va">self</span>.fc1(x)))</span>
<span id="cb12-117"><a href="#cb12-117"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout2(<span class="va">self</span>.relu2(<span class="va">self</span>.fc2(x)))</span>
<span id="cb12-118"><a href="#cb12-118"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb12-119"><a href="#cb12-119"></a>        <span class="cf">return</span> x</span>
<span id="cb12-120"><a href="#cb12-120"></a></span>
<span id="cb12-121"><a href="#cb12-121"></a><span class="co"># Create the network</span></span>
<span id="cb12-122"><a href="#cb12-122"></a>simple_net <span class="op">=</span> SimpleNet(num_classes<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-123"><a href="#cb12-123"></a><span class="bu">print</span>(<span class="st">"Simple Neural Network:"</span>)</span>
<span id="cb12-124"><a href="#cb12-124"></a><span class="bu">print</span>(simple_net)</span>
<span id="cb12-125"><a href="#cb12-125"></a></span>
<span id="cb12-126"><a href="#cb12-126"></a><span class="co"># Count parameters</span></span>
<span id="cb12-127"><a href="#cb12-127"></a>total_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> simple_net.parameters())</span>
<span id="cb12-128"><a href="#cb12-128"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb12-129"><a href="#cb12-129"></a><span class="in">```</span></span>
<span id="cb12-130"><a href="#cb12-130"></a></span>
<span id="cb12-131"><a href="#cb12-131"></a>**🎯 Try it yourself!** <span class="co">[</span><span class="ot">Open in Colab</span><span class="co">](https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-06-why-deep-learning.ipynb)</span></span>
<span id="cb12-132"><a href="#cb12-132"></a></span>
<span id="cb12-133"><a href="#cb12-133"></a><span class="fu">## The Convolutional Revolution</span></span>
<span id="cb12-134"><a href="#cb12-134"></a></span>
<span id="cb12-135"><a href="#cb12-135"></a>But wait—there's a problem with our simple network. It treats each pixel independently, ignoring spatial relationships. That's like reading a book by looking at each letter separately!</span>
<span id="cb12-136"><a href="#cb12-136"></a></span>
<span id="cb12-137"><a href="#cb12-137"></a>Enter **Convolutional Neural Networks (CNNs)**—networks designed specifically for images:</span>
<span id="cb12-138"><a href="#cb12-138"></a></span>
<span id="cb12-141"><a href="#cb12-141"></a><span class="in">```{python}</span></span>
<span id="cb12-142"><a href="#cb12-142"></a><span class="co">#| eval: false</span></span>
<span id="cb12-143"><a href="#cb12-143"></a><span class="kw">class</span> ConvNet(nn.Module):</span>
<span id="cb12-144"><a href="#cb12-144"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_classes<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb12-145"><a href="#cb12-145"></a>        <span class="bu">super</span>(ConvNet, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb12-146"><a href="#cb12-146"></a>        </span>
<span id="cb12-147"><a href="#cb12-147"></a>        <span class="co"># Convolutional layers (feature extractors)</span></span>
<span id="cb12-148"><a href="#cb12-148"></a>        <span class="va">self</span>.conv1 <span class="op">=</span> nn.Conv2d(<span class="dv">3</span>, <span class="dv">32</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-149"><a href="#cb12-149"></a>        <span class="va">self</span>.conv2 <span class="op">=</span> nn.Conv2d(<span class="dv">32</span>, <span class="dv">64</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-150"><a href="#cb12-150"></a>        <span class="va">self</span>.conv3 <span class="op">=</span> nn.Conv2d(<span class="dv">64</span>, <span class="dv">128</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-151"><a href="#cb12-151"></a>        </span>
<span id="cb12-152"><a href="#cb12-152"></a>        <span class="co"># Pooling layers (downsampling)</span></span>
<span id="cb12-153"><a href="#cb12-153"></a>        <span class="va">self</span>.pool <span class="op">=</span> nn.MaxPool2d(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb12-154"><a href="#cb12-154"></a>        </span>
<span id="cb12-155"><a href="#cb12-155"></a>        <span class="co"># Fully connected layers (classifier)</span></span>
<span id="cb12-156"><a href="#cb12-156"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">128</span> <span class="op">*</span> <span class="dv">28</span> <span class="op">*</span> <span class="dv">28</span>, <span class="dv">512</span>)  <span class="co"># 224/8 = 28 after 3 pooling layers</span></span>
<span id="cb12-157"><a href="#cb12-157"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, num_classes)</span>
<span id="cb12-158"><a href="#cb12-158"></a>        </span>
<span id="cb12-159"><a href="#cb12-159"></a>        <span class="co"># Activation and regularization</span></span>
<span id="cb12-160"><a href="#cb12-160"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb12-161"><a href="#cb12-161"></a>        <span class="va">self</span>.dropout <span class="op">=</span> nn.Dropout(<span class="fl">0.5</span>)</span>
<span id="cb12-162"><a href="#cb12-162"></a>    </span>
<span id="cb12-163"><a href="#cb12-163"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb12-164"><a href="#cb12-164"></a>        <span class="co"># Feature extraction</span></span>
<span id="cb12-165"><a href="#cb12-165"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv1(x)))  <span class="co"># 224x224 -&gt; 112x112</span></span>
<span id="cb12-166"><a href="#cb12-166"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv2(x)))  <span class="co"># 112x112 -&gt; 56x56</span></span>
<span id="cb12-167"><a href="#cb12-167"></a>        x <span class="op">=</span> <span class="va">self</span>.pool(<span class="va">self</span>.relu(<span class="va">self</span>.conv3(x)))  <span class="co"># 56x56 -&gt; 28x28</span></span>
<span id="cb12-168"><a href="#cb12-168"></a>        </span>
<span id="cb12-169"><a href="#cb12-169"></a>        <span class="co"># Flatten and classify</span></span>
<span id="cb12-170"><a href="#cb12-170"></a>        x <span class="op">=</span> x.view(x.size(<span class="dv">0</span>), <span class="op">-</span><span class="dv">1</span>)  <span class="co"># Flatten</span></span>
<span id="cb12-171"><a href="#cb12-171"></a>        x <span class="op">=</span> <span class="va">self</span>.dropout(<span class="va">self</span>.relu(<span class="va">self</span>.fc1(x)))</span>
<span id="cb12-172"><a href="#cb12-172"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb12-173"><a href="#cb12-173"></a>        </span>
<span id="cb12-174"><a href="#cb12-174"></a>        <span class="cf">return</span> x</span>
<span id="cb12-175"><a href="#cb12-175"></a></span>
<span id="cb12-176"><a href="#cb12-176"></a><span class="co"># Create CNN</span></span>
<span id="cb12-177"><a href="#cb12-177"></a>cnn <span class="op">=</span> ConvNet(num_classes<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-178"><a href="#cb12-178"></a><span class="bu">print</span>(<span class="st">"Convolutional Neural Network:"</span>)</span>
<span id="cb12-179"><a href="#cb12-179"></a><span class="bu">print</span>(cnn)</span>
<span id="cb12-180"><a href="#cb12-180"></a></span>
<span id="cb12-181"><a href="#cb12-181"></a><span class="co"># Count parameters</span></span>
<span id="cb12-182"><a href="#cb12-182"></a>cnn_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> cnn.parameters())</span>
<span id="cb12-183"><a href="#cb12-183"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">CNN parameters: </span><span class="sc">{</span>cnn_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb12-184"><a href="#cb12-184"></a><span class="bu">print</span>(<span class="ss">f"Simple net parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb12-185"><a href="#cb12-185"></a><span class="bu">print</span>(<span class="ss">f"CNN has </span><span class="sc">{</span>(total_params <span class="op">-</span> cnn_params) <span class="op">/</span> total_params <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% fewer parameters!"</span>)</span>
<span id="cb12-186"><a href="#cb12-186"></a><span class="in">```</span></span>
<span id="cb12-187"><a href="#cb12-187"></a></span>
<span id="cb12-188"><a href="#cb12-188"></a><span class="fu">## Understanding Convolutions: The Sliding Window</span></span>
<span id="cb12-189"><a href="#cb12-189"></a></span>
<span id="cb12-190"><a href="#cb12-190"></a>Let's visualize what convolutions actually do:</span>
<span id="cb12-191"><a href="#cb12-191"></a></span>
<span id="cb12-194"><a href="#cb12-194"></a><span class="in">```{python}</span></span>
<span id="cb12-195"><a href="#cb12-195"></a><span class="co">#| eval: false</span></span>
<span id="cb12-196"><a href="#cb12-196"></a><span class="kw">def</span> visualize_convolution():</span>
<span id="cb12-197"><a href="#cb12-197"></a>    <span class="co">"""Show how convolution works"""</span></span>
<span id="cb12-198"><a href="#cb12-198"></a>    <span class="co"># Create a simple image</span></span>
<span id="cb12-199"><a href="#cb12-199"></a>    image <span class="op">=</span> np.array([</span>
<span id="cb12-200"><a href="#cb12-200"></a>        [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb12-201"><a href="#cb12-201"></a>        [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb12-202"><a href="#cb12-202"></a>        [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb12-203"><a href="#cb12-203"></a>        [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb12-204"><a href="#cb12-204"></a>        [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb12-205"><a href="#cb12-205"></a>    ])</span>
<span id="cb12-206"><a href="#cb12-206"></a>    </span>
<span id="cb12-207"><a href="#cb12-207"></a>    <span class="co"># Edge detection kernel</span></span>
<span id="cb12-208"><a href="#cb12-208"></a>    kernel <span class="op">=</span> np.array([</span>
<span id="cb12-209"><a href="#cb12-209"></a>        [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb12-210"><a href="#cb12-210"></a>        [<span class="op">-</span><span class="dv">1</span>,  <span class="dv">8</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb12-211"><a href="#cb12-211"></a>        [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb12-212"><a href="#cb12-212"></a>    ])</span>
<span id="cb12-213"><a href="#cb12-213"></a>    </span>
<span id="cb12-214"><a href="#cb12-214"></a>    <span class="co"># Apply convolution manually</span></span>
<span id="cb12-215"><a href="#cb12-215"></a>    result <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb12-216"><a href="#cb12-216"></a>    </span>
<span id="cb12-217"><a href="#cb12-217"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb12-218"><a href="#cb12-218"></a>    </span>
<span id="cb12-219"><a href="#cb12-219"></a>    <span class="co"># Show original image</span></span>
<span id="cb12-220"><a href="#cb12-220"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb12-221"><a href="#cb12-221"></a>    plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-222"><a href="#cb12-222"></a>    plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb12-223"><a href="#cb12-223"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-224"><a href="#cb12-224"></a>    </span>
<span id="cb12-225"><a href="#cb12-225"></a>    <span class="co"># Show kernel</span></span>
<span id="cb12-226"><a href="#cb12-226"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb12-227"><a href="#cb12-227"></a>    plt.imshow(kernel, cmap<span class="op">=</span><span class="st">'RdBu'</span>)</span>
<span id="cb12-228"><a href="#cb12-228"></a>    plt.title(<span class="st">"Edge Detection Kernel"</span>)</span>
<span id="cb12-229"><a href="#cb12-229"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-230"><a href="#cb12-230"></a>    </span>
<span id="cb12-231"><a href="#cb12-231"></a>    <span class="co"># Show convolution process</span></span>
<span id="cb12-232"><a href="#cb12-232"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb12-233"><a href="#cb12-233"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb12-234"><a href="#cb12-234"></a>            patch <span class="op">=</span> image[i:i<span class="op">+</span><span class="dv">3</span>, j:j<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb12-235"><a href="#cb12-235"></a>            result[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(patch <span class="op">*</span> kernel)</span>
<span id="cb12-236"><a href="#cb12-236"></a>    </span>
<span id="cb12-237"><a href="#cb12-237"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb12-238"><a href="#cb12-238"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-239"><a href="#cb12-239"></a>    plt.title(<span class="st">"Convolution Result"</span>)</span>
<span id="cb12-240"><a href="#cb12-240"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-241"><a href="#cb12-241"></a>    </span>
<span id="cb12-242"><a href="#cb12-242"></a>    <span class="co"># Show using PyTorch</span></span>
<span id="cb12-243"><a href="#cb12-243"></a>    image_tensor <span class="op">=</span> torch.FloatTensor(image).unsqueeze(<span class="dv">0</span>).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb12-244"><a href="#cb12-244"></a>    kernel_tensor <span class="op">=</span> torch.FloatTensor(kernel).unsqueeze(<span class="dv">0</span>).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb12-245"><a href="#cb12-245"></a>    </span>
<span id="cb12-246"><a href="#cb12-246"></a>    conv_layer <span class="op">=</span> nn.Conv2d(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-247"><a href="#cb12-247"></a>    conv_layer.weight.data <span class="op">=</span> kernel_tensor</span>
<span id="cb12-248"><a href="#cb12-248"></a>    </span>
<span id="cb12-249"><a href="#cb12-249"></a>    pytorch_result <span class="op">=</span> conv_layer(image_tensor).squeeze().detach().numpy()</span>
<span id="cb12-250"><a href="#cb12-250"></a>    </span>
<span id="cb12-251"><a href="#cb12-251"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb12-252"><a href="#cb12-252"></a>    plt.imshow(pytorch_result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-253"><a href="#cb12-253"></a>    plt.title(<span class="st">"PyTorch Result"</span>)</span>
<span id="cb12-254"><a href="#cb12-254"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-255"><a href="#cb12-255"></a>    </span>
<span id="cb12-256"><a href="#cb12-256"></a>    plt.tight_layout()</span>
<span id="cb12-257"><a href="#cb12-257"></a>    plt.show()</span>
<span id="cb12-258"><a href="#cb12-258"></a></span>
<span id="cb12-259"><a href="#cb12-259"></a>visualize_convolution()</span>
<span id="cb12-260"><a href="#cb12-260"></a><span class="in">```</span></span>
<span id="cb12-261"><a href="#cb12-261"></a></span>
<span id="cb12-262"><a href="#cb12-262"></a><span class="fu">## Transfer Learning: Standing on Giants' Shoulders</span></span>
<span id="cb12-263"><a href="#cb12-263"></a></span>
<span id="cb12-264"><a href="#cb12-264"></a>Here's the secret that makes deep learning practical: **Transfer Learning**. Instead of training from scratch, we use pre-trained models and adapt them to our needs:</span>
<span id="cb12-265"><a href="#cb12-265"></a></span>
<span id="cb12-268"><a href="#cb12-268"></a><span class="in">```{python}</span></span>
<span id="cb12-269"><a href="#cb12-269"></a><span class="co">#| eval: false</span></span>
<span id="cb12-270"><a href="#cb12-270"></a><span class="im">import</span> torchvision.models <span class="im">as</span> models</span>
<span id="cb12-271"><a href="#cb12-271"></a></span>
<span id="cb12-272"><a href="#cb12-272"></a><span class="co"># Load a pre-trained ResNet model</span></span>
<span id="cb12-273"><a href="#cb12-273"></a>pretrained_model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-274"><a href="#cb12-274"></a><span class="bu">print</span>(<span class="st">"Pre-trained ResNet-18:"</span>)</span>
<span id="cb12-275"><a href="#cb12-275"></a><span class="bu">print</span>(pretrained_model)</span>
<span id="cb12-276"><a href="#cb12-276"></a></span>
<span id="cb12-277"><a href="#cb12-277"></a><span class="co"># Modify for our task (cat vs dog classification)</span></span>
<span id="cb12-278"><a href="#cb12-278"></a>num_classes <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb12-279"><a href="#cb12-279"></a>pretrained_model.fc <span class="op">=</span> nn.Linear(pretrained_model.fc.in_features, num_classes)</span>
<span id="cb12-280"><a href="#cb12-280"></a></span>
<span id="cb12-281"><a href="#cb12-281"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Modified final layer for </span><span class="sc">{</span>num_classes<span class="sc">}</span><span class="ss"> classes"</span>)</span>
<span id="cb12-282"><a href="#cb12-282"></a><span class="bu">print</span>(<span class="ss">f"Final layer: </span><span class="sc">{</span>pretrained_model<span class="sc">.</span>fc<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-283"><a href="#cb12-283"></a></span>
<span id="cb12-284"><a href="#cb12-284"></a><span class="co"># Freeze early layers (optional)</span></span>
<span id="cb12-285"><a href="#cb12-285"></a><span class="cf">for</span> param <span class="kw">in</span> pretrained_model.parameters():</span>
<span id="cb12-286"><a href="#cb12-286"></a>    param.requires_grad <span class="op">=</span> <span class="va">False</span></span>
<span id="cb12-287"><a href="#cb12-287"></a></span>
<span id="cb12-288"><a href="#cb12-288"></a><span class="co"># Only train the final layer</span></span>
<span id="cb12-289"><a href="#cb12-289"></a><span class="cf">for</span> param <span class="kw">in</span> pretrained_model.fc.parameters():</span>
<span id="cb12-290"><a href="#cb12-290"></a>    param.requires_grad <span class="op">=</span> <span class="va">True</span></span>
<span id="cb12-291"><a href="#cb12-291"></a></span>
<span id="cb12-292"><a href="#cb12-292"></a>trainable_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> pretrained_model.parameters() <span class="cf">if</span> p.requires_grad)</span>
<span id="cb12-293"><a href="#cb12-293"></a>total_params <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> pretrained_model.parameters())</span>
<span id="cb12-294"><a href="#cb12-294"></a></span>
<span id="cb12-295"><a href="#cb12-295"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Trainable parameters: </span><span class="sc">{</span>trainable_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb12-296"><a href="#cb12-296"></a><span class="bu">print</span>(<span class="ss">f"Total parameters: </span><span class="sc">{</span>total_params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb12-297"><a href="#cb12-297"></a><span class="bu">print</span>(<span class="ss">f"Training only </span><span class="sc">{</span>trainable_params<span class="op">/</span>total_params<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of parameters!"</span>)</span>
<span id="cb12-298"><a href="#cb12-298"></a><span class="in">```</span></span>
<span id="cb12-299"><a href="#cb12-299"></a></span>
<span id="cb12-300"><a href="#cb12-300"></a><span class="fu">## Your First Image Classifier</span></span>
<span id="cb12-301"><a href="#cb12-301"></a></span>
<span id="cb12-302"><a href="#cb12-302"></a>Let's build a complete image classification system:</span>
<span id="cb12-303"><a href="#cb12-303"></a></span>
<span id="cb12-306"><a href="#cb12-306"></a><span class="in">```{python}</span></span>
<span id="cb12-307"><a href="#cb12-307"></a><span class="co">#| eval: false</span></span>
<span id="cb12-308"><a href="#cb12-308"></a><span class="kw">class</span> ImageClassifier:</span>
<span id="cb12-309"><a href="#cb12-309"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_name<span class="op">=</span><span class="st">'resnet18'</span>, num_classes<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb12-310"><a href="#cb12-310"></a>        <span class="va">self</span>.device <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb12-311"><a href="#cb12-311"></a>        <span class="bu">print</span>(<span class="ss">f"Using device: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>device<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-312"><a href="#cb12-312"></a>        </span>
<span id="cb12-313"><a href="#cb12-313"></a>        <span class="co"># Load pre-trained model</span></span>
<span id="cb12-314"><a href="#cb12-314"></a>        <span class="cf">if</span> model_name <span class="op">==</span> <span class="st">'resnet18'</span>:</span>
<span id="cb12-315"><a href="#cb12-315"></a>            <span class="va">self</span>.model <span class="op">=</span> models.resnet18(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-316"><a href="#cb12-316"></a>            <span class="va">self</span>.model.fc <span class="op">=</span> nn.Linear(<span class="va">self</span>.model.fc.in_features, num_classes)</span>
<span id="cb12-317"><a href="#cb12-317"></a>        </span>
<span id="cb12-318"><a href="#cb12-318"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">self</span>.model.to(<span class="va">self</span>.device)</span>
<span id="cb12-319"><a href="#cb12-319"></a>        </span>
<span id="cb12-320"><a href="#cb12-320"></a>        <span class="co"># Define transforms</span></span>
<span id="cb12-321"><a href="#cb12-321"></a>        <span class="va">self</span>.transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb12-322"><a href="#cb12-322"></a>            transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb12-323"><a href="#cb12-323"></a>            transforms.ToTensor(),</span>
<span id="cb12-324"><a href="#cb12-324"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb12-325"><a href="#cb12-325"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb12-326"><a href="#cb12-326"></a>        ])</span>
<span id="cb12-327"><a href="#cb12-327"></a>        </span>
<span id="cb12-328"><a href="#cb12-328"></a>        <span class="va">self</span>.classes <span class="op">=</span> [<span class="st">'cat'</span>, <span class="st">'dog'</span>]  <span class="co"># Update based on your classes</span></span>
<span id="cb12-329"><a href="#cb12-329"></a>    </span>
<span id="cb12-330"><a href="#cb12-330"></a>    <span class="kw">def</span> predict(<span class="va">self</span>, image):</span>
<span id="cb12-331"><a href="#cb12-331"></a>        <span class="co">"""Predict class of a single image"""</span></span>
<span id="cb12-332"><a href="#cb12-332"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb12-333"><a href="#cb12-333"></a>        </span>
<span id="cb12-334"><a href="#cb12-334"></a>        <span class="co"># Preprocess image</span></span>
<span id="cb12-335"><a href="#cb12-335"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(image, np.ndarray):</span>
<span id="cb12-336"><a href="#cb12-336"></a>            <span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb12-337"><a href="#cb12-337"></a>            image <span class="op">=</span> Image.fromarray(image)</span>
<span id="cb12-338"><a href="#cb12-338"></a>        </span>
<span id="cb12-339"><a href="#cb12-339"></a>        input_tensor <span class="op">=</span> <span class="va">self</span>.transform(image).unsqueeze(<span class="dv">0</span>).to(<span class="va">self</span>.device)</span>
<span id="cb12-340"><a href="#cb12-340"></a>        </span>
<span id="cb12-341"><a href="#cb12-341"></a>        <span class="co"># Make prediction</span></span>
<span id="cb12-342"><a href="#cb12-342"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb12-343"><a href="#cb12-343"></a>            outputs <span class="op">=</span> <span class="va">self</span>.model(input_tensor)</span>
<span id="cb12-344"><a href="#cb12-344"></a>            probabilities <span class="op">=</span> torch.softmax(outputs, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-345"><a href="#cb12-345"></a>            predicted_class <span class="op">=</span> torch.argmax(probabilities, dim<span class="op">=</span><span class="dv">1</span>).item()</span>
<span id="cb12-346"><a href="#cb12-346"></a>            confidence <span class="op">=</span> probabilities[<span class="dv">0</span>][predicted_class].item()</span>
<span id="cb12-347"><a href="#cb12-347"></a>        </span>
<span id="cb12-348"><a href="#cb12-348"></a>        <span class="cf">return</span> {</span>
<span id="cb12-349"><a href="#cb12-349"></a>            <span class="st">'class'</span>: <span class="va">self</span>.classes[predicted_class],</span>
<span id="cb12-350"><a href="#cb12-350"></a>            <span class="st">'confidence'</span>: confidence,</span>
<span id="cb12-351"><a href="#cb12-351"></a>            <span class="st">'probabilities'</span>: probabilities.cpu().numpy()[<span class="dv">0</span>]</span>
<span id="cb12-352"><a href="#cb12-352"></a>        }</span>
<span id="cb12-353"><a href="#cb12-353"></a>    </span>
<span id="cb12-354"><a href="#cb12-354"></a>    <span class="kw">def</span> predict_batch(<span class="va">self</span>, images):</span>
<span id="cb12-355"><a href="#cb12-355"></a>        <span class="co">"""Predict classes for multiple images"""</span></span>
<span id="cb12-356"><a href="#cb12-356"></a>        results <span class="op">=</span> []</span>
<span id="cb12-357"><a href="#cb12-357"></a>        <span class="cf">for</span> image <span class="kw">in</span> images:</span>
<span id="cb12-358"><a href="#cb12-358"></a>            result <span class="op">=</span> <span class="va">self</span>.predict(image)</span>
<span id="cb12-359"><a href="#cb12-359"></a>            results.append(result)</span>
<span id="cb12-360"><a href="#cb12-360"></a>        <span class="cf">return</span> results</span>
<span id="cb12-361"><a href="#cb12-361"></a></span>
<span id="cb12-362"><a href="#cb12-362"></a><span class="co"># Create classifier</span></span>
<span id="cb12-363"><a href="#cb12-363"></a>classifier <span class="op">=</span> ImageClassifier()</span>
<span id="cb12-364"><a href="#cb12-364"></a></span>
<span id="cb12-365"><a href="#cb12-365"></a><span class="co"># Test with a sample image (you would load your own)</span></span>
<span id="cb12-366"><a href="#cb12-366"></a><span class="kw">def</span> test_classifier(image_path):</span>
<span id="cb12-367"><a href="#cb12-367"></a>    <span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb12-368"><a href="#cb12-368"></a>    </span>
<span id="cb12-369"><a href="#cb12-369"></a>    <span class="co"># Load image</span></span>
<span id="cb12-370"><a href="#cb12-370"></a>    image <span class="op">=</span> Image.<span class="bu">open</span>(image_path)</span>
<span id="cb12-371"><a href="#cb12-371"></a>    </span>
<span id="cb12-372"><a href="#cb12-372"></a>    <span class="co"># Make prediction</span></span>
<span id="cb12-373"><a href="#cb12-373"></a>    result <span class="op">=</span> classifier.predict(image)</span>
<span id="cb12-374"><a href="#cb12-374"></a>    </span>
<span id="cb12-375"><a href="#cb12-375"></a>    <span class="co"># Display result</span></span>
<span id="cb12-376"><a href="#cb12-376"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb12-377"><a href="#cb12-377"></a>    </span>
<span id="cb12-378"><a href="#cb12-378"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb12-379"><a href="#cb12-379"></a>    plt.imshow(image)</span>
<span id="cb12-380"><a href="#cb12-380"></a>    plt.title(<span class="ss">f"Input Image"</span>)</span>
<span id="cb12-381"><a href="#cb12-381"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-382"><a href="#cb12-382"></a>    </span>
<span id="cb12-383"><a href="#cb12-383"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb12-384"><a href="#cb12-384"></a>    plt.bar(classifier.classes, result[<span class="st">'probabilities'</span>])</span>
<span id="cb12-385"><a href="#cb12-385"></a>    plt.title(<span class="ss">f"Prediction: </span><span class="sc">{</span>result[<span class="st">'class'</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>result[<span class="st">'confidence'</span>]<span class="sc">:.2f}</span><span class="ss">)"</span>)</span>
<span id="cb12-386"><a href="#cb12-386"></a>    plt.ylabel(<span class="st">"Probability"</span>)</span>
<span id="cb12-387"><a href="#cb12-387"></a>    </span>
<span id="cb12-388"><a href="#cb12-388"></a>    plt.tight_layout()</span>
<span id="cb12-389"><a href="#cb12-389"></a>    plt.show()</span>
<span id="cb12-390"><a href="#cb12-390"></a>    </span>
<span id="cb12-391"><a href="#cb12-391"></a>    <span class="cf">return</span> result</span>
<span id="cb12-392"><a href="#cb12-392"></a></span>
<span id="cb12-393"><a href="#cb12-393"></a><span class="co"># Test the classifier</span></span>
<span id="cb12-394"><a href="#cb12-394"></a><span class="co"># result = test_classifier('your_image.jpg')</span></span>
<span id="cb12-395"><a href="#cb12-395"></a><span class="in">```</span></span>
<span id="cb12-396"><a href="#cb12-396"></a></span>
<span id="cb12-397"><a href="#cb12-397"></a><span class="fu">## Visualizing What Neural Networks Learn</span></span>
<span id="cb12-398"><a href="#cb12-398"></a></span>
<span id="cb12-399"><a href="#cb12-399"></a>One of the coolest things about deep learning is visualizing what the network actually learns:</span>
<span id="cb12-400"><a href="#cb12-400"></a></span>
<span id="cb12-403"><a href="#cb12-403"></a><span class="in">```{python}</span></span>
<span id="cb12-404"><a href="#cb12-404"></a><span class="co">#| eval: false</span></span>
<span id="cb12-405"><a href="#cb12-405"></a><span class="kw">def</span> visualize_filters(model, layer_name<span class="op">=</span><span class="st">'conv1'</span>):</span>
<span id="cb12-406"><a href="#cb12-406"></a>    <span class="co">"""Visualize the filters learned by a convolutional layer"""</span></span>
<span id="cb12-407"><a href="#cb12-407"></a>    </span>
<span id="cb12-408"><a href="#cb12-408"></a>    <span class="co"># Get the layer</span></span>
<span id="cb12-409"><a href="#cb12-409"></a>    layer <span class="op">=</span> <span class="bu">dict</span>(model.named_modules())[layer_name]</span>
<span id="cb12-410"><a href="#cb12-410"></a>    </span>
<span id="cb12-411"><a href="#cb12-411"></a>    <span class="co"># Get the weights</span></span>
<span id="cb12-412"><a href="#cb12-412"></a>    weights <span class="op">=</span> layer.weight.data.cpu()</span>
<span id="cb12-413"><a href="#cb12-413"></a>    </span>
<span id="cb12-414"><a href="#cb12-414"></a>    <span class="co"># Normalize weights for visualization</span></span>
<span id="cb12-415"><a href="#cb12-415"></a>    weights <span class="op">=</span> (weights <span class="op">-</span> weights.<span class="bu">min</span>()) <span class="op">/</span> (weights.<span class="bu">max</span>() <span class="op">-</span> weights.<span class="bu">min</span>())</span>
<span id="cb12-416"><a href="#cb12-416"></a>    </span>
<span id="cb12-417"><a href="#cb12-417"></a>    <span class="co"># Plot filters</span></span>
<span id="cb12-418"><a href="#cb12-418"></a>    num_filters <span class="op">=</span> <span class="bu">min</span>(<span class="dv">16</span>, weights.shape[<span class="dv">0</span>])  <span class="co"># Show first 16 filters</span></span>
<span id="cb12-419"><a href="#cb12-419"></a>    </span>
<span id="cb12-420"><a href="#cb12-420"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb12-421"><a href="#cb12-421"></a>    </span>
<span id="cb12-422"><a href="#cb12-422"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_filters):</span>
<span id="cb12-423"><a href="#cb12-423"></a>        plt.subplot(<span class="dv">4</span>, <span class="dv">4</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb12-424"><a href="#cb12-424"></a>        </span>
<span id="cb12-425"><a href="#cb12-425"></a>        <span class="cf">if</span> weights.shape[<span class="dv">1</span>] <span class="op">==</span> <span class="dv">3</span>:  <span class="co"># RGB filters</span></span>
<span id="cb12-426"><a href="#cb12-426"></a>            <span class="co"># Transpose from (C, H, W) to (H, W, C)</span></span>
<span id="cb12-427"><a href="#cb12-427"></a>            filter_img <span class="op">=</span> weights[i].permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb12-428"><a href="#cb12-428"></a>            plt.imshow(filter_img)</span>
<span id="cb12-429"><a href="#cb12-429"></a>        <span class="cf">else</span>:  <span class="co"># Grayscale filters</span></span>
<span id="cb12-430"><a href="#cb12-430"></a>            plt.imshow(weights[i, <span class="dv">0</span>], cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-431"><a href="#cb12-431"></a>        </span>
<span id="cb12-432"><a href="#cb12-432"></a>        plt.title(<span class="ss">f"Filter </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-433"><a href="#cb12-433"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-434"><a href="#cb12-434"></a>    </span>
<span id="cb12-435"><a href="#cb12-435"></a>    plt.suptitle(<span class="ss">f"Learned Filters in </span><span class="sc">{</span>layer_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-436"><a href="#cb12-436"></a>    plt.tight_layout()</span>
<span id="cb12-437"><a href="#cb12-437"></a>    plt.show()</span>
<span id="cb12-438"><a href="#cb12-438"></a></span>
<span id="cb12-439"><a href="#cb12-439"></a><span class="co"># Visualize filters from our pre-trained model</span></span>
<span id="cb12-440"><a href="#cb12-440"></a>visualize_filters(pretrained_model, <span class="st">'conv1'</span>)</span>
<span id="cb12-441"><a href="#cb12-441"></a><span class="in">```</span></span>
<span id="cb12-442"><a href="#cb12-442"></a></span>
<span id="cb12-443"><a href="#cb12-443"></a><span class="fu">## Feature Maps: Seeing Through the Network's Eyes</span></span>
<span id="cb12-444"><a href="#cb12-444"></a></span>
<span id="cb12-447"><a href="#cb12-447"></a><span class="in">```{python}</span></span>
<span id="cb12-448"><a href="#cb12-448"></a><span class="co">#| eval: false</span></span>
<span id="cb12-449"><a href="#cb12-449"></a><span class="kw">def</span> visualize_feature_maps(model, image, layer_name<span class="op">=</span><span class="st">'layer1'</span>):</span>
<span id="cb12-450"><a href="#cb12-450"></a>    <span class="co">"""Visualize feature maps from a specific layer"""</span></span>
<span id="cb12-451"><a href="#cb12-451"></a>    </span>
<span id="cb12-452"><a href="#cb12-452"></a>    <span class="co"># Hook to capture feature maps</span></span>
<span id="cb12-453"><a href="#cb12-453"></a>    feature_maps <span class="op">=</span> []</span>
<span id="cb12-454"><a href="#cb12-454"></a>    </span>
<span id="cb12-455"><a href="#cb12-455"></a>    <span class="kw">def</span> hook_fn(module, <span class="bu">input</span>, output):</span>
<span id="cb12-456"><a href="#cb12-456"></a>        feature_maps.append(output.cpu())</span>
<span id="cb12-457"><a href="#cb12-457"></a>    </span>
<span id="cb12-458"><a href="#cb12-458"></a>    <span class="co"># Register hook</span></span>
<span id="cb12-459"><a href="#cb12-459"></a>    layer <span class="op">=</span> <span class="bu">dict</span>(model.named_modules())[layer_name]</span>
<span id="cb12-460"><a href="#cb12-460"></a>    hook <span class="op">=</span> layer.register_forward_hook(hook_fn)</span>
<span id="cb12-461"><a href="#cb12-461"></a>    </span>
<span id="cb12-462"><a href="#cb12-462"></a>    <span class="co"># Forward pass</span></span>
<span id="cb12-463"><a href="#cb12-463"></a>    model.<span class="bu">eval</span>()</span>
<span id="cb12-464"><a href="#cb12-464"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb12-465"><a href="#cb12-465"></a>        _ <span class="op">=</span> model(image.unsqueeze(<span class="dv">0</span>))</span>
<span id="cb12-466"><a href="#cb12-466"></a>    </span>
<span id="cb12-467"><a href="#cb12-467"></a>    <span class="co"># Remove hook</span></span>
<span id="cb12-468"><a href="#cb12-468"></a>    hook.remove()</span>
<span id="cb12-469"><a href="#cb12-469"></a>    </span>
<span id="cb12-470"><a href="#cb12-470"></a>    <span class="co"># Get feature maps</span></span>
<span id="cb12-471"><a href="#cb12-471"></a>    fmaps <span class="op">=</span> feature_maps[<span class="dv">0</span>].squeeze(<span class="dv">0</span>)  <span class="co"># Remove batch dimension</span></span>
<span id="cb12-472"><a href="#cb12-472"></a>    </span>
<span id="cb12-473"><a href="#cb12-473"></a>    <span class="co"># Plot feature maps</span></span>
<span id="cb12-474"><a href="#cb12-474"></a>    num_maps <span class="op">=</span> <span class="bu">min</span>(<span class="dv">16</span>, fmaps.shape[<span class="dv">0</span>])</span>
<span id="cb12-475"><a href="#cb12-475"></a>    </span>
<span id="cb12-476"><a href="#cb12-476"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb12-477"><a href="#cb12-477"></a>    </span>
<span id="cb12-478"><a href="#cb12-478"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_maps):</span>
<span id="cb12-479"><a href="#cb12-479"></a>        plt.subplot(<span class="dv">4</span>, <span class="dv">4</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb12-480"><a href="#cb12-480"></a>        plt.imshow(fmaps[i], cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb12-481"><a href="#cb12-481"></a>        plt.title(<span class="ss">f"Feature Map </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-482"><a href="#cb12-482"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-483"><a href="#cb12-483"></a>    </span>
<span id="cb12-484"><a href="#cb12-484"></a>    plt.suptitle(<span class="ss">f"Feature Maps from </span><span class="sc">{</span>layer_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-485"><a href="#cb12-485"></a>    plt.tight_layout()</span>
<span id="cb12-486"><a href="#cb12-486"></a>    plt.show()</span>
<span id="cb12-487"><a href="#cb12-487"></a></span>
<span id="cb12-488"><a href="#cb12-488"></a><span class="co"># Create a sample input</span></span>
<span id="cb12-489"><a href="#cb12-489"></a>sample_input <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">224</span>, <span class="dv">224</span>)</span>
<span id="cb12-490"><a href="#cb12-490"></a>visualize_feature_maps(pretrained_model, sample_input)</span>
<span id="cb12-491"><a href="#cb12-491"></a><span class="in">```</span></span>
<span id="cb12-492"><a href="#cb12-492"></a></span>
<span id="cb12-493"><a href="#cb12-493"></a><span class="fu">## The Deep Learning Advantage: Why It Works</span></span>
<span id="cb12-494"><a href="#cb12-494"></a></span>
<span id="cb12-495"><a href="#cb12-495"></a>Let's compare classical vs deep learning approaches on a real problem:</span>
<span id="cb12-496"><a href="#cb12-496"></a></span>
<span id="cb12-499"><a href="#cb12-499"></a><span class="in">```{python}</span></span>
<span id="cb12-500"><a href="#cb12-500"></a><span class="co">#| eval: false</span></span>
<span id="cb12-501"><a href="#cb12-501"></a><span class="kw">def</span> compare_approaches(image):</span>
<span id="cb12-502"><a href="#cb12-502"></a>    <span class="co">"""Compare classical and deep learning approaches"""</span></span>
<span id="cb12-503"><a href="#cb12-503"></a>    </span>
<span id="cb12-504"><a href="#cb12-504"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb12-505"><a href="#cb12-505"></a>    </span>
<span id="cb12-506"><a href="#cb12-506"></a>    <span class="co"># Original image</span></span>
<span id="cb12-507"><a href="#cb12-507"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb12-508"><a href="#cb12-508"></a>    plt.imshow(image)</span>
<span id="cb12-509"><a href="#cb12-509"></a>    plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb12-510"><a href="#cb12-510"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-511"><a href="#cb12-511"></a>    </span>
<span id="cb12-512"><a href="#cb12-512"></a>    <span class="co"># Classical approach: hand-crafted features</span></span>
<span id="cb12-513"><a href="#cb12-513"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb12-514"><a href="#cb12-514"></a>    </span>
<span id="cb12-515"><a href="#cb12-515"></a>    <span class="co"># Edge features</span></span>
<span id="cb12-516"><a href="#cb12-516"></a>    edges <span class="op">=</span> cv2.Canny(gray, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb12-517"><a href="#cb12-517"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb12-518"><a href="#cb12-518"></a>    plt.imshow(edges, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-519"><a href="#cb12-519"></a>    plt.title(<span class="st">"Classical: Edge Features"</span>)</span>
<span id="cb12-520"><a href="#cb12-520"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-521"><a href="#cb12-521"></a>    </span>
<span id="cb12-522"><a href="#cb12-522"></a>    <span class="co"># Texture features (using LBP-like approach)</span></span>
<span id="cb12-523"><a href="#cb12-523"></a>    <span class="im">from</span> skimage.feature <span class="im">import</span> local_binary_pattern</span>
<span id="cb12-524"><a href="#cb12-524"></a>    lbp <span class="op">=</span> local_binary_pattern(gray, <span class="dv">24</span>, <span class="dv">8</span>, method<span class="op">=</span><span class="st">'uniform'</span>)</span>
<span id="cb12-525"><a href="#cb12-525"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb12-526"><a href="#cb12-526"></a>    plt.imshow(lbp, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb12-527"><a href="#cb12-527"></a>    plt.title(<span class="st">"Classical: Texture Features"</span>)</span>
<span id="cb12-528"><a href="#cb12-528"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-529"><a href="#cb12-529"></a>    </span>
<span id="cb12-530"><a href="#cb12-530"></a>    <span class="co"># Deep learning approach: learned features</span></span>
<span id="cb12-531"><a href="#cb12-531"></a>    <span class="co"># Transform image for the model</span></span>
<span id="cb12-532"><a href="#cb12-532"></a>    transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb12-533"><a href="#cb12-533"></a>        transforms.ToPILImage(),</span>
<span id="cb12-534"><a href="#cb12-534"></a>        transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb12-535"><a href="#cb12-535"></a>        transforms.ToTensor(),</span>
<span id="cb12-536"><a href="#cb12-536"></a>        transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb12-537"><a href="#cb12-537"></a>                           std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb12-538"><a href="#cb12-538"></a>    ])</span>
<span id="cb12-539"><a href="#cb12-539"></a>    </span>
<span id="cb12-540"><a href="#cb12-540"></a>    input_tensor <span class="op">=</span> transform(image).unsqueeze(<span class="dv">0</span>)</span>
<span id="cb12-541"><a href="#cb12-541"></a>    </span>
<span id="cb12-542"><a href="#cb12-542"></a>    <span class="co"># Get feature maps from different layers</span></span>
<span id="cb12-543"><a href="#cb12-543"></a>    feature_maps <span class="op">=</span> []</span>
<span id="cb12-544"><a href="#cb12-544"></a>    </span>
<span id="cb12-545"><a href="#cb12-545"></a>    <span class="kw">def</span> get_features(name):</span>
<span id="cb12-546"><a href="#cb12-546"></a>        <span class="kw">def</span> hook(model, <span class="bu">input</span>, output):</span>
<span id="cb12-547"><a href="#cb12-547"></a>            feature_maps.append((name, output.cpu()))</span>
<span id="cb12-548"><a href="#cb12-548"></a>        <span class="cf">return</span> hook</span>
<span id="cb12-549"><a href="#cb12-549"></a>    </span>
<span id="cb12-550"><a href="#cb12-550"></a>    <span class="co"># Register hooks</span></span>
<span id="cb12-551"><a href="#cb12-551"></a>    pretrained_model.layer1.register_forward_hook(get_features(<span class="st">'Low-level'</span>))</span>
<span id="cb12-552"><a href="#cb12-552"></a>    pretrained_model.layer3.register_forward_hook(get_features(<span class="st">'Mid-level'</span>))</span>
<span id="cb12-553"><a href="#cb12-553"></a>    pretrained_model.layer4.register_forward_hook(get_features(<span class="st">'High-level'</span>))</span>
<span id="cb12-554"><a href="#cb12-554"></a>    </span>
<span id="cb12-555"><a href="#cb12-555"></a>    <span class="co"># Forward pass</span></span>
<span id="cb12-556"><a href="#cb12-556"></a>    pretrained_model.<span class="bu">eval</span>()</span>
<span id="cb12-557"><a href="#cb12-557"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb12-558"><a href="#cb12-558"></a>        _ <span class="op">=</span> pretrained_model(input_tensor)</span>
<span id="cb12-559"><a href="#cb12-559"></a>    </span>
<span id="cb12-560"><a href="#cb12-560"></a>    <span class="co"># Visualize learned features</span></span>
<span id="cb12-561"><a href="#cb12-561"></a>    <span class="cf">for</span> i, (name, fmaps) <span class="kw">in</span> <span class="bu">enumerate</span>(feature_maps):</span>
<span id="cb12-562"><a href="#cb12-562"></a>        plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">+</span> i)</span>
<span id="cb12-563"><a href="#cb12-563"></a>        <span class="co"># Average across channels for visualization</span></span>
<span id="cb12-564"><a href="#cb12-564"></a>        avg_fmap <span class="op">=</span> torch.mean(fmaps.squeeze(<span class="dv">0</span>), dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-565"><a href="#cb12-565"></a>        plt.imshow(avg_fmap, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb12-566"><a href="#cb12-566"></a>        plt.title(<span class="ss">f"Deep Learning: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Features"</span>)</span>
<span id="cb12-567"><a href="#cb12-567"></a>        plt.axis(<span class="st">'off'</span>)</span>
<span id="cb12-568"><a href="#cb12-568"></a>    </span>
<span id="cb12-569"><a href="#cb12-569"></a>    plt.tight_layout()</span>
<span id="cb12-570"><a href="#cb12-570"></a>    plt.show()</span>
<span id="cb12-571"><a href="#cb12-571"></a></span>
<span id="cb12-572"><a href="#cb12-572"></a><span class="co"># Compare approaches (you would use your own image)</span></span>
<span id="cb12-573"><a href="#cb12-573"></a><span class="co"># compare_approaches(your_image)</span></span>
<span id="cb12-574"><a href="#cb12-574"></a><span class="in">```</span></span>
<span id="cb12-575"><a href="#cb12-575"></a></span>
<span id="cb12-576"><a href="#cb12-576"></a><span class="fu">## Why Deep Learning Won</span></span>
<span id="cb12-577"><a href="#cb12-577"></a></span>
<span id="cb12-578"><a href="#cb12-578"></a>Here's why deep learning revolutionized computer vision:</span>
<span id="cb12-579"><a href="#cb12-579"></a></span>
<span id="cb12-580"><a href="#cb12-580"></a><span class="fu">### 1. **Automatic Feature Learning**</span></span>
<span id="cb12-581"><a href="#cb12-581"></a><span class="ss">- </span>No need to hand-craft features</span>
<span id="cb12-582"><a href="#cb12-582"></a><span class="ss">- </span>Learns optimal representations for the task</span>
<span id="cb12-583"><a href="#cb12-583"></a><span class="ss">- </span>Adapts to data variations</span>
<span id="cb12-584"><a href="#cb12-584"></a></span>
<span id="cb12-585"><a href="#cb12-585"></a><span class="fu">### 2. **Hierarchical Representations**</span></span>
<span id="cb12-586"><a href="#cb12-586"></a><span class="ss">- </span>Low-level features (edges, textures)</span>
<span id="cb12-587"><a href="#cb12-587"></a><span class="ss">- </span>Mid-level features (parts, patterns)  </span>
<span id="cb12-588"><a href="#cb12-588"></a><span class="ss">- </span>High-level features (objects, concepts)</span>
<span id="cb12-589"><a href="#cb12-589"></a></span>
<span id="cb12-590"><a href="#cb12-590"></a><span class="fu">### 3. **End-to-End Learning**</span></span>
<span id="cb12-591"><a href="#cb12-591"></a><span class="ss">- </span>Optimizes entire pipeline together</span>
<span id="cb12-592"><a href="#cb12-592"></a><span class="ss">- </span>Features and classifier learned jointly</span>
<span id="cb12-593"><a href="#cb12-593"></a><span class="ss">- </span>Better overall performance</span>
<span id="cb12-594"><a href="#cb12-594"></a></span>
<span id="cb12-595"><a href="#cb12-595"></a><span class="fu">### 4. **Scalability**</span></span>
<span id="cb12-596"><a href="#cb12-596"></a><span class="ss">- </span>Performance improves with more data</span>
<span id="cb12-597"><a href="#cb12-597"></a><span class="ss">- </span>Can handle complex, real-world variations</span>
<span id="cb12-598"><a href="#cb12-598"></a><span class="ss">- </span>Generalizes across domains</span>
<span id="cb12-599"><a href="#cb12-599"></a></span>
<span id="cb12-600"><a href="#cb12-600"></a><span class="fu">## The Modern Deep Learning Pipeline</span></span>
<span id="cb12-601"><a href="#cb12-601"></a></span>
<span id="cb12-604"><a href="#cb12-604"></a><span class="in">```{python}</span></span>
<span id="cb12-605"><a href="#cb12-605"></a><span class="co">#| eval: false</span></span>
<span id="cb12-606"><a href="#cb12-606"></a><span class="kw">class</span> ModernVisionPipeline:</span>
<span id="cb12-607"><a href="#cb12-607"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb12-608"><a href="#cb12-608"></a>        <span class="va">self</span>.device <span class="op">=</span> torch.device(<span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span>)</span>
<span id="cb12-609"><a href="#cb12-609"></a>        </span>
<span id="cb12-610"><a href="#cb12-610"></a>        <span class="co"># 1. Data preprocessing</span></span>
<span id="cb12-611"><a href="#cb12-611"></a>        <span class="va">self</span>.transform <span class="op">=</span> transforms.Compose([</span>
<span id="cb12-612"><a href="#cb12-612"></a>            transforms.Resize((<span class="dv">224</span>, <span class="dv">224</span>)),</span>
<span id="cb12-613"><a href="#cb12-613"></a>            transforms.RandomHorizontalFlip(p<span class="op">=</span><span class="fl">0.5</span>),  <span class="co"># Data augmentation</span></span>
<span id="cb12-614"><a href="#cb12-614"></a>            transforms.RandomRotation(<span class="dv">10</span>),</span>
<span id="cb12-615"><a href="#cb12-615"></a>            transforms.ColorJitter(brightness<span class="op">=</span><span class="fl">0.2</span>, contrast<span class="op">=</span><span class="fl">0.2</span>),</span>
<span id="cb12-616"><a href="#cb12-616"></a>            transforms.ToTensor(),</span>
<span id="cb12-617"><a href="#cb12-617"></a>            transforms.Normalize(mean<span class="op">=</span>[<span class="fl">0.485</span>, <span class="fl">0.456</span>, <span class="fl">0.406</span>], </span>
<span id="cb12-618"><a href="#cb12-618"></a>                               std<span class="op">=</span>[<span class="fl">0.229</span>, <span class="fl">0.224</span>, <span class="fl">0.225</span>])</span>
<span id="cb12-619"><a href="#cb12-619"></a>        ])</span>
<span id="cb12-620"><a href="#cb12-620"></a>        </span>
<span id="cb12-621"><a href="#cb12-621"></a>        <span class="co"># 2. Model architecture</span></span>
<span id="cb12-622"><a href="#cb12-622"></a>        <span class="va">self</span>.model <span class="op">=</span> models.resnet50(pretrained<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-623"><a href="#cb12-623"></a>        </span>
<span id="cb12-624"><a href="#cb12-624"></a>        <span class="co"># 3. Transfer learning setup</span></span>
<span id="cb12-625"><a href="#cb12-625"></a>        <span class="co"># Freeze early layers</span></span>
<span id="cb12-626"><a href="#cb12-626"></a>        <span class="cf">for</span> param <span class="kw">in</span> <span class="bu">list</span>(<span class="va">self</span>.model.parameters())[:<span class="op">-</span><span class="dv">10</span>]:</span>
<span id="cb12-627"><a href="#cb12-627"></a>            param.requires_grad <span class="op">=</span> <span class="va">False</span></span>
<span id="cb12-628"><a href="#cb12-628"></a>        </span>
<span id="cb12-629"><a href="#cb12-629"></a>        <span class="co"># 4. Optimizer and loss</span></span>
<span id="cb12-630"><a href="#cb12-630"></a>        <span class="va">self</span>.optimizer <span class="op">=</span> optim.Adam(</span>
<span id="cb12-631"><a href="#cb12-631"></a>            <span class="bu">filter</span>(<span class="kw">lambda</span> p: p.requires_grad, <span class="va">self</span>.model.parameters()),</span>
<span id="cb12-632"><a href="#cb12-632"></a>            lr<span class="op">=</span><span class="fl">0.001</span></span>
<span id="cb12-633"><a href="#cb12-633"></a>        )</span>
<span id="cb12-634"><a href="#cb12-634"></a>        <span class="va">self</span>.criterion <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb12-635"><a href="#cb12-635"></a>    </span>
<span id="cb12-636"><a href="#cb12-636"></a>    <span class="kw">def</span> train_step(<span class="va">self</span>, images, labels):</span>
<span id="cb12-637"><a href="#cb12-637"></a>        <span class="co">"""Single training step"""</span></span>
<span id="cb12-638"><a href="#cb12-638"></a>        <span class="va">self</span>.model.train()</span>
<span id="cb12-639"><a href="#cb12-639"></a>        </span>
<span id="cb12-640"><a href="#cb12-640"></a>        <span class="co"># Forward pass</span></span>
<span id="cb12-641"><a href="#cb12-641"></a>        outputs <span class="op">=</span> <span class="va">self</span>.model(images)</span>
<span id="cb12-642"><a href="#cb12-642"></a>        loss <span class="op">=</span> <span class="va">self</span>.criterion(outputs, labels)</span>
<span id="cb12-643"><a href="#cb12-643"></a>        </span>
<span id="cb12-644"><a href="#cb12-644"></a>        <span class="co"># Backward pass</span></span>
<span id="cb12-645"><a href="#cb12-645"></a>        <span class="va">self</span>.optimizer.zero_grad()</span>
<span id="cb12-646"><a href="#cb12-646"></a>        loss.backward()</span>
<span id="cb12-647"><a href="#cb12-647"></a>        <span class="va">self</span>.optimizer.step()</span>
<span id="cb12-648"><a href="#cb12-648"></a>        </span>
<span id="cb12-649"><a href="#cb12-649"></a>        <span class="cf">return</span> loss.item()</span>
<span id="cb12-650"><a href="#cb12-650"></a>    </span>
<span id="cb12-651"><a href="#cb12-651"></a>    <span class="kw">def</span> evaluate(<span class="va">self</span>, images, labels):</span>
<span id="cb12-652"><a href="#cb12-652"></a>        <span class="co">"""Evaluation step"""</span></span>
<span id="cb12-653"><a href="#cb12-653"></a>        <span class="va">self</span>.model.<span class="bu">eval</span>()</span>
<span id="cb12-654"><a href="#cb12-654"></a>        </span>
<span id="cb12-655"><a href="#cb12-655"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb12-656"><a href="#cb12-656"></a>            outputs <span class="op">=</span> <span class="va">self</span>.model(images)</span>
<span id="cb12-657"><a href="#cb12-657"></a>            _, predicted <span class="op">=</span> torch.<span class="bu">max</span>(outputs, <span class="dv">1</span>)</span>
<span id="cb12-658"><a href="#cb12-658"></a>            accuracy <span class="op">=</span> (predicted <span class="op">==</span> labels).<span class="bu">float</span>().mean()</span>
<span id="cb12-659"><a href="#cb12-659"></a>        </span>
<span id="cb12-660"><a href="#cb12-660"></a>        <span class="cf">return</span> accuracy.item()</span>
<span id="cb12-661"><a href="#cb12-661"></a></span>
<span id="cb12-662"><a href="#cb12-662"></a><span class="co"># Create modern pipeline</span></span>
<span id="cb12-663"><a href="#cb12-663"></a>pipeline <span class="op">=</span> ModernVisionPipeline()</span>
<span id="cb12-664"><a href="#cb12-664"></a><span class="bu">print</span>(<span class="st">"Modern deep learning pipeline ready!"</span>)</span>
<span id="cb12-665"><a href="#cb12-665"></a><span class="in">```</span></span>
<span id="cb12-666"><a href="#cb12-666"></a></span>
<span id="cb12-667"><a href="#cb12-667"></a><span class="fu">## What's Coming Next?</span></span>
<span id="cb12-668"><a href="#cb12-668"></a></span>
<span id="cb12-669"><a href="#cb12-669"></a>In our next post, <span class="co">[</span><span class="ot">**"Modern Vision Models: CNNs, Vision Transformers, and DINOv2"**</span><span class="co">](../07-modern-vision-models/)</span>, we'll explore:</span>
<span id="cb12-670"><a href="#cb12-670"></a></span>
<span id="cb12-671"><a href="#cb12-671"></a><span class="ss">- </span>**State-of-the-art architectures** (ResNet, EfficientNet, Vision Transformers)</span>
<span id="cb12-672"><a href="#cb12-672"></a><span class="ss">- </span>**Foundation models** like DINOv2</span>
<span id="cb12-673"><a href="#cb12-673"></a><span class="ss">- </span>**Self-supervised learning** (learning without labels)</span>
<span id="cb12-674"><a href="#cb12-674"></a><span class="ss">- </span>**Building your own DINOv2 feature extractor**</span>
<span id="cb12-675"><a href="#cb12-675"></a></span>
<span id="cb12-676"><a href="#cb12-676"></a>You've just learned why deep learning revolutionized computer vision—next, we'll explore the cutting-edge models that are shaping the future!</span>
<span id="cb12-677"><a href="#cb12-677"></a></span>
<span id="cb12-678"><a href="#cb12-678"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb12-679"><a href="#cb12-679"></a></span>
<span id="cb12-680"><a href="#cb12-680"></a><span class="ss">- </span>**Classical methods hit a wall** with complex real-world variations</span>
<span id="cb12-681"><a href="#cb12-681"></a><span class="ss">- </span>**Deep learning learns features automatically** instead of hand-crafting them</span>
<span id="cb12-682"><a href="#cb12-682"></a><span class="ss">- </span>**CNNs are designed for images** with spatial understanding</span>
<span id="cb12-683"><a href="#cb12-683"></a><span class="ss">- </span>**Transfer learning** makes deep learning practical for everyone</span>
<span id="cb12-684"><a href="#cb12-684"></a><span class="ss">- </span>**Hierarchical features** enable understanding at multiple levels</span>
<span id="cb12-685"><a href="#cb12-685"></a><span class="ss">- </span>**Modern pipelines** combine data augmentation, pre-training, and fine-tuning</span>
<span id="cb12-686"><a href="#cb12-686"></a></span>
<span id="cb12-687"><a href="#cb12-687"></a>:::{.callout-tip}</span>
<span id="cb12-688"><a href="#cb12-688"></a><span class="fu">## Hands-On Lab</span></span>
<span id="cb12-689"><a href="#cb12-689"></a>Ready to build your first deep learning classifier? Try the complete interactive notebook: <span class="co">[</span><span class="ot">**Deep Learning Basics Lab**</span><span class="co">](https://colab.research.google.com/drive/1Deep_Learning_Basics_123456)</span></span>
<span id="cb12-690"><a href="#cb12-690"></a></span>
<span id="cb12-691"><a href="#cb12-691"></a>Train your own cat vs dog classifier and see the power of neural networks!</span>
<span id="cb12-692"><a href="#cb12-692"></a>:::</span>
<span id="cb12-693"><a href="#cb12-693"></a></span>
<span id="cb12-694"><a href="#cb12-694"></a>:::{.callout-note}</span>
<span id="cb12-695"><a href="#cb12-695"></a><span class="fu">## Series Navigation</span></span>
<span id="cb12-696"><a href="#cb12-696"></a><span class="ss">- </span>**Previous**: <span class="co">[</span><span class="ot">Feature Magic: What Makes Images Unique</span><span class="co">](../05-feature-magic/)</span></span>
<span id="cb12-697"><a href="#cb12-697"></a><span class="ss">- </span>**Next**: <span class="co">[</span><span class="ot">Modern Vision Models: CNNs, Vision Transformers, and DINOv2</span><span class="co">](../07-modern-vision-models/)</span></span>
<span id="cb12-698"><a href="#cb12-698"></a><span class="ss">- </span>**Series Home**: <span class="co">[</span><span class="ot">Computer Vision Foundations</span><span class="co">](../computer-vision-foundations.qmd)</span></span>
<span id="cb12-699"><a href="#cb12-699"></a>:::</span>
<span id="cb12-700"><a href="#cb12-700"></a></span>
<span id="cb12-701"><a href="#cb12-701"></a>---</span>
<span id="cb12-702"><a href="#cb12-702"></a></span>
<span id="cb12-703"><a href="#cb12-703"></a>*You've just witnessed the deep learning revolution! From struggling with cat vs dog classification to achieving superhuman performance on complex tasks—this is why deep learning changed everything. Next, we'll explore the latest and greatest models that are pushing the boundaries even further.* </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>