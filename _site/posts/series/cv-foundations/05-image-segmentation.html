<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hasan">
<meta name="dcterms.date" content="2025-01-23">

<title>Hasanâ€™s Data Science &amp; AI Blog - Image Segmentation: Dividing and Conquering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Hasanâ€™s Data Science &amp; AI Blog - Image Segmentation: Dividing and Conquering">
<meta property="og:description" content="">
<meta property="og:image" content="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/images/segmentation-header.jpg">
<meta property="og:site-name" content="Hasan's Data Science &amp; AI Blog">
<meta name="twitter:title" content="Hasanâ€™s Data Science &amp; AI Blog - Image Segmentation: Dividing and Conquering">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/images/segmentation-header.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Hasanâ€™s Data Science &amp; AI Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-series" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-series">    
        <li>
    <a class="dropdown-item" href="../../../posts/series/data-science-steps.html" rel="" target="">
 <span class="dropdown-text">Data Science Steps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/computer-vision-foundations.html" rel="" target="">
 <span class="dropdown-text">Computer Vision Foundations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/vlm.html" rel="" target="">
 <span class="dropdown-text">VLM Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/series/anomaly-detection/index.html" rel="" target="">
 <span class="dropdown-text">Anomaly Detection</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../categories.html" rel="" target="">
 <span class="menu-text">Categories</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tags.html" rel="" target="">
 <span class="menu-text">Tags</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HasanGoni" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/hasangoni" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../posts/series/computer-vision-foundations.html">Computer Vision Foundations</a></li><li class="breadcrumb-item"><a href="../../../posts/series/cv-foundations/05-image-segmentation.html">5. Image Segmentation</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Image Segmentation: Dividing and Conquering</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">computer-vision</div>
                <div class="quarto-category">segmentation</div>
                <div class="quarto-category">morphology</div>
                <div class="quarto-category">thresholding</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hasan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 23, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">June 28, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/data-science-steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/data-science-steps-to-follow-part06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science Steps to Follow - 06</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Computer Vision Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/computer-vision-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computer Vision Foundations Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/01-why-computer-vision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Why Computer Vision?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/02-images-as-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Images as Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/03-opencv-essentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. OpenCV Essentials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/04-finding-patterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Finding Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/05-image-segmentation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">5. Image Segmentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/06-feature-magic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Feature Magic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/07-why-deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Why Deep Learning?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/08-modern-vision-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Modern Vision Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/09-first-cv-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. First CV Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/cv-foundations/10-where-to-go-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Where to Go Next</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Anomaly Detection</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/anomaly-detection/finding-the-oddballs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding the Oddballs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">VLM Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../posts/series/vlm-qwen3-14b/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen3-14B</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-art-of-divide-and-conquer" id="toc-the-art-of-divide-and-conquer" class="nav-link active" data-scroll-target="#the-art-of-divide-and-conquer"><span class="header-section-number">0.1</span> The Art of Divide and Conquer</a></li>
  <li><a href="#what-is-image-segmentation" id="toc-what-is-image-segmentation" class="nav-link" data-scroll-target="#what-is-image-segmentation"><span class="header-section-number">0.2</span> What is Image Segmentation?</a></li>
  <li><a href="#technique-1-thresholding---the-foundation" id="toc-technique-1-thresholding---the-foundation" class="nav-link" data-scroll-target="#technique-1-thresholding---the-foundation"><span class="header-section-number">0.3</span> Technique 1: Thresholding - The Foundation</a></li>
  <li><a href="#technique-2-morphological-operations---shape-surgery" id="toc-technique-2-morphological-operations---shape-surgery" class="nav-link" data-scroll-target="#technique-2-morphological-operations---shape-surgery"><span class="header-section-number">0.4</span> Technique 2: Morphological Operations - Shape Surgery</a>
  <ul class="collapse">
  <li><a href="#the-core-operations" id="toc-the-core-operations" class="nav-link" data-scroll-target="#the-core-operations"><span class="header-section-number">0.4.1</span> The Core Operations</a></li>
  <li><a href="#understanding-kernels" id="toc-understanding-kernels" class="nav-link" data-scroll-target="#understanding-kernels"><span class="header-section-number">0.4.2</span> Understanding Kernels</a></li>
  </ul></li>
  <li><a href="#technique-3-watershed-segmentation---flooding-algorithm" id="toc-technique-3-watershed-segmentation---flooding-algorithm" class="nav-link" data-scroll-target="#technique-3-watershed-segmentation---flooding-algorithm"><span class="header-section-number">0.5</span> Technique 3: Watershed Segmentation - Flooding Algorithm</a></li>
  <li><a href="#technique-4-contour-based-segmentation" id="toc-technique-4-contour-based-segmentation" class="nav-link" data-scroll-target="#technique-4-contour-based-segmentation"><span class="header-section-number">0.6</span> Technique 4: Contour-Based Segmentation</a></li>
  <li><a href="#real-world-application-document-cleaning" id="toc-real-world-application-document-cleaning" class="nav-link" data-scroll-target="#real-world-application-document-cleaning"><span class="header-section-number">0.7</span> Real-World Application: Document Cleaning</a></li>
  <li><a href="#segmentation-comparison-tool" id="toc-segmentation-comparison-tool" class="nav-link" data-scroll-target="#segmentation-comparison-tool"><span class="header-section-number">0.8</span> Segmentation Comparison Tool</a></li>
  <li><a href="#your-challenge-medical-image-segmentation" id="toc-your-challenge-medical-image-segmentation" class="nav-link" data-scroll-target="#your-challenge-medical-image-segmentation"><span class="header-section-number">0.9</span> Your Challenge: Medical Image Segmentation</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">0.10</span> Key Takeaways</a></li>
  <li><a href="#whats-coming-next" id="toc-whats-coming-next" class="nav-link" data-scroll-target="#whats-coming-next"><span class="header-section-number">0.11</span> Whatâ€™s Coming Next?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/segmentation-header.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Image segmentation concept - dividing images into meaningful regions</figcaption>
</figure>
</div>
<section id="the-art-of-divide-and-conquer" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="the-art-of-divide-and-conquer"><span class="header-section-number">0.1</span> The Art of Divide and Conquer</h2>
<p>Imagine youâ€™re looking at a crowded photo and trying to identify individual people. Your brain automatically separates the image into distinct regionsâ€”faces, bodies, background objects. This is exactly what <strong>image segmentation</strong> does: it divides an image into meaningful parts that we can analyze separately.</p>
<p>Today, weâ€™ll master the classical techniques that form the foundation of modern computer vision. From simple thresholding to advanced morphological operations, youâ€™ll learn to segment images like a pro!</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Try it yourself!</strong> Open this <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-05-image-segmentation.ipynb">interactive Colab notebook</a> to experiment with segmentation techniques as we build this tutorial.</p>
</div>
</div>
</section>
<section id="what-is-image-segmentation" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="what-is-image-segmentation"><span class="header-section-number">0.2</span> What is Image Segmentation?</h2>
<p><strong>Image segmentation</strong> is the process of partitioning an image into multiple segments or regions. Each segment represents something meaningfulâ€”objects, boundaries, or areas of interest.</p>
<p>Think of it like: - <strong>Coloring book</strong>: Each region gets its own color - <strong>Jigsaw puzzle</strong>: Breaking the image into pieces - <strong>Map making</strong>: Dividing territory into districts</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/segmentation-demo.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Segmentation demonstration with multiple objects</figcaption>
</figure>
</div>
<p>This synthetic image shows perfect segmentation targets: - <strong>Bright objects</strong> on dark background - <strong>Different intensities</strong> for various techniques - <strong>Multiple shapes</strong> to test robustness - <strong>Noise elements</strong> to challenge algorithms</p>
</section>
<section id="technique-1-thresholding---the-foundation" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="technique-1-thresholding---the-foundation"><span class="header-section-number">0.3</span> Technique 1: Thresholding - The Foundation</h2>
<p><strong>Thresholding</strong> is the simplest segmentation technique. It converts grayscale images to binary (black and white) by setting a threshold value.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Load our synthetic segmentation demo image</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>img <span class="op">=</span> cv2.imread(<span class="st">'images/segmentation-demo.jpg'</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>img_rgb <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2RGB)</span>
<span id="cb1-8"><a href="#cb1-8"></a>gray <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Simple thresholding</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">def</span> apply_thresholding(image, threshold_value<span class="op">=</span><span class="dv">127</span>):</span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="co">"""Apply different thresholding techniques"""</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    </span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="co"># Simple binary thresholding</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>    _, binary <span class="op">=</span> cv2.threshold(image, threshold_value, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb1-16"><a href="#cb1-16"></a>    </span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="co"># Adaptive thresholding (handles varying lighting)</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>    adaptive_mean <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb1-19"><a href="#cb1-19"></a>        image, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    )</span>
<span id="cb1-21"><a href="#cb1-21"></a>    </span>
<span id="cb1-22"><a href="#cb1-22"></a>    adaptive_gaussian <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb1-23"><a href="#cb1-23"></a>        image, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25"></a>    </span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="co"># Otsu's thresholding (automatically finds best threshold)</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>    _, otsu <span class="op">=</span> cv2.threshold(image, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb1-28"><a href="#cb1-28"></a>    </span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="cf">return</span> binary, adaptive_mean, adaptive_gaussian, otsu</span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="co"># Apply different thresholding techniques</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>binary, adaptive_mean, adaptive_gaussian, otsu <span class="op">=</span> apply_thresholding(gray)</span>
<span id="cb1-33"><a href="#cb1-33"></a></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="co"># Display results</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">12</span>))</span>
<span id="cb1-36"><a href="#cb1-36"></a></span>
<span id="cb1-37"><a href="#cb1-37"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb1-38"><a href="#cb1-38"></a>plt.imshow(img_rgb)</span>
<span id="cb1-39"><a href="#cb1-39"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb1-40"><a href="#cb1-40"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb1-43"><a href="#cb1-43"></a>plt.imshow(gray, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-44"><a href="#cb1-44"></a>plt.title(<span class="st">"Grayscale"</span>)</span>
<span id="cb1-45"><a href="#cb1-45"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-46"><a href="#cb1-46"></a></span>
<span id="cb1-47"><a href="#cb1-47"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1-48"><a href="#cb1-48"></a>plt.imshow(binary, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-49"><a href="#cb1-49"></a>plt.title(<span class="st">"Binary Thresholding (T=127)"</span>)</span>
<span id="cb1-50"><a href="#cb1-50"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a></span>
<span id="cb1-52"><a href="#cb1-52"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb1-53"><a href="#cb1-53"></a>plt.imshow(adaptive_mean, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-54"><a href="#cb1-54"></a>plt.title(<span class="st">"Adaptive Mean Thresholding"</span>)</span>
<span id="cb1-55"><a href="#cb1-55"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-56"><a href="#cb1-56"></a></span>
<span id="cb1-57"><a href="#cb1-57"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb1-58"><a href="#cb1-58"></a>plt.imshow(adaptive_gaussian, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-59"><a href="#cb1-59"></a>plt.title(<span class="st">"Adaptive Gaussian Thresholding"</span>)</span>
<span id="cb1-60"><a href="#cb1-60"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-61"><a href="#cb1-61"></a></span>
<span id="cb1-62"><a href="#cb1-62"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb1-63"><a href="#cb1-63"></a>plt.imshow(otsu, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb1-64"><a href="#cb1-64"></a>plt.title(<span class="st">"Otsu's Automatic Thresholding"</span>)</span>
<span id="cb1-65"><a href="#cb1-65"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb1-66"><a href="#cb1-66"></a></span>
<span id="cb1-67"><a href="#cb1-67"></a>plt.tight_layout()</span>
<span id="cb1-68"><a href="#cb1-68"></a>plt.show()</span>
<span id="cb1-69"><a href="#cb1-69"></a></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Thresholding Results:"</span>)</span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="bu">print</span>(<span class="ss">f"- Binary: Simple threshold at 127"</span>)</span>
<span id="cb1-72"><a href="#cb1-72"></a><span class="bu">print</span>(<span class="ss">f"- Adaptive Mean: Local neighborhood average"</span>)</span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="bu">print</span>(<span class="ss">f"- Adaptive Gaussian: Weighted neighborhood average"</span>)</span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="bu">print</span>(<span class="ss">f"- Otsu: Automatically found optimal threshold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸŽ¯ Thresholding Results:
- Binary: Simple threshold at 127
- Adaptive Mean: Local neighborhood average
- Adaptive Gaussian: Weighted neighborhood average
- Otsu: Automatically found optimal threshold</code></pre>
</div>
</div>
<p><strong>ðŸ”¥ Amazing!</strong> Each technique handles different scenarios: - <strong>Binary</strong>: Works when lighting is uniform - <strong>Adaptive</strong>: Handles varying lighting conditions - <strong>Otsu</strong>: Automatically finds the best threshold</p>
</section>
<section id="technique-2-morphological-operations---shape-surgery" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="technique-2-morphological-operations---shape-surgery"><span class="header-section-number">0.4</span> Technique 2: Morphological Operations - Shape Surgery</h2>
<p><strong>Morphological operations</strong> are like performing surgery on shapes. They can clean up noise, separate connected objects, or fill gaps.</p>
<section id="the-core-operations" class="level3" data-number="0.4.1">
<h3 data-number="0.4.1" class="anchored" data-anchor-id="the-core-operations"><span class="header-section-number">0.4.1</span> The Core Operations</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Load our morphological demo image (designed for these operations)</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>morph_img <span class="op">=</span> cv2.imread(<span class="st">'images/morphological-demo.jpg'</span>, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">def</span> demonstrate_morphological_operations(image):</span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="co">"""Show the four basic morphological operations"""</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="co"># Define structuring element (kernel)</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">5</span>, <span class="dv">5</span>), np.uint8)</span>
<span id="cb3-9"><a href="#cb3-9"></a>    </span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="co"># Basic operations</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    erosion <span class="op">=</span> cv2.erode(image, kernel, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>    dilation <span class="op">=</span> cv2.dilate(image, kernel, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a>    opening <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_OPEN, kernel)</span>
<span id="cb3-14"><a href="#cb3-14"></a>    closing <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb3-15"><a href="#cb3-15"></a>    </span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="co"># Advanced operations</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>    gradient <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_GRADIENT, kernel)</span>
<span id="cb3-18"><a href="#cb3-18"></a>    tophat <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_TOPHAT, kernel)</span>
<span id="cb3-19"><a href="#cb3-19"></a>    blackhat <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_BLACKHAT, kernel)</span>
<span id="cb3-20"><a href="#cb3-20"></a>    </span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="cf">return</span> erosion, dilation, opening, closing, gradient, tophat, blackhat</span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co"># Apply morphological operations</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>erosion, dilation, opening, closing, gradient, tophat, blackhat <span class="op">=</span> demonstrate_morphological_operations(morph_img)</span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co"># Display results</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a>plt.imshow(morph_img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-31"><a href="#cb3-31"></a>plt.title(<span class="st">"Original (with noise and gaps)"</span>)</span>
<span id="cb3-32"><a href="#cb3-32"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-33"><a href="#cb3-33"></a></span>
<span id="cb3-34"><a href="#cb3-34"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb3-35"><a href="#cb3-35"></a>plt.imshow(erosion, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-36"><a href="#cb3-36"></a>plt.title(<span class="st">"Erosion (shrinks objects)"</span>)</span>
<span id="cb3-37"><a href="#cb3-37"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-38"><a href="#cb3-38"></a></span>
<span id="cb3-39"><a href="#cb3-39"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb3-40"><a href="#cb3-40"></a>plt.imshow(dilation, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-41"><a href="#cb3-41"></a>plt.title(<span class="st">"Dilation (expands objects)"</span>)</span>
<span id="cb3-42"><a href="#cb3-42"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb3-45"><a href="#cb3-45"></a>plt.imshow(opening, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-46"><a href="#cb3-46"></a>plt.title(<span class="st">"Opening (removes noise)"</span>)</span>
<span id="cb3-47"><a href="#cb3-47"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-48"><a href="#cb3-48"></a></span>
<span id="cb3-49"><a href="#cb3-49"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb3-50"><a href="#cb3-50"></a>plt.imshow(closing, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-51"><a href="#cb3-51"></a>plt.title(<span class="st">"Closing (fills gaps)"</span>)</span>
<span id="cb3-52"><a href="#cb3-52"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-53"><a href="#cb3-53"></a></span>
<span id="cb3-54"><a href="#cb3-54"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb3-55"><a href="#cb3-55"></a>plt.imshow(gradient, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-56"><a href="#cb3-56"></a>plt.title(<span class="st">"Gradient (edge detection)"</span>)</span>
<span id="cb3-57"><a href="#cb3-57"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-58"><a href="#cb3-58"></a></span>
<span id="cb3-59"><a href="#cb3-59"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb3-60"><a href="#cb3-60"></a>plt.imshow(tophat, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-61"><a href="#cb3-61"></a>plt.title(<span class="st">"Top Hat (small bright objects)"</span>)</span>
<span id="cb3-62"><a href="#cb3-62"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-63"><a href="#cb3-63"></a></span>
<span id="cb3-64"><a href="#cb3-64"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb3-65"><a href="#cb3-65"></a>plt.imshow(blackhat, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb3-66"><a href="#cb3-66"></a>plt.title(<span class="st">"Black Hat (small dark objects)"</span>)</span>
<span id="cb3-67"><a href="#cb3-67"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-68"><a href="#cb3-68"></a></span>
<span id="cb3-69"><a href="#cb3-69"></a>plt.tight_layout()</span>
<span id="cb3-70"><a href="#cb3-70"></a>plt.show()</span>
<span id="cb3-71"><a href="#cb3-71"></a></span>
<span id="cb3-72"><a href="#cb3-72"></a><span class="bu">print</span>(<span class="st">"ðŸ”§ Morphological Operations Explained:"</span>)</span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="bu">print</span>(<span class="st">"- Erosion: Shrinks white regions (removes noise)"</span>)</span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="bu">print</span>(<span class="st">"- Dilation: Expands white regions (fills small gaps)"</span>)</span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="bu">print</span>(<span class="st">"- Opening: Erosion followed by dilation (removes small noise)"</span>)</span>
<span id="cb3-76"><a href="#cb3-76"></a><span class="bu">print</span>(<span class="st">"- Closing: Dilation followed by erosion (fills gaps in objects)"</span>)</span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="bu">print</span>(<span class="st">"- Gradient: Difference between dilation and erosion (edges)"</span>)</span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="bu">print</span>(<span class="st">"- Top Hat: Original minus opening (small bright features)"</span>)</span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="bu">print</span>(<span class="st">"- Black Hat: Closing minus original (small dark features)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸ”§ Morphological Operations Explained:
- Erosion: Shrinks white regions (removes noise)
- Dilation: Expands white regions (fills small gaps)
- Opening: Erosion followed by dilation (removes small noise)
- Closing: Dilation followed by erosion (fills gaps in objects)
- Gradient: Difference between dilation and erosion (edges)
- Top Hat: Original minus opening (small bright features)
- Black Hat: Closing minus original (small dark features)</code></pre>
</div>
</div>
</section>
<section id="understanding-kernels" class="level3" data-number="0.4.2">
<h3 data-number="0.4.2" class="anchored" data-anchor-id="understanding-kernels"><span class="header-section-number">0.4.2</span> Understanding Kernels</h3>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Different kernel shapes for different effects</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">def</span> show_kernel_effects():</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="co">"""Demonstrate how different kernels affect morphological operations"""</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    </span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="co"># Create different kernels</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    kernels <span class="op">=</span> {</span>
<span id="cb5-7"><a href="#cb5-7"></a>        <span class="st">'Rectangle 3x3'</span>: np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8),</span>
<span id="cb5-8"><a href="#cb5-8"></a>        <span class="st">'Rectangle 7x7'</span>: np.ones((<span class="dv">7</span>, <span class="dv">7</span>), np.uint8),</span>
<span id="cb5-9"><a href="#cb5-9"></a>        <span class="st">'Cross'</span>: cv2.getStructuringElement(cv2.MORPH_CROSS, (<span class="dv">5</span>, <span class="dv">5</span>)),</span>
<span id="cb5-10"><a href="#cb5-10"></a>        <span class="st">'Ellipse'</span>: cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb5-11"><a href="#cb5-11"></a>    }</span>
<span id="cb5-12"><a href="#cb5-12"></a>    </span>
<span id="cb5-13"><a href="#cb5-13"></a>    results <span class="op">=</span> {}</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="cf">for</span> name, kernel <span class="kw">in</span> kernels.items():</span>
<span id="cb5-15"><a href="#cb5-15"></a>        <span class="co"># Apply opening operation with different kernels</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>        result <span class="op">=</span> cv2.morphologyEx(morph_img, cv2.MORPH_OPEN, kernel)</span>
<span id="cb5-17"><a href="#cb5-17"></a>        results[name] <span class="op">=</span> result</span>
<span id="cb5-18"><a href="#cb5-18"></a>    </span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="cf">return</span> kernels, results</span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a>kernels, kernel_results <span class="op">=</span> show_kernel_effects()</span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co"># Visualize kernel effects</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb5-25"><a href="#cb5-25"></a></span>
<span id="cb5-26"><a href="#cb5-26"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb5-27"><a href="#cb5-27"></a>plt.imshow(morph_img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-28"><a href="#cb5-28"></a>plt.title(<span class="st">"Original"</span>)</span>
<span id="cb5-29"><a href="#cb5-29"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-30"><a href="#cb5-30"></a></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(kernel_results.items(), <span class="dv">2</span>):</span>
<span id="cb5-32"><a href="#cb5-32"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, i)</span>
<span id="cb5-33"><a href="#cb5-33"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-34"><a href="#cb5-34"></a>    plt.title(<span class="ss">f"Opening with </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-35"><a href="#cb5-35"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="co"># Show the kernels themselves</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="cf">for</span> i, (name, kernel) <span class="kw">in</span> <span class="bu">enumerate</span>(kernels.items(), <span class="dv">6</span>):</span>
<span id="cb5-39"><a href="#cb5-39"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, i)</span>
<span id="cb5-40"><a href="#cb5-40"></a>    plt.imshow(kernel <span class="op">*</span> <span class="dv">255</span>, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb5-41"><a href="#cb5-41"></a>    plt.title(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Kernel"</span>)</span>
<span id="cb5-42"><a href="#cb5-42"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb5-43"><a href="#cb5-43"></a></span>
<span id="cb5-44"><a href="#cb5-44"></a>plt.tight_layout()</span>
<span id="cb5-45"><a href="#cb5-45"></a>plt.show()</span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Kernel Shape Effects:"</span>)</span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="bu">print</span>(<span class="st">"- Rectangle: General-purpose, preserves rectangular features"</span>)</span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="bu">print</span>(<span class="st">"- Cross: Connects horizontal/vertical elements"</span>)</span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="bu">print</span>(<span class="st">"- Ellipse: Preserves circular/curved features"</span>)</span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="bu">print</span>(<span class="st">"- Size matters: Larger kernels = stronger effects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸŽ¯ Kernel Shape Effects:
- Rectangle: General-purpose, preserves rectangular features
- Cross: Connects horizontal/vertical elements
- Ellipse: Preserves circular/curved features
- Size matters: Larger kernels = stronger effects</code></pre>
</div>
</div>
</section>
</section>
<section id="technique-3-watershed-segmentation---flooding-algorithm" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="technique-3-watershed-segmentation---flooding-algorithm"><span class="header-section-number">0.5</span> Technique 3: Watershed Segmentation - Flooding Algorithm</h2>
<p><strong>Watershed segmentation</strong> treats the image like a topographic map and â€œfloodsâ€ it to separate regions. Perfect for separating touching objects!</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">from</span> scipy <span class="im">import</span> ndimage</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="im">from</span> skimage.segmentation <span class="im">import</span> watershed</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw">def</span> watershed_segmentation(image):</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="co">"""Apply watershed segmentation to separate touching objects"""</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    </span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="co"># Convert to grayscale if needed</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb7-9"><a href="#cb7-9"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="cf">else</span>:</span>
<span id="cb7-11"><a href="#cb7-11"></a>        gray <span class="op">=</span> image</span>
<span id="cb7-12"><a href="#cb7-12"></a>    </span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="co"># Apply threshold to get binary image</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb7-15"><a href="#cb7-15"></a>    </span>
<span id="cb7-16"><a href="#cb7-16"></a>    <span class="co"># Remove noise with morphological opening</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8)</span>
<span id="cb7-18"><a href="#cb7-18"></a>    opening <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-19"><a href="#cb7-19"></a>    </span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="co"># Find sure background area</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>    sure_bg <span class="op">=</span> cv2.dilate(opening, kernel, iterations<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb7-22"><a href="#cb7-22"></a>    </span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="co"># Find sure foreground area using distance transform</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>    dist_transform <span class="op">=</span> cv2.distanceTransform(opening, cv2.DIST_L2, <span class="dv">5</span>)</span>
<span id="cb7-25"><a href="#cb7-25"></a>    _, sure_fg <span class="op">=</span> cv2.threshold(dist_transform, <span class="fl">0.7</span> <span class="op">*</span> dist_transform.<span class="bu">max</span>(), <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb7-26"><a href="#cb7-26"></a>    </span>
<span id="cb7-27"><a href="#cb7-27"></a>    <span class="co"># Find unknown region</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>    sure_fg <span class="op">=</span> np.uint8(sure_fg)</span>
<span id="cb7-29"><a href="#cb7-29"></a>    unknown <span class="op">=</span> cv2.subtract(sure_bg, sure_fg)</span>
<span id="cb7-30"><a href="#cb7-30"></a>    </span>
<span id="cb7-31"><a href="#cb7-31"></a>    <span class="co"># Marker labelling</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>    _, markers <span class="op">=</span> cv2.connectedComponents(sure_fg)</span>
<span id="cb7-33"><a href="#cb7-33"></a>    </span>
<span id="cb7-34"><a href="#cb7-34"></a>    <span class="co"># Add one to all labels so that sure background is not 0, but 1</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>    markers <span class="op">=</span> markers <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb7-36"><a href="#cb7-36"></a>    </span>
<span id="cb7-37"><a href="#cb7-37"></a>    <span class="co"># Mark the region of unknown with zero</span></span>
<span id="cb7-38"><a href="#cb7-38"></a>    markers[unknown <span class="op">==</span> <span class="dv">255</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-39"><a href="#cb7-39"></a>    </span>
<span id="cb7-40"><a href="#cb7-40"></a>    <span class="co"># Apply watershed</span></span>
<span id="cb7-41"><a href="#cb7-41"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb7-42"><a href="#cb7-42"></a>        markers <span class="op">=</span> cv2.watershed(image, markers)</span>
<span id="cb7-43"><a href="#cb7-43"></a>        result <span class="op">=</span> image.copy()</span>
<span id="cb7-44"><a href="#cb7-44"></a>        result[markers <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> [<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>]  <span class="co"># Mark boundaries in red</span></span>
<span id="cb7-45"><a href="#cb7-45"></a>    <span class="cf">else</span>:</span>
<span id="cb7-46"><a href="#cb7-46"></a>        <span class="co"># For grayscale, create a color version for visualization</span></span>
<span id="cb7-47"><a href="#cb7-47"></a>        result <span class="op">=</span> cv2.cvtColor(gray, cv2.COLOR_GRAY2RGB)</span>
<span id="cb7-48"><a href="#cb7-48"></a>        markers_watershed <span class="op">=</span> cv2.watershed(result, markers)</span>
<span id="cb7-49"><a href="#cb7-49"></a>        result[markers_watershed <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> [<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb7-50"><a href="#cb7-50"></a>    </span>
<span id="cb7-51"><a href="#cb7-51"></a>    <span class="cf">return</span> binary, sure_bg, sure_fg, unknown, markers, result</span>
<span id="cb7-52"><a href="#cb7-52"></a></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="co"># Apply watershed to our demo image</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>binary, sure_bg, sure_fg, unknown, markers, watershed_result <span class="op">=</span> watershed_segmentation(img_rgb)</span>
<span id="cb7-55"><a href="#cb7-55"></a></span>
<span id="cb7-56"><a href="#cb7-56"></a><span class="co"># Display watershed process</span></span>
<span id="cb7-57"><a href="#cb7-57"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb7-58"><a href="#cb7-58"></a></span>
<span id="cb7-59"><a href="#cb7-59"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb7-60"><a href="#cb7-60"></a>plt.imshow(img_rgb)</span>
<span id="cb7-61"><a href="#cb7-61"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb7-62"><a href="#cb7-62"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-63"><a href="#cb7-63"></a></span>
<span id="cb7-64"><a href="#cb7-64"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb7-65"><a href="#cb7-65"></a>plt.imshow(binary, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-66"><a href="#cb7-66"></a>plt.title(<span class="st">"Binary Threshold"</span>)</span>
<span id="cb7-67"><a href="#cb7-67"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-68"><a href="#cb7-68"></a></span>
<span id="cb7-69"><a href="#cb7-69"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb7-70"><a href="#cb7-70"></a>plt.imshow(sure_bg, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-71"><a href="#cb7-71"></a>plt.title(<span class="st">"Sure Background"</span>)</span>
<span id="cb7-72"><a href="#cb7-72"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-73"><a href="#cb7-73"></a></span>
<span id="cb7-74"><a href="#cb7-74"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb7-75"><a href="#cb7-75"></a>plt.imshow(sure_fg, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-76"><a href="#cb7-76"></a>plt.title(<span class="st">"Sure Foreground"</span>)</span>
<span id="cb7-77"><a href="#cb7-77"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-78"><a href="#cb7-78"></a></span>
<span id="cb7-79"><a href="#cb7-79"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb7-80"><a href="#cb7-80"></a>plt.imshow(unknown, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-81"><a href="#cb7-81"></a>plt.title(<span class="st">"Unknown Region"</span>)</span>
<span id="cb7-82"><a href="#cb7-82"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-83"><a href="#cb7-83"></a></span>
<span id="cb7-84"><a href="#cb7-84"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb7-85"><a href="#cb7-85"></a>plt.imshow(markers, cmap<span class="op">=</span><span class="st">'tab20'</span>)</span>
<span id="cb7-86"><a href="#cb7-86"></a>plt.title(<span class="st">"Markers"</span>)</span>
<span id="cb7-87"><a href="#cb7-87"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-88"><a href="#cb7-88"></a></span>
<span id="cb7-89"><a href="#cb7-89"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb7-90"><a href="#cb7-90"></a>plt.imshow(watershed_result)</span>
<span id="cb7-91"><a href="#cb7-91"></a>plt.title(<span class="st">"Watershed Result"</span>)</span>
<span id="cb7-92"><a href="#cb7-92"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-93"><a href="#cb7-93"></a></span>
<span id="cb7-94"><a href="#cb7-94"></a>plt.tight_layout()</span>
<span id="cb7-95"><a href="#cb7-95"></a>plt.show()</span>
<span id="cb7-96"><a href="#cb7-96"></a></span>
<span id="cb7-97"><a href="#cb7-97"></a><span class="bu">print</span>(<span class="st">"ðŸŒŠ Watershed Segmentation Steps:"</span>)</span>
<span id="cb7-98"><a href="#cb7-98"></a><span class="bu">print</span>(<span class="st">"1. Threshold to get binary image"</span>)</span>
<span id="cb7-99"><a href="#cb7-99"></a><span class="bu">print</span>(<span class="st">"2. Find sure background (dilated objects)"</span>)</span>
<span id="cb7-100"><a href="#cb7-100"></a><span class="bu">print</span>(<span class="st">"3. Find sure foreground (distance transform peaks)"</span>)</span>
<span id="cb7-101"><a href="#cb7-101"></a><span class="bu">print</span>(<span class="st">"4. Mark unknown regions between sure areas"</span>)</span>
<span id="cb7-102"><a href="#cb7-102"></a><span class="bu">print</span>(<span class="st">"5. Apply watershed algorithm to flood from markers"</span>)</span>
<span id="cb7-103"><a href="#cb7-103"></a><span class="bu">print</span>(<span class="st">"6. Red lines show the watershed boundaries!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸŒŠ Watershed Segmentation Steps:
1. Threshold to get binary image
2. Find sure background (dilated objects)
3. Find sure foreground (distance transform peaks)
4. Mark unknown regions between sure areas
5. Apply watershed algorithm to flood from markers
6. Red lines show the watershed boundaries!</code></pre>
</div>
</div>
</section>
<section id="technique-4-contour-based-segmentation" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="technique-4-contour-based-segmentation"><span class="header-section-number">0.6</span> Technique 4: Contour-Based Segmentation</h2>
<p><strong>Contours</strong> are the boundaries of objects. We can use them to segment and analyze individual objects.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> contour_segmentation(image):</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co">"""Find and analyze contours for segmentation"""</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    </span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb9-6"><a href="#cb9-6"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="cf">else</span>:</span>
<span id="cb9-8"><a href="#cb9-8"></a>        gray <span class="op">=</span> image</span>
<span id="cb9-9"><a href="#cb9-9"></a>    </span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="co"># Apply threshold</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    </span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="co"># Find contours</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>    contours, hierarchy <span class="op">=</span> cv2.findContours(binary, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb9-15"><a href="#cb9-15"></a>    </span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="co"># Create result image</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    result <span class="op">=</span> image.copy() <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> cv2.cvtColor(gray, cv2.COLOR_GRAY2RGB)</span>
<span id="cb9-18"><a href="#cb9-18"></a>    </span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="co"># Analyze each contour</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>    contour_info <span class="op">=</span> []</span>
<span id="cb9-21"><a href="#cb9-21"></a>    colors <span class="op">=</span> [(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">255</span>), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>)]</span>
<span id="cb9-22"><a href="#cb9-22"></a>    </span>
<span id="cb9-23"><a href="#cb9-23"></a>    <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb9-24"><a href="#cb9-24"></a>        <span class="co"># Calculate contour properties</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb9-26"><a href="#cb9-26"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a>        </span>
<span id="cb9-28"><a href="#cb9-28"></a>        <span class="co"># Filter small contours (noise)</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>        <span class="cf">if</span> area <span class="op">&gt;</span> <span class="dv">500</span>:  <span class="co"># Minimum area threshold</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>            <span class="co"># Get bounding rectangle</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>            x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb9-32"><a href="#cb9-32"></a>            </span>
<span id="cb9-33"><a href="#cb9-33"></a>            <span class="co"># Get center</span></span>
<span id="cb9-34"><a href="#cb9-34"></a>            M <span class="op">=</span> cv2.moments(contour)</span>
<span id="cb9-35"><a href="#cb9-35"></a>            <span class="cf">if</span> M[<span class="st">"m00"</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb9-36"><a href="#cb9-36"></a>                cx <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m10"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb9-37"><a href="#cb9-37"></a>                cy <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m01"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb9-38"><a href="#cb9-38"></a>            <span class="cf">else</span>:</span>
<span id="cb9-39"><a href="#cb9-39"></a>                cx, cy <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb9-40"><a href="#cb9-40"></a>            </span>
<span id="cb9-41"><a href="#cb9-41"></a>            <span class="co"># Draw contour and info</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>            color <span class="op">=</span> colors[i <span class="op">%</span> <span class="bu">len</span>(colors)]</span>
<span id="cb9-43"><a href="#cb9-43"></a>            cv2.drawContours(result, [contour], <span class="op">-</span><span class="dv">1</span>, color, <span class="dv">3</span>)</span>
<span id="cb9-44"><a href="#cb9-44"></a>            cv2.rectangle(result, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), color, <span class="dv">2</span>)</span>
<span id="cb9-45"><a href="#cb9-45"></a>            cv2.circle(result, (cx, cy), <span class="dv">5</span>, color, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb9-46"><a href="#cb9-46"></a>            </span>
<span id="cb9-47"><a href="#cb9-47"></a>            <span class="co"># Add text</span></span>
<span id="cb9-48"><a href="#cb9-48"></a>            cv2.putText(result, <span class="ss">f"#</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, (x, y<span class="op">-</span><span class="dv">10</span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.7</span>, color, <span class="dv">2</span>)</span>
<span id="cb9-49"><a href="#cb9-49"></a>            </span>
<span id="cb9-50"><a href="#cb9-50"></a>            contour_info.append({</span>
<span id="cb9-51"><a href="#cb9-51"></a>                <span class="st">'id'</span>: i<span class="op">+</span><span class="dv">1</span>,</span>
<span id="cb9-52"><a href="#cb9-52"></a>                <span class="st">'area'</span>: area,</span>
<span id="cb9-53"><a href="#cb9-53"></a>                <span class="st">'perimeter'</span>: perimeter,</span>
<span id="cb9-54"><a href="#cb9-54"></a>                <span class="st">'center'</span>: (cx, cy),</span>
<span id="cb9-55"><a href="#cb9-55"></a>                <span class="st">'bounding_box'</span>: (x, y, w, h)</span>
<span id="cb9-56"><a href="#cb9-56"></a>            })</span>
<span id="cb9-57"><a href="#cb9-57"></a>    </span>
<span id="cb9-58"><a href="#cb9-58"></a>    <span class="cf">return</span> binary, result, contour_info</span>
<span id="cb9-59"><a href="#cb9-59"></a></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="co"># Apply contour segmentation</span></span>
<span id="cb9-61"><a href="#cb9-61"></a>binary_contours, contour_result, contour_info <span class="op">=</span> contour_segmentation(img_rgb)</span>
<span id="cb9-62"><a href="#cb9-62"></a></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="co"># Display results</span></span>
<span id="cb9-64"><a href="#cb9-64"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb9-65"><a href="#cb9-65"></a></span>
<span id="cb9-66"><a href="#cb9-66"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb9-67"><a href="#cb9-67"></a>plt.imshow(img_rgb)</span>
<span id="cb9-68"><a href="#cb9-68"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb9-69"><a href="#cb9-69"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb9-70"><a href="#cb9-70"></a></span>
<span id="cb9-71"><a href="#cb9-71"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb9-72"><a href="#cb9-72"></a>plt.imshow(binary_contours, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb9-73"><a href="#cb9-73"></a>plt.title(<span class="st">"Binary Image"</span>)</span>
<span id="cb9-74"><a href="#cb9-74"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb9-75"><a href="#cb9-75"></a></span>
<span id="cb9-76"><a href="#cb9-76"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb9-77"><a href="#cb9-77"></a>plt.imshow(contour_result)</span>
<span id="cb9-78"><a href="#cb9-78"></a>plt.title(<span class="st">"Contour Segmentation"</span>)</span>
<span id="cb9-79"><a href="#cb9-79"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb9-80"><a href="#cb9-80"></a></span>
<span id="cb9-81"><a href="#cb9-81"></a>plt.tight_layout()</span>
<span id="cb9-82"><a href="#cb9-82"></a>plt.show()</span>
<span id="cb9-83"><a href="#cb9-83"></a></span>
<span id="cb9-84"><a href="#cb9-84"></a><span class="co"># Print contour analysis</span></span>
<span id="cb9-85"><a href="#cb9-85"></a><span class="bu">print</span>(<span class="st">"ðŸ” Contour Analysis Results:"</span>)</span>
<span id="cb9-86"><a href="#cb9-86"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb9-87"><a href="#cb9-87"></a><span class="cf">for</span> info <span class="kw">in</span> contour_info:</span>
<span id="cb9-88"><a href="#cb9-88"></a>    <span class="bu">print</span>(<span class="ss">f"Object #</span><span class="sc">{</span>info[<span class="st">'id'</span>]<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb9-89"><a href="#cb9-89"></a>    <span class="bu">print</span>(<span class="ss">f"  Area: </span><span class="sc">{</span>info[<span class="st">'area'</span>]<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb9-90"><a href="#cb9-90"></a>    <span class="bu">print</span>(<span class="ss">f"  Perimeter: </span><span class="sc">{</span>info[<span class="st">'perimeter'</span>]<span class="sc">:.1f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb9-91"><a href="#cb9-91"></a>    <span class="bu">print</span>(<span class="ss">f"  Center: </span><span class="sc">{</span>info[<span class="st">'center'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-92"><a href="#cb9-92"></a>    <span class="bu">print</span>(<span class="ss">f"  Bounding box: </span><span class="sc">{</span>info[<span class="st">'bounding_box'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-93"><a href="#cb9-93"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸ” Contour Analysis Results:
--------------------------------------------------
Object #1:
  Area: 2736 pixels
  Perimeter: 197.8 pixels
  Center: (650, 500)
  Bounding box: (620, 470, 61, 61)

Object #2:
  Area: 15000 pixels
  Perimeter: 582.8 pixels
  Center: (150, 449)
  Bounding box: (50, 350, 201, 151)

Object #3:
  Area: 42662 pixels
  Perimeter: 1073.3 pixels
  Center: (425, 416)
  Bounding box: (300, 300, 301, 251)

Object #4:
  Area: 1890 pixels
  Perimeter: 164.9 pixels
  Center: (700, 300)
  Bounding box: (675, 275, 51, 51)

Object #5:
  Area: 1200 pixels
  Perimeter: 131.9 pixels
  Center: (100, 250)
  Bounding box: (80, 230, 41, 41)

Object #6:
  Area: 20000 pixels
  Perimeter: 600.0 pixels
  Center: (500, 150)
  Bounding box: (400, 100, 201, 101)

Object #7:
  Area: 19854 pixels
  Perimeter: 529.9 pixels
  Center: (200, 150)
  Bounding box: (120, 70, 161, 161)
</code></pre>
</div>
</div>
</section>
<section id="real-world-application-document-cleaning" class="level2" data-number="0.7">
<h2 data-number="0.7" class="anchored" data-anchor-id="real-world-application-document-cleaning"><span class="header-section-number">0.7</span> Real-World Application: Document Cleaning</h2>
<p>Letâ€™s combine multiple techniques to clean up a noisy document:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">def</span> document_cleaning_pipeline(image):</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="co">"""Complete pipeline for cleaning scanned documents"""</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>    </span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="co"># Step 1: Convert to grayscale</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb11-6"><a href="#cb11-6"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="cf">else</span>:</span>
<span id="cb11-8"><a href="#cb11-8"></a>        gray <span class="op">=</span> image</span>
<span id="cb11-9"><a href="#cb11-9"></a>    </span>
<span id="cb11-10"><a href="#cb11-10"></a>    <span class="co"># Step 2: Apply adaptive thresholding</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>    binary <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb11-12"><a href="#cb11-12"></a>        gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>    )</span>
<span id="cb11-14"><a href="#cb11-14"></a>    </span>
<span id="cb11-15"><a href="#cb11-15"></a>    <span class="co"># Step 3: Remove noise with opening</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>    kernel_noise <span class="op">=</span> np.ones((<span class="dv">2</span>, <span class="dv">2</span>), np.uint8)</span>
<span id="cb11-17"><a href="#cb11-17"></a>    denoised <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel_noise)</span>
<span id="cb11-18"><a href="#cb11-18"></a>    </span>
<span id="cb11-19"><a href="#cb11-19"></a>    <span class="co"># Step 4: Fill gaps in text with closing</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>    kernel_fill <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8)</span>
<span id="cb11-21"><a href="#cb11-21"></a>    filled <span class="op">=</span> cv2.morphologyEx(denoised, cv2.MORPH_CLOSE, kernel_fill)</span>
<span id="cb11-22"><a href="#cb11-22"></a>    </span>
<span id="cb11-23"><a href="#cb11-23"></a>    <span class="co"># Step 5: Enhance text with dilation</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>    kernel_enhance <span class="op">=</span> np.ones((<span class="dv">2</span>, <span class="dv">2</span>), np.uint8)</span>
<span id="cb11-25"><a href="#cb11-25"></a>    enhanced <span class="op">=</span> cv2.dilate(filled, kernel_enhance, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-26"><a href="#cb11-26"></a>    </span>
<span id="cb11-27"><a href="#cb11-27"></a>    <span class="cf">return</span> gray, binary, denoised, filled, enhanced</span>
<span id="cb11-28"><a href="#cb11-28"></a></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co"># Apply document cleaning to our morphological demo</span></span>
<span id="cb11-30"><a href="#cb11-30"></a>gray_doc, binary_doc, denoised_doc, filled_doc, enhanced_doc <span class="op">=</span> document_cleaning_pipeline(morph_img)</span>
<span id="cb11-31"><a href="#cb11-31"></a></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co"># Display the cleaning pipeline</span></span>
<span id="cb11-33"><a href="#cb11-33"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">12</span>))</span>
<span id="cb11-34"><a href="#cb11-34"></a></span>
<span id="cb11-35"><a href="#cb11-35"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb11-36"><a href="#cb11-36"></a>plt.imshow(gray_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-37"><a href="#cb11-37"></a>plt.title(<span class="st">"1. Original Grayscale"</span>)</span>
<span id="cb11-38"><a href="#cb11-38"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-39"><a href="#cb11-39"></a></span>
<span id="cb11-40"><a href="#cb11-40"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb11-41"><a href="#cb11-41"></a>plt.imshow(binary_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-42"><a href="#cb11-42"></a>plt.title(<span class="st">"2. Adaptive Threshold"</span>)</span>
<span id="cb11-43"><a href="#cb11-43"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-44"><a href="#cb11-44"></a></span>
<span id="cb11-45"><a href="#cb11-45"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb11-46"><a href="#cb11-46"></a>plt.imshow(denoised_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-47"><a href="#cb11-47"></a>plt.title(<span class="st">"3. Noise Removal (Opening)"</span>)</span>
<span id="cb11-48"><a href="#cb11-48"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-49"><a href="#cb11-49"></a></span>
<span id="cb11-50"><a href="#cb11-50"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb11-51"><a href="#cb11-51"></a>plt.imshow(filled_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-52"><a href="#cb11-52"></a>plt.title(<span class="st">"4. Gap Filling (Closing)"</span>)</span>
<span id="cb11-53"><a href="#cb11-53"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-54"><a href="#cb11-54"></a></span>
<span id="cb11-55"><a href="#cb11-55"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb11-56"><a href="#cb11-56"></a>plt.imshow(enhanced_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-57"><a href="#cb11-57"></a>plt.title(<span class="st">"5. Text Enhancement (Dilation)"</span>)</span>
<span id="cb11-58"><a href="#cb11-58"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-59"><a href="#cb11-59"></a></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="co"># Show before/after comparison</span></span>
<span id="cb11-61"><a href="#cb11-61"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb11-62"><a href="#cb11-62"></a>comparison <span class="op">=</span> np.hstack([gray_doc, enhanced_doc])</span>
<span id="cb11-63"><a href="#cb11-63"></a>plt.imshow(comparison, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb11-64"><a href="#cb11-64"></a>plt.title(<span class="st">"Before â†’ After"</span>)</span>
<span id="cb11-65"><a href="#cb11-65"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-66"><a href="#cb11-66"></a></span>
<span id="cb11-67"><a href="#cb11-67"></a>plt.tight_layout()</span>
<span id="cb11-68"><a href="#cb11-68"></a>plt.show()</span>
<span id="cb11-69"><a href="#cb11-69"></a></span>
<span id="cb11-70"><a href="#cb11-70"></a><span class="bu">print</span>(<span class="st">"ðŸ“„ Document Cleaning Pipeline:"</span>)</span>
<span id="cb11-71"><a href="#cb11-71"></a><span class="bu">print</span>(<span class="st">"âœ… Adaptive thresholding handles varying lighting"</span>)</span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="bu">print</span>(<span class="st">"âœ… Opening removes small noise pixels"</span>)</span>
<span id="cb11-73"><a href="#cb11-73"></a><span class="bu">print</span>(<span class="st">"âœ… Closing fills gaps in letters"</span>)</span>
<span id="cb11-74"><a href="#cb11-74"></a><span class="bu">print</span>(<span class="st">"âœ… Dilation strengthens text strokes"</span>)</span>
<span id="cb11-75"><a href="#cb11-75"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Result: Clean, readable text!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸ“„ Document Cleaning Pipeline:
âœ… Adaptive thresholding handles varying lighting
âœ… Opening removes small noise pixels
âœ… Closing fills gaps in letters
âœ… Dilation strengthens text strokes
ðŸŽ¯ Result: Clean, readable text!</code></pre>
</div>
</div>
</section>
<section id="segmentation-comparison-tool" class="level2" data-number="0.8">
<h2 data-number="0.8" class="anchored" data-anchor-id="segmentation-comparison-tool"><span class="header-section-number">0.8</span> Segmentation Comparison Tool</h2>
<p>Letâ€™s create a tool to compare all segmentation techniques side by side:</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">def</span> compare_segmentation_techniques(image):</span>
<span id="cb13-2"><a href="#cb13-2"></a>    <span class="co">"""Compare multiple segmentation techniques on the same image"""</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>    </span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb13-6"><a href="#cb13-6"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="cf">else</span>:</span>
<span id="cb13-8"><a href="#cb13-8"></a>        gray <span class="op">=</span> image</span>
<span id="cb13-9"><a href="#cb13-9"></a>    </span>
<span id="cb13-10"><a href="#cb13-10"></a>    techniques <span class="op">=</span> {}</span>
<span id="cb13-11"><a href="#cb13-11"></a>    </span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="co"># 1. Simple thresholding</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>    _, techniques[<span class="st">'Binary Threshold'</span>] <span class="op">=</span> cv2.threshold(gray, <span class="dv">127</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb13-14"><a href="#cb13-14"></a>    </span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="co"># 2. Otsu's thresholding</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    _, techniques[<span class="st">'Otsu Threshold'</span>] <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb13-17"><a href="#cb13-17"></a>    </span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="co"># 3. Adaptive thresholding</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>    techniques[<span class="st">'Adaptive Threshold'</span>] <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb13-20"><a href="#cb13-20"></a>        gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>    )</span>
<span id="cb13-22"><a href="#cb13-22"></a>    </span>
<span id="cb13-23"><a href="#cb13-23"></a>    <span class="co"># 4. Morphological opening</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">5</span>, <span class="dv">5</span>), np.uint8)</span>
<span id="cb13-25"><a href="#cb13-25"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb13-26"><a href="#cb13-26"></a>    techniques[<span class="st">'Morphological Opening'</span>] <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel)</span>
<span id="cb13-27"><a href="#cb13-27"></a>    </span>
<span id="cb13-28"><a href="#cb13-28"></a>    <span class="co"># 5. Morphological closing</span></span>
<span id="cb13-29"><a href="#cb13-29"></a>    techniques[<span class="st">'Morphological Closing'</span>] <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb13-30"><a href="#cb13-30"></a>    </span>
<span id="cb13-31"><a href="#cb13-31"></a>    <span class="cf">return</span> techniques</span>
<span id="cb13-32"><a href="#cb13-32"></a></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co"># Compare techniques on our demo image</span></span>
<span id="cb13-34"><a href="#cb13-34"></a>techniques <span class="op">=</span> compare_segmentation_techniques(img_rgb)</span>
<span id="cb13-35"><a href="#cb13-35"></a></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="co"># Display comparison</span></span>
<span id="cb13-37"><a href="#cb13-37"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb13-40"><a href="#cb13-40"></a>plt.imshow(img_rgb)</span>
<span id="cb13-41"><a href="#cb13-41"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb13-42"><a href="#cb13-42"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb13-43"><a href="#cb13-43"></a></span>
<span id="cb13-44"><a href="#cb13-44"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(techniques.items(), <span class="dv">2</span>):</span>
<span id="cb13-45"><a href="#cb13-45"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, i)</span>
<span id="cb13-46"><a href="#cb13-46"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb13-47"><a href="#cb13-47"></a>    plt.title(name)</span>
<span id="cb13-48"><a href="#cb13-48"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb13-49"><a href="#cb13-49"></a></span>
<span id="cb13-50"><a href="#cb13-50"></a>plt.tight_layout()</span>
<span id="cb13-51"><a href="#cb13-51"></a>plt.show()</span>
<span id="cb13-52"><a href="#cb13-52"></a></span>
<span id="cb13-53"><a href="#cb13-53"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Technique Comparison:"</span>)</span>
<span id="cb13-54"><a href="#cb13-54"></a><span class="bu">print</span>(<span class="st">"- Binary: Simple but effective for uniform lighting"</span>)</span>
<span id="cb13-55"><a href="#cb13-55"></a><span class="bu">print</span>(<span class="st">"- Otsu: Automatically finds optimal threshold"</span>)</span>
<span id="cb13-56"><a href="#cb13-56"></a><span class="bu">print</span>(<span class="st">"- Adaptive: Handles varying lighting conditions"</span>)</span>
<span id="cb13-57"><a href="#cb13-57"></a><span class="bu">print</span>(<span class="st">"- Opening: Removes noise while preserving object shape"</span>)</span>
<span id="cb13-58"><a href="#cb13-58"></a><span class="bu">print</span>(<span class="st">"- Closing: Fills gaps and connects broken parts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸŽ¯ Technique Comparison:
- Binary: Simple but effective for uniform lighting
- Otsu: Automatically finds optimal threshold
- Adaptive: Handles varying lighting conditions
- Opening: Removes noise while preserving object shape
- Closing: Fills gaps and connects broken parts</code></pre>
</div>
</div>
</section>
<section id="your-challenge-medical-image-segmentation" class="level2" data-number="0.9">
<h2 data-number="0.9" class="anchored" data-anchor-id="your-challenge-medical-image-segmentation"><span class="header-section-number">0.9</span> Your Challenge: Medical Image Segmentation</h2>
<p>Now itâ€™s your turn! Hereâ€™s a framework for a medical image segmentation system:</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">class</span> MedicalImageSegmenter:</span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb15-3"><a href="#cb15-3"></a>        <span class="va">self</span>.techniques <span class="op">=</span> {</span>
<span id="cb15-4"><a href="#cb15-4"></a>            <span class="st">'threshold'</span>: <span class="va">self</span>.threshold_segment,</span>
<span id="cb15-5"><a href="#cb15-5"></a>            <span class="st">'morphological'</span>: <span class="va">self</span>.morphological_segment,</span>
<span id="cb15-6"><a href="#cb15-6"></a>            <span class="st">'watershed'</span>: <span class="va">self</span>.watershed_segment,</span>
<span id="cb15-7"><a href="#cb15-7"></a>            <span class="st">'contour'</span>: <span class="va">self</span>.contour_segment</span>
<span id="cb15-8"><a href="#cb15-8"></a>        }</span>
<span id="cb15-9"><a href="#cb15-9"></a>    </span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="kw">def</span> threshold_segment(<span class="va">self</span>, image, method<span class="op">=</span><span class="st">'otsu'</span>):</span>
<span id="cb15-11"><a href="#cb15-11"></a>        <span class="co">"""Apply thresholding segmentation"""</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>        <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb15-13"><a href="#cb15-13"></a>            gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb15-14"><a href="#cb15-14"></a>        <span class="cf">else</span>:</span>
<span id="cb15-15"><a href="#cb15-15"></a>            gray <span class="op">=</span> image</span>
<span id="cb15-16"><a href="#cb15-16"></a>            </span>
<span id="cb15-17"><a href="#cb15-17"></a>        <span class="cf">if</span> method <span class="op">==</span> <span class="st">'otsu'</span>:</span>
<span id="cb15-18"><a href="#cb15-18"></a>            _, result <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb15-19"><a href="#cb15-19"></a>        <span class="cf">elif</span> method <span class="op">==</span> <span class="st">'adaptive'</span>:</span>
<span id="cb15-20"><a href="#cb15-20"></a>            result <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb15-21"><a href="#cb15-21"></a>                gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>            )</span>
<span id="cb15-23"><a href="#cb15-23"></a>        <span class="cf">else</span>:</span>
<span id="cb15-24"><a href="#cb15-24"></a>            _, result <span class="op">=</span> cv2.threshold(gray, <span class="dv">127</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb15-25"><a href="#cb15-25"></a>        </span>
<span id="cb15-26"><a href="#cb15-26"></a>        <span class="cf">return</span> result</span>
<span id="cb15-27"><a href="#cb15-27"></a>    </span>
<span id="cb15-28"><a href="#cb15-28"></a>    <span class="kw">def</span> morphological_segment(<span class="va">self</span>, image, operation<span class="op">=</span><span class="st">'opening'</span>, kernel_size<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb15-29"><a href="#cb15-29"></a>        <span class="co">"""Apply morphological operations"""</span></span>
<span id="cb15-30"><a href="#cb15-30"></a>        <span class="co"># First get binary image</span></span>
<span id="cb15-31"><a href="#cb15-31"></a>        binary <span class="op">=</span> <span class="va">self</span>.threshold_segment(image, <span class="st">'otsu'</span>)</span>
<span id="cb15-32"><a href="#cb15-32"></a>        </span>
<span id="cb15-33"><a href="#cb15-33"></a>        <span class="co"># Apply morphological operation</span></span>
<span id="cb15-34"><a href="#cb15-34"></a>        kernel <span class="op">=</span> np.ones((kernel_size, kernel_size), np.uint8)</span>
<span id="cb15-35"><a href="#cb15-35"></a>        </span>
<span id="cb15-36"><a href="#cb15-36"></a>        <span class="cf">if</span> operation <span class="op">==</span> <span class="st">'opening'</span>:</span>
<span id="cb15-37"><a href="#cb15-37"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel)</span>
<span id="cb15-38"><a href="#cb15-38"></a>        <span class="cf">elif</span> operation <span class="op">==</span> <span class="st">'closing'</span>:</span>
<span id="cb15-39"><a href="#cb15-39"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb15-40"><a href="#cb15-40"></a>        <span class="cf">elif</span> operation <span class="op">==</span> <span class="st">'gradient'</span>:</span>
<span id="cb15-41"><a href="#cb15-41"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_GRADIENT, kernel)</span>
<span id="cb15-42"><a href="#cb15-42"></a>        <span class="cf">else</span>:</span>
<span id="cb15-43"><a href="#cb15-43"></a>            result <span class="op">=</span> binary</span>
<span id="cb15-44"><a href="#cb15-44"></a>            </span>
<span id="cb15-45"><a href="#cb15-45"></a>        <span class="cf">return</span> result</span>
<span id="cb15-46"><a href="#cb15-46"></a>    </span>
<span id="cb15-47"><a href="#cb15-47"></a>    <span class="kw">def</span> watershed_segment(<span class="va">self</span>, image):</span>
<span id="cb15-48"><a href="#cb15-48"></a>        <span class="co">"""Apply watershed segmentation"""</span></span>
<span id="cb15-49"><a href="#cb15-49"></a>        <span class="co"># This is a simplified version</span></span>
<span id="cb15-50"><a href="#cb15-50"></a>        <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb15-51"><a href="#cb15-51"></a>            gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb15-52"><a href="#cb15-52"></a>        <span class="cf">else</span>:</span>
<span id="cb15-53"><a href="#cb15-53"></a>            gray <span class="op">=</span> image</span>
<span id="cb15-54"><a href="#cb15-54"></a>            </span>
<span id="cb15-55"><a href="#cb15-55"></a>        <span class="co"># Apply threshold</span></span>
<span id="cb15-56"><a href="#cb15-56"></a>        _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb15-57"><a href="#cb15-57"></a>        </span>
<span id="cb15-58"><a href="#cb15-58"></a>        <span class="co"># Distance transform</span></span>
<span id="cb15-59"><a href="#cb15-59"></a>        dist_transform <span class="op">=</span> cv2.distanceTransform(binary, cv2.DIST_L2, <span class="dv">5</span>)</span>
<span id="cb15-60"><a href="#cb15-60"></a>        </span>
<span id="cb15-61"><a href="#cb15-61"></a>        <span class="co"># Find local maxima</span></span>
<span id="cb15-62"><a href="#cb15-62"></a>        _, markers <span class="op">=</span> cv2.threshold(dist_transform, <span class="fl">0.7</span> <span class="op">*</span> dist_transform.<span class="bu">max</span>(), <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb15-63"><a href="#cb15-63"></a>        </span>
<span id="cb15-64"><a href="#cb15-64"></a>        <span class="cf">return</span> markers.astype(np.uint8)</span>
<span id="cb15-65"><a href="#cb15-65"></a>    </span>
<span id="cb15-66"><a href="#cb15-66"></a>    <span class="kw">def</span> contour_segment(<span class="va">self</span>, image, min_area<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb15-67"><a href="#cb15-67"></a>        <span class="co">"""Segment using contours"""</span></span>
<span id="cb15-68"><a href="#cb15-68"></a>        binary <span class="op">=</span> <span class="va">self</span>.threshold_segment(image, <span class="st">'otsu'</span>)</span>
<span id="cb15-69"><a href="#cb15-69"></a>        </span>
<span id="cb15-70"><a href="#cb15-70"></a>        <span class="co"># Find contours</span></span>
<span id="cb15-71"><a href="#cb15-71"></a>        contours, _ <span class="op">=</span> cv2.findContours(binary, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb15-72"><a href="#cb15-72"></a>        </span>
<span id="cb15-73"><a href="#cb15-73"></a>        <span class="co"># Create result image</span></span>
<span id="cb15-74"><a href="#cb15-74"></a>        result <span class="op">=</span> np.zeros_like(binary)</span>
<span id="cb15-75"><a href="#cb15-75"></a>        </span>
<span id="cb15-76"><a href="#cb15-76"></a>        <span class="co"># Draw significant contours</span></span>
<span id="cb15-77"><a href="#cb15-77"></a>        <span class="cf">for</span> contour <span class="kw">in</span> contours:</span>
<span id="cb15-78"><a href="#cb15-78"></a>            <span class="cf">if</span> cv2.contourArea(contour) <span class="op">&gt;</span> min_area:</span>
<span id="cb15-79"><a href="#cb15-79"></a>                cv2.drawContours(result, [contour], <span class="op">-</span><span class="dv">1</span>, <span class="dv">255</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb15-80"><a href="#cb15-80"></a>        </span>
<span id="cb15-81"><a href="#cb15-81"></a>        <span class="cf">return</span> result</span>
<span id="cb15-82"><a href="#cb15-82"></a>    </span>
<span id="cb15-83"><a href="#cb15-83"></a>    <span class="kw">def</span> analyze_segments(<span class="va">self</span>, segmented_image):</span>
<span id="cb15-84"><a href="#cb15-84"></a>        <span class="co">"""Analyze segmented regions"""</span></span>
<span id="cb15-85"><a href="#cb15-85"></a>        <span class="co"># Find connected components</span></span>
<span id="cb15-86"><a href="#cb15-86"></a>        num_labels, labels, stats, centroids <span class="op">=</span> cv2.connectedComponentsWithStats(segmented_image)</span>
<span id="cb15-87"><a href="#cb15-87"></a>        </span>
<span id="cb15-88"><a href="#cb15-88"></a>        analysis <span class="op">=</span> {</span>
<span id="cb15-89"><a href="#cb15-89"></a>            <span class="st">'num_objects'</span>: num_labels <span class="op">-</span> <span class="dv">1</span>,  <span class="co"># Subtract background</span></span>
<span id="cb15-90"><a href="#cb15-90"></a>            <span class="st">'total_area'</span>: np.<span class="bu">sum</span>(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]),  <span class="co"># Exclude background</span></span>
<span id="cb15-91"><a href="#cb15-91"></a>            <span class="st">'average_area'</span>: np.mean(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]) <span class="cf">if</span> num_labels <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb15-92"><a href="#cb15-92"></a>            <span class="st">'largest_area'</span>: np.<span class="bu">max</span>(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]) <span class="cf">if</span> num_labels <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb15-93"><a href="#cb15-93"></a>        }</span>
<span id="cb15-94"><a href="#cb15-94"></a>        </span>
<span id="cb15-95"><a href="#cb15-95"></a>        <span class="cf">return</span> analysis</span>
<span id="cb15-96"><a href="#cb15-96"></a></span>
<span id="cb15-97"><a href="#cb15-97"></a><span class="co"># Example usage</span></span>
<span id="cb15-98"><a href="#cb15-98"></a>segmenter <span class="op">=</span> MedicalImageSegmenter()</span>
<span id="cb15-99"><a href="#cb15-99"></a></span>
<span id="cb15-100"><a href="#cb15-100"></a><span class="co"># Apply different techniques to our demo image</span></span>
<span id="cb15-101"><a href="#cb15-101"></a>results <span class="op">=</span> {}</span>
<span id="cb15-102"><a href="#cb15-102"></a><span class="cf">for</span> name, method <span class="kw">in</span> segmenter.techniques.items():</span>
<span id="cb15-103"><a href="#cb15-103"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">'morphological'</span>:</span>
<span id="cb15-104"><a href="#cb15-104"></a>        results[name] <span class="op">=</span> method(img_rgb, <span class="st">'opening'</span>)</span>
<span id="cb15-105"><a href="#cb15-105"></a>    <span class="cf">else</span>:</span>
<span id="cb15-106"><a href="#cb15-106"></a>        results[name] <span class="op">=</span> method(img_rgb)</span>
<span id="cb15-107"><a href="#cb15-107"></a></span>
<span id="cb15-108"><a href="#cb15-108"></a><span class="co"># Analyze results</span></span>
<span id="cb15-109"><a href="#cb15-109"></a><span class="bu">print</span>(<span class="st">"ðŸ¥ Medical Image Segmentation Analysis:"</span>)</span>
<span id="cb15-110"><a href="#cb15-110"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb15-111"><a href="#cb15-111"></a></span>
<span id="cb15-112"><a href="#cb15-112"></a><span class="cf">for</span> name, result <span class="kw">in</span> results.items():</span>
<span id="cb15-113"><a href="#cb15-113"></a>    analysis <span class="op">=</span> segmenter.analyze_segments(result)</span>
<span id="cb15-114"><a href="#cb15-114"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss"> TECHNIQUE:"</span>)</span>
<span id="cb15-115"><a href="#cb15-115"></a>    <span class="bu">print</span>(<span class="ss">f"  Objects detected: </span><span class="sc">{</span>analysis[<span class="st">'num_objects'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-116"><a href="#cb15-116"></a>    <span class="bu">print</span>(<span class="ss">f"  Total area: </span><span class="sc">{</span>analysis[<span class="st">'total_area'</span>]<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb15-117"><a href="#cb15-117"></a>    <span class="bu">print</span>(<span class="ss">f"  Average area: </span><span class="sc">{</span>analysis[<span class="st">'average_area'</span>]<span class="sc">:.1f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb15-118"><a href="#cb15-118"></a>    <span class="bu">print</span>(<span class="ss">f"  Largest area: </span><span class="sc">{</span>analysis[<span class="st">'largest_area'</span>]<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb15-119"><a href="#cb15-119"></a></span>
<span id="cb15-120"><a href="#cb15-120"></a><span class="co"># Visualize results</span></span>
<span id="cb15-121"><a href="#cb15-121"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb15-122"><a href="#cb15-122"></a></span>
<span id="cb15-123"><a href="#cb15-123"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb15-124"><a href="#cb15-124"></a>plt.imshow(img_rgb)</span>
<span id="cb15-125"><a href="#cb15-125"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb15-126"><a href="#cb15-126"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb15-127"><a href="#cb15-127"></a></span>
<span id="cb15-128"><a href="#cb15-128"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(results.items(), <span class="dv">2</span>):</span>
<span id="cb15-129"><a href="#cb15-129"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, i)</span>
<span id="cb15-130"><a href="#cb15-130"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb15-131"><a href="#cb15-131"></a>    plt.title(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Segmentation"</span>)</span>
<span id="cb15-132"><a href="#cb15-132"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb15-133"><a href="#cb15-133"></a></span>
<span id="cb15-134"><a href="#cb15-134"></a>plt.tight_layout()</span>
<span id="cb15-135"><a href="#cb15-135"></a>plt.show()</span>
<span id="cb15-136"><a href="#cb15-136"></a></span>
<span id="cb15-137"><a href="#cb15-137"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ðŸ’¡ Challenge: Try this framework on medical images!"</span>)</span>
<span id="cb15-138"><a href="#cb15-138"></a><span class="bu">print</span>(<span class="st">"- X-rays: Segment bones from soft tissue"</span>)</span>
<span id="cb15-139"><a href="#cb15-139"></a><span class="bu">print</span>(<span class="st">"- MRI scans: Identify different brain regions"</span>)</span>
<span id="cb15-140"><a href="#cb15-140"></a><span class="bu">print</span>(<span class="st">"- Cell images: Count and measure individual cells"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ðŸ¥ Medical Image Segmentation Analysis:
==================================================

THRESHOLD TECHNIQUE:
  Objects detected: 7
  Total area: 104849 pixels
  Average area: 14978.4 pixels
  Largest area: 43177 pixels

MORPHOLOGICAL TECHNIQUE:
  Objects detected: 7
  Total area: 104810 pixels
  Average area: 14972.9 pixels
  Largest area: 43177 pixels

WATERSHED TECHNIQUE:
  Objects detected: 3
  Total area: 4742 pixels
  Average area: 1580.7 pixels
  Largest area: 2375 pixels

CONTOUR TECHNIQUE:
  Objects detected: 7
  Total area: 104849 pixels
  Average area: 14978.4 pixels
  Largest area: 43177 pixels

ðŸ’¡ Challenge: Try this framework on medical images!
- X-rays: Segment bones from soft tissue
- MRI scans: Identify different brain regions
- Cell images: Count and measure individual cells</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="05-image-segmentation_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="key-takeaways" class="level2" data-number="0.10">
<h2 data-number="0.10" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">0.10</span> Key Takeaways</h2>
<ul>
<li><strong>Thresholding</strong> is your first line of defense - simple but powerful</li>
<li><strong>Morphological operations</strong> are like image surgery tools - they reshape and clean</li>
<li><strong>Watershed</strong> excels at separating touching objects</li>
<li><strong>Contour analysis</strong> gives you detailed object measurements</li>
<li><strong>Combine techniques</strong> for robust real-world applications</li>
</ul>
</section>
<section id="whats-coming-next" class="level2" data-number="0.11">
<h2 data-number="0.11" class="anchored" data-anchor-id="whats-coming-next"><span class="header-section-number">0.11</span> Whatâ€™s Coming Next?</h2>
<p>In our next post, <a href="../../../posts/series/cv-foundations/06-feature-magic.html"><strong>â€œFeature Magic: What Makes Images Uniqueâ€</strong></a>, weâ€™ll discover:</p>
<ul>
<li><strong>SIFT and ORB</strong> feature detectors</li>
<li><strong>Feature matching</strong> between images</li>
<li><strong>Object recognition</strong> using keypoints</li>
<li><strong>Panorama stitching</strong> with feature alignment</li>
</ul>
<p>Youâ€™ve mastered the art of dividing images into meaningful partsâ€”next, weâ€™ll learn to find the unique fingerprints that make each image special!</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hands-On Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ready to segment your own images? Try the complete interactive notebook: <a href="https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-05-image-segmentation.ipynb"><strong>Image Segmentation Lab</strong></a></p>
<p>Experiment with medical images, document cleaning, and object counting!</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Series Navigation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Previous</strong>: <a href="../../../posts/series/cv-foundations/04-finding-patterns.html">Finding Patterns: Edges, Contours, and Shapes</a></li>
<li><strong>Next</strong>: <a href="../../../posts/series/cv-foundations/06-feature-magic.html">Feature Magic: What Makes Images Unique</a></li>
<li><strong>Series Home</strong>: <a href="../../../posts/series/computer-vision-foundations.html">Computer Vision Foundations</a></li>
</ul>
</div>
</div>
<hr>
<p><em>Youâ€™ve just learned the fundamental techniques for breaking images into meaningful parts! Segmentation is used everywhere from medical imaging to autonomous vehicles. Next, weâ€™ll explore how to find unique features that make images recognizable.</em></p>


<!-- -->

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div>CC BY-NC-SA 4.0</div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2025,
  author = {, Hasan},
  title = {Image {Segmentation:} {Dividing} and {Conquering}},
  date = {2025-01-23},
  url = {https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/05-image-segmentation.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Hasan. 2025. <span>â€œImage Segmentation: Dividing and Conquering.â€</span>
January 23, 2025. <a href="https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/05-image-segmentation.html">https://hasangoni.quarto.pub/hasan-blog-post/posts/series/cv-foundations/05-image-segmentation.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="yourusername/quarto_blog_hasan" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<script src="https://giscus.app/client.js" data-repo="HasanGoni/quarto_blog_hasan" data-repo-id="" data-category="General" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="an">title:</span><span class="co"> "Image Segmentation: Dividing and Conquering"</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="an">author:</span><span class="co"> "Hasan"</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="an">date:</span><span class="co"> 2025-01-23</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="an">categories:</span><span class="co"> [computer-vision, segmentation, morphology, thresholding]</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="an">tags:</span><span class="co"> [segmentation, thresholding, watershed, erosion, dilation, morphology, contours]</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="an">image:</span><span class="co"> "images/segmentation-header.jpg"</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="an">series:</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">  name: "Computer Vision Foundations"</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">  number: 5</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="an">format:</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">  html: default</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">---</span></span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="al">![Image segmentation concept - dividing images into meaningful regions](images/segmentation-header.jpg)</span></span>
<span id="cb17-18"><a href="#cb17-18"></a></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="fu">## The Art of Divide and Conquer</span></span>
<span id="cb17-20"><a href="#cb17-20"></a></span>
<span id="cb17-21"><a href="#cb17-21"></a>Imagine you're looking at a crowded photo and trying to identify individual people. Your brain automatically separates the image into distinct regionsâ€”faces, bodies, background objects. This is exactly what **image segmentation** does: it divides an image into meaningful parts that we can analyze separately.</span>
<span id="cb17-22"><a href="#cb17-22"></a></span>
<span id="cb17-23"><a href="#cb17-23"></a>Today, we'll master the classical techniques that form the foundation of modern computer vision. From simple thresholding to advanced morphological operations, you'll learn to segment images like a pro!</span>
<span id="cb17-24"><a href="#cb17-24"></a></span>
<span id="cb17-25"><a href="#cb17-25"></a>:::{.callout-tip}</span>
<span id="cb17-26"><a href="#cb17-26"></a>**Try it yourself!** Open this <span class="co">[</span><span class="ot">interactive Colab notebook</span><span class="co">](https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-05-image-segmentation.ipynb)</span> to experiment with segmentation techniques as we build this tutorial.</span>
<span id="cb17-27"><a href="#cb17-27"></a>:::</span>
<span id="cb17-28"><a href="#cb17-28"></a></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="fu">## What is Image Segmentation?</span></span>
<span id="cb17-30"><a href="#cb17-30"></a></span>
<span id="cb17-31"><a href="#cb17-31"></a>**Image segmentation** is the process of partitioning an image into multiple segments or regions. Each segment represents something meaningfulâ€”objects, boundaries, or areas of interest.</span>
<span id="cb17-32"><a href="#cb17-32"></a></span>
<span id="cb17-33"><a href="#cb17-33"></a>Think of it like:</span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="ss">- </span>**Coloring book**: Each region gets its own color</span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="ss">- </span>**Jigsaw puzzle**: Breaking the image into pieces</span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="ss">- </span>**Map making**: Dividing territory into districts</span>
<span id="cb17-37"><a href="#cb17-37"></a></span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="al">![Segmentation demonstration with multiple objects](images/segmentation-demo.jpg)</span></span>
<span id="cb17-39"><a href="#cb17-39"></a></span>
<span id="cb17-40"><a href="#cb17-40"></a>This synthetic image shows perfect segmentation targets:</span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="ss">- </span>**Bright objects** on dark background</span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="ss">- </span>**Different intensities** for various techniques</span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="ss">- </span>**Multiple shapes** to test robustness</span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="ss">- </span>**Noise elements** to challenge algorithms</span>
<span id="cb17-45"><a href="#cb17-45"></a></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="fu">## Technique 1: Thresholding - The Foundation</span></span>
<span id="cb17-47"><a href="#cb17-47"></a></span>
<span id="cb17-48"><a href="#cb17-48"></a>**Thresholding** is the simplest segmentation technique. It converts grayscale images to binary (black and white) by setting a threshold value.</span>
<span id="cb17-49"><a href="#cb17-49"></a></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="in">```{python}</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="co">#| eval: true</span></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="im">import</span> cv2</span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-57"><a href="#cb17-57"></a></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="co"># Load our synthetic segmentation demo image</span></span>
<span id="cb17-59"><a href="#cb17-59"></a>img <span class="op">=</span> cv2.imread(<span class="st">'images/segmentation-demo.jpg'</span>)</span>
<span id="cb17-60"><a href="#cb17-60"></a>img_rgb <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2RGB)</span>
<span id="cb17-61"><a href="#cb17-61"></a>gray <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span>
<span id="cb17-62"><a href="#cb17-62"></a></span>
<span id="cb17-63"><a href="#cb17-63"></a><span class="co"># Simple thresholding</span></span>
<span id="cb17-64"><a href="#cb17-64"></a><span class="kw">def</span> apply_thresholding(image, threshold_value<span class="op">=</span><span class="dv">127</span>):</span>
<span id="cb17-65"><a href="#cb17-65"></a>    <span class="co">"""Apply different thresholding techniques"""</span></span>
<span id="cb17-66"><a href="#cb17-66"></a>    </span>
<span id="cb17-67"><a href="#cb17-67"></a>    <span class="co"># Simple binary thresholding</span></span>
<span id="cb17-68"><a href="#cb17-68"></a>    _, binary <span class="op">=</span> cv2.threshold(image, threshold_value, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb17-69"><a href="#cb17-69"></a>    </span>
<span id="cb17-70"><a href="#cb17-70"></a>    <span class="co"># Adaptive thresholding (handles varying lighting)</span></span>
<span id="cb17-71"><a href="#cb17-71"></a>    adaptive_mean <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb17-72"><a href="#cb17-72"></a>        image, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb17-73"><a href="#cb17-73"></a>    )</span>
<span id="cb17-74"><a href="#cb17-74"></a>    </span>
<span id="cb17-75"><a href="#cb17-75"></a>    adaptive_gaussian <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb17-76"><a href="#cb17-76"></a>        image, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb17-77"><a href="#cb17-77"></a>    )</span>
<span id="cb17-78"><a href="#cb17-78"></a>    </span>
<span id="cb17-79"><a href="#cb17-79"></a>    <span class="co"># Otsu's thresholding (automatically finds best threshold)</span></span>
<span id="cb17-80"><a href="#cb17-80"></a>    _, otsu <span class="op">=</span> cv2.threshold(image, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-81"><a href="#cb17-81"></a>    </span>
<span id="cb17-82"><a href="#cb17-82"></a>    <span class="cf">return</span> binary, adaptive_mean, adaptive_gaussian, otsu</span>
<span id="cb17-83"><a href="#cb17-83"></a></span>
<span id="cb17-84"><a href="#cb17-84"></a><span class="co"># Apply different thresholding techniques</span></span>
<span id="cb17-85"><a href="#cb17-85"></a>binary, adaptive_mean, adaptive_gaussian, otsu <span class="op">=</span> apply_thresholding(gray)</span>
<span id="cb17-86"><a href="#cb17-86"></a></span>
<span id="cb17-87"><a href="#cb17-87"></a><span class="co"># Display results</span></span>
<span id="cb17-88"><a href="#cb17-88"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">12</span>))</span>
<span id="cb17-89"><a href="#cb17-89"></a></span>
<span id="cb17-90"><a href="#cb17-90"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-91"><a href="#cb17-91"></a>plt.imshow(img_rgb)</span>
<span id="cb17-92"><a href="#cb17-92"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb17-93"><a href="#cb17-93"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-94"><a href="#cb17-94"></a></span>
<span id="cb17-95"><a href="#cb17-95"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb17-96"><a href="#cb17-96"></a>plt.imshow(gray, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-97"><a href="#cb17-97"></a>plt.title(<span class="st">"Grayscale"</span>)</span>
<span id="cb17-98"><a href="#cb17-98"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-99"><a href="#cb17-99"></a></span>
<span id="cb17-100"><a href="#cb17-100"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-101"><a href="#cb17-101"></a>plt.imshow(binary, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-102"><a href="#cb17-102"></a>plt.title(<span class="st">"Binary Thresholding (T=127)"</span>)</span>
<span id="cb17-103"><a href="#cb17-103"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-104"><a href="#cb17-104"></a></span>
<span id="cb17-105"><a href="#cb17-105"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb17-106"><a href="#cb17-106"></a>plt.imshow(adaptive_mean, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-107"><a href="#cb17-107"></a>plt.title(<span class="st">"Adaptive Mean Thresholding"</span>)</span>
<span id="cb17-108"><a href="#cb17-108"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-109"><a href="#cb17-109"></a></span>
<span id="cb17-110"><a href="#cb17-110"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb17-111"><a href="#cb17-111"></a>plt.imshow(adaptive_gaussian, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-112"><a href="#cb17-112"></a>plt.title(<span class="st">"Adaptive Gaussian Thresholding"</span>)</span>
<span id="cb17-113"><a href="#cb17-113"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-114"><a href="#cb17-114"></a></span>
<span id="cb17-115"><a href="#cb17-115"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb17-116"><a href="#cb17-116"></a>plt.imshow(otsu, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-117"><a href="#cb17-117"></a>plt.title(<span class="st">"Otsu's Automatic Thresholding"</span>)</span>
<span id="cb17-118"><a href="#cb17-118"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-119"><a href="#cb17-119"></a></span>
<span id="cb17-120"><a href="#cb17-120"></a>plt.tight_layout()</span>
<span id="cb17-121"><a href="#cb17-121"></a>plt.show()</span>
<span id="cb17-122"><a href="#cb17-122"></a></span>
<span id="cb17-123"><a href="#cb17-123"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Thresholding Results:"</span>)</span>
<span id="cb17-124"><a href="#cb17-124"></a><span class="bu">print</span>(<span class="ss">f"- Binary: Simple threshold at 127"</span>)</span>
<span id="cb17-125"><a href="#cb17-125"></a><span class="bu">print</span>(<span class="ss">f"- Adaptive Mean: Local neighborhood average"</span>)</span>
<span id="cb17-126"><a href="#cb17-126"></a><span class="bu">print</span>(<span class="ss">f"- Adaptive Gaussian: Weighted neighborhood average"</span>)</span>
<span id="cb17-127"><a href="#cb17-127"></a><span class="bu">print</span>(<span class="ss">f"- Otsu: Automatically found optimal threshold"</span>)</span>
<span id="cb17-128"><a href="#cb17-128"></a><span class="in">```</span></span>
<span id="cb17-129"><a href="#cb17-129"></a></span>
<span id="cb17-130"><a href="#cb17-130"></a>**ðŸ”¥ Amazing!** Each technique handles different scenarios:</span>
<span id="cb17-131"><a href="#cb17-131"></a><span class="ss">- </span>**Binary**: Works when lighting is uniform</span>
<span id="cb17-132"><a href="#cb17-132"></a><span class="ss">- </span>**Adaptive**: Handles varying lighting conditions</span>
<span id="cb17-133"><a href="#cb17-133"></a><span class="ss">- </span>**Otsu**: Automatically finds the best threshold</span>
<span id="cb17-134"><a href="#cb17-134"></a></span>
<span id="cb17-135"><a href="#cb17-135"></a><span class="fu">## Technique 2: Morphological Operations - Shape Surgery</span></span>
<span id="cb17-136"><a href="#cb17-136"></a></span>
<span id="cb17-137"><a href="#cb17-137"></a>**Morphological operations** are like performing surgery on shapes. They can clean up noise, separate connected objects, or fill gaps.</span>
<span id="cb17-138"><a href="#cb17-138"></a></span>
<span id="cb17-139"><a href="#cb17-139"></a><span class="fu">### The Core Operations</span></span>
<span id="cb17-140"><a href="#cb17-140"></a></span>
<span id="cb17-143"><a href="#cb17-143"></a><span class="in">```{python}</span></span>
<span id="cb17-144"><a href="#cb17-144"></a><span class="co">#| eval: true</span></span>
<span id="cb17-145"><a href="#cb17-145"></a><span class="co"># Load our morphological demo image (designed for these operations)</span></span>
<span id="cb17-146"><a href="#cb17-146"></a>morph_img <span class="op">=</span> cv2.imread(<span class="st">'images/morphological-demo.jpg'</span>, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb17-147"><a href="#cb17-147"></a></span>
<span id="cb17-148"><a href="#cb17-148"></a><span class="kw">def</span> demonstrate_morphological_operations(image):</span>
<span id="cb17-149"><a href="#cb17-149"></a>    <span class="co">"""Show the four basic morphological operations"""</span></span>
<span id="cb17-150"><a href="#cb17-150"></a>    </span>
<span id="cb17-151"><a href="#cb17-151"></a>    <span class="co"># Define structuring element (kernel)</span></span>
<span id="cb17-152"><a href="#cb17-152"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">5</span>, <span class="dv">5</span>), np.uint8)</span>
<span id="cb17-153"><a href="#cb17-153"></a>    </span>
<span id="cb17-154"><a href="#cb17-154"></a>    <span class="co"># Basic operations</span></span>
<span id="cb17-155"><a href="#cb17-155"></a>    erosion <span class="op">=</span> cv2.erode(image, kernel, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-156"><a href="#cb17-156"></a>    dilation <span class="op">=</span> cv2.dilate(image, kernel, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-157"><a href="#cb17-157"></a>    opening <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_OPEN, kernel)</span>
<span id="cb17-158"><a href="#cb17-158"></a>    closing <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb17-159"><a href="#cb17-159"></a>    </span>
<span id="cb17-160"><a href="#cb17-160"></a>    <span class="co"># Advanced operations</span></span>
<span id="cb17-161"><a href="#cb17-161"></a>    gradient <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_GRADIENT, kernel)</span>
<span id="cb17-162"><a href="#cb17-162"></a>    tophat <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_TOPHAT, kernel)</span>
<span id="cb17-163"><a href="#cb17-163"></a>    blackhat <span class="op">=</span> cv2.morphologyEx(image, cv2.MORPH_BLACKHAT, kernel)</span>
<span id="cb17-164"><a href="#cb17-164"></a>    </span>
<span id="cb17-165"><a href="#cb17-165"></a>    <span class="cf">return</span> erosion, dilation, opening, closing, gradient, tophat, blackhat</span>
<span id="cb17-166"><a href="#cb17-166"></a></span>
<span id="cb17-167"><a href="#cb17-167"></a><span class="co"># Apply morphological operations</span></span>
<span id="cb17-168"><a href="#cb17-168"></a>erosion, dilation, opening, closing, gradient, tophat, blackhat <span class="op">=</span> demonstrate_morphological_operations(morph_img)</span>
<span id="cb17-169"><a href="#cb17-169"></a></span>
<span id="cb17-170"><a href="#cb17-170"></a><span class="co"># Display results</span></span>
<span id="cb17-171"><a href="#cb17-171"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb17-172"><a href="#cb17-172"></a></span>
<span id="cb17-173"><a href="#cb17-173"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-174"><a href="#cb17-174"></a>plt.imshow(morph_img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-175"><a href="#cb17-175"></a>plt.title(<span class="st">"Original (with noise and gaps)"</span>)</span>
<span id="cb17-176"><a href="#cb17-176"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-177"><a href="#cb17-177"></a></span>
<span id="cb17-178"><a href="#cb17-178"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb17-179"><a href="#cb17-179"></a>plt.imshow(erosion, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-180"><a href="#cb17-180"></a>plt.title(<span class="st">"Erosion (shrinks objects)"</span>)</span>
<span id="cb17-181"><a href="#cb17-181"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-182"><a href="#cb17-182"></a></span>
<span id="cb17-183"><a href="#cb17-183"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-184"><a href="#cb17-184"></a>plt.imshow(dilation, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-185"><a href="#cb17-185"></a>plt.title(<span class="st">"Dilation (expands objects)"</span>)</span>
<span id="cb17-186"><a href="#cb17-186"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-187"><a href="#cb17-187"></a></span>
<span id="cb17-188"><a href="#cb17-188"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb17-189"><a href="#cb17-189"></a>plt.imshow(opening, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-190"><a href="#cb17-190"></a>plt.title(<span class="st">"Opening (removes noise)"</span>)</span>
<span id="cb17-191"><a href="#cb17-191"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-192"><a href="#cb17-192"></a></span>
<span id="cb17-193"><a href="#cb17-193"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb17-194"><a href="#cb17-194"></a>plt.imshow(closing, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-195"><a href="#cb17-195"></a>plt.title(<span class="st">"Closing (fills gaps)"</span>)</span>
<span id="cb17-196"><a href="#cb17-196"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-197"><a href="#cb17-197"></a></span>
<span id="cb17-198"><a href="#cb17-198"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb17-199"><a href="#cb17-199"></a>plt.imshow(gradient, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-200"><a href="#cb17-200"></a>plt.title(<span class="st">"Gradient (edge detection)"</span>)</span>
<span id="cb17-201"><a href="#cb17-201"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-202"><a href="#cb17-202"></a></span>
<span id="cb17-203"><a href="#cb17-203"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb17-204"><a href="#cb17-204"></a>plt.imshow(tophat, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-205"><a href="#cb17-205"></a>plt.title(<span class="st">"Top Hat (small bright objects)"</span>)</span>
<span id="cb17-206"><a href="#cb17-206"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-207"><a href="#cb17-207"></a></span>
<span id="cb17-208"><a href="#cb17-208"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb17-209"><a href="#cb17-209"></a>plt.imshow(blackhat, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-210"><a href="#cb17-210"></a>plt.title(<span class="st">"Black Hat (small dark objects)"</span>)</span>
<span id="cb17-211"><a href="#cb17-211"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-212"><a href="#cb17-212"></a></span>
<span id="cb17-213"><a href="#cb17-213"></a>plt.tight_layout()</span>
<span id="cb17-214"><a href="#cb17-214"></a>plt.show()</span>
<span id="cb17-215"><a href="#cb17-215"></a></span>
<span id="cb17-216"><a href="#cb17-216"></a><span class="bu">print</span>(<span class="st">"ðŸ”§ Morphological Operations Explained:"</span>)</span>
<span id="cb17-217"><a href="#cb17-217"></a><span class="bu">print</span>(<span class="st">"- Erosion: Shrinks white regions (removes noise)"</span>)</span>
<span id="cb17-218"><a href="#cb17-218"></a><span class="bu">print</span>(<span class="st">"- Dilation: Expands white regions (fills small gaps)"</span>)</span>
<span id="cb17-219"><a href="#cb17-219"></a><span class="bu">print</span>(<span class="st">"- Opening: Erosion followed by dilation (removes small noise)"</span>)</span>
<span id="cb17-220"><a href="#cb17-220"></a><span class="bu">print</span>(<span class="st">"- Closing: Dilation followed by erosion (fills gaps in objects)"</span>)</span>
<span id="cb17-221"><a href="#cb17-221"></a><span class="bu">print</span>(<span class="st">"- Gradient: Difference between dilation and erosion (edges)"</span>)</span>
<span id="cb17-222"><a href="#cb17-222"></a><span class="bu">print</span>(<span class="st">"- Top Hat: Original minus opening (small bright features)"</span>)</span>
<span id="cb17-223"><a href="#cb17-223"></a><span class="bu">print</span>(<span class="st">"- Black Hat: Closing minus original (small dark features)"</span>)</span>
<span id="cb17-224"><a href="#cb17-224"></a><span class="in">```</span></span>
<span id="cb17-225"><a href="#cb17-225"></a></span>
<span id="cb17-226"><a href="#cb17-226"></a><span class="fu">### Understanding Kernels</span></span>
<span id="cb17-227"><a href="#cb17-227"></a></span>
<span id="cb17-230"><a href="#cb17-230"></a><span class="in">```{python}</span></span>
<span id="cb17-231"><a href="#cb17-231"></a><span class="co">#| eval: true</span></span>
<span id="cb17-232"><a href="#cb17-232"></a><span class="co"># Different kernel shapes for different effects</span></span>
<span id="cb17-233"><a href="#cb17-233"></a><span class="kw">def</span> show_kernel_effects():</span>
<span id="cb17-234"><a href="#cb17-234"></a>    <span class="co">"""Demonstrate how different kernels affect morphological operations"""</span></span>
<span id="cb17-235"><a href="#cb17-235"></a>    </span>
<span id="cb17-236"><a href="#cb17-236"></a>    <span class="co"># Create different kernels</span></span>
<span id="cb17-237"><a href="#cb17-237"></a>    kernels <span class="op">=</span> {</span>
<span id="cb17-238"><a href="#cb17-238"></a>        <span class="st">'Rectangle 3x3'</span>: np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8),</span>
<span id="cb17-239"><a href="#cb17-239"></a>        <span class="st">'Rectangle 7x7'</span>: np.ones((<span class="dv">7</span>, <span class="dv">7</span>), np.uint8),</span>
<span id="cb17-240"><a href="#cb17-240"></a>        <span class="st">'Cross'</span>: cv2.getStructuringElement(cv2.MORPH_CROSS, (<span class="dv">5</span>, <span class="dv">5</span>)),</span>
<span id="cb17-241"><a href="#cb17-241"></a>        <span class="st">'Ellipse'</span>: cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb17-242"><a href="#cb17-242"></a>    }</span>
<span id="cb17-243"><a href="#cb17-243"></a>    </span>
<span id="cb17-244"><a href="#cb17-244"></a>    results <span class="op">=</span> {}</span>
<span id="cb17-245"><a href="#cb17-245"></a>    <span class="cf">for</span> name, kernel <span class="kw">in</span> kernels.items():</span>
<span id="cb17-246"><a href="#cb17-246"></a>        <span class="co"># Apply opening operation with different kernels</span></span>
<span id="cb17-247"><a href="#cb17-247"></a>        result <span class="op">=</span> cv2.morphologyEx(morph_img, cv2.MORPH_OPEN, kernel)</span>
<span id="cb17-248"><a href="#cb17-248"></a>        results[name] <span class="op">=</span> result</span>
<span id="cb17-249"><a href="#cb17-249"></a>    </span>
<span id="cb17-250"><a href="#cb17-250"></a>    <span class="cf">return</span> kernels, results</span>
<span id="cb17-251"><a href="#cb17-251"></a></span>
<span id="cb17-252"><a href="#cb17-252"></a>kernels, kernel_results <span class="op">=</span> show_kernel_effects()</span>
<span id="cb17-253"><a href="#cb17-253"></a></span>
<span id="cb17-254"><a href="#cb17-254"></a><span class="co"># Visualize kernel effects</span></span>
<span id="cb17-255"><a href="#cb17-255"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb17-256"><a href="#cb17-256"></a></span>
<span id="cb17-257"><a href="#cb17-257"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb17-258"><a href="#cb17-258"></a>plt.imshow(morph_img, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-259"><a href="#cb17-259"></a>plt.title(<span class="st">"Original"</span>)</span>
<span id="cb17-260"><a href="#cb17-260"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-261"><a href="#cb17-261"></a></span>
<span id="cb17-262"><a href="#cb17-262"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(kernel_results.items(), <span class="dv">2</span>):</span>
<span id="cb17-263"><a href="#cb17-263"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, i)</span>
<span id="cb17-264"><a href="#cb17-264"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-265"><a href="#cb17-265"></a>    plt.title(<span class="ss">f"Opening with </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-266"><a href="#cb17-266"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-267"><a href="#cb17-267"></a></span>
<span id="cb17-268"><a href="#cb17-268"></a><span class="co"># Show the kernels themselves</span></span>
<span id="cb17-269"><a href="#cb17-269"></a><span class="cf">for</span> i, (name, kernel) <span class="kw">in</span> <span class="bu">enumerate</span>(kernels.items(), <span class="dv">6</span>):</span>
<span id="cb17-270"><a href="#cb17-270"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, i)</span>
<span id="cb17-271"><a href="#cb17-271"></a>    plt.imshow(kernel <span class="op">*</span> <span class="dv">255</span>, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-272"><a href="#cb17-272"></a>    plt.title(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> Kernel"</span>)</span>
<span id="cb17-273"><a href="#cb17-273"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-274"><a href="#cb17-274"></a></span>
<span id="cb17-275"><a href="#cb17-275"></a>plt.tight_layout()</span>
<span id="cb17-276"><a href="#cb17-276"></a>plt.show()</span>
<span id="cb17-277"><a href="#cb17-277"></a></span>
<span id="cb17-278"><a href="#cb17-278"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Kernel Shape Effects:"</span>)</span>
<span id="cb17-279"><a href="#cb17-279"></a><span class="bu">print</span>(<span class="st">"- Rectangle: General-purpose, preserves rectangular features"</span>)</span>
<span id="cb17-280"><a href="#cb17-280"></a><span class="bu">print</span>(<span class="st">"- Cross: Connects horizontal/vertical elements"</span>)</span>
<span id="cb17-281"><a href="#cb17-281"></a><span class="bu">print</span>(<span class="st">"- Ellipse: Preserves circular/curved features"</span>)</span>
<span id="cb17-282"><a href="#cb17-282"></a><span class="bu">print</span>(<span class="st">"- Size matters: Larger kernels = stronger effects"</span>)</span>
<span id="cb17-283"><a href="#cb17-283"></a><span class="in">```</span></span>
<span id="cb17-284"><a href="#cb17-284"></a></span>
<span id="cb17-285"><a href="#cb17-285"></a><span class="fu">## Technique 3: Watershed Segmentation - Flooding Algorithm</span></span>
<span id="cb17-286"><a href="#cb17-286"></a></span>
<span id="cb17-287"><a href="#cb17-287"></a>**Watershed segmentation** treats the image like a topographic map and "floods" it to separate regions. Perfect for separating touching objects!</span>
<span id="cb17-288"><a href="#cb17-288"></a></span>
<span id="cb17-291"><a href="#cb17-291"></a><span class="in">```{python}</span></span>
<span id="cb17-292"><a href="#cb17-292"></a><span class="co">#| eval: true</span></span>
<span id="cb17-293"><a href="#cb17-293"></a><span class="im">from</span> scipy <span class="im">import</span> ndimage</span>
<span id="cb17-294"><a href="#cb17-294"></a><span class="im">from</span> skimage.segmentation <span class="im">import</span> watershed</span>
<span id="cb17-295"><a href="#cb17-295"></a></span>
<span id="cb17-296"><a href="#cb17-296"></a><span class="kw">def</span> watershed_segmentation(image):</span>
<span id="cb17-297"><a href="#cb17-297"></a>    <span class="co">"""Apply watershed segmentation to separate touching objects"""</span></span>
<span id="cb17-298"><a href="#cb17-298"></a>    </span>
<span id="cb17-299"><a href="#cb17-299"></a>    <span class="co"># Convert to grayscale if needed</span></span>
<span id="cb17-300"><a href="#cb17-300"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-301"><a href="#cb17-301"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-302"><a href="#cb17-302"></a>    <span class="cf">else</span>:</span>
<span id="cb17-303"><a href="#cb17-303"></a>        gray <span class="op">=</span> image</span>
<span id="cb17-304"><a href="#cb17-304"></a>    </span>
<span id="cb17-305"><a href="#cb17-305"></a>    <span class="co"># Apply threshold to get binary image</span></span>
<span id="cb17-306"><a href="#cb17-306"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-307"><a href="#cb17-307"></a>    </span>
<span id="cb17-308"><a href="#cb17-308"></a>    <span class="co"># Remove noise with morphological opening</span></span>
<span id="cb17-309"><a href="#cb17-309"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8)</span>
<span id="cb17-310"><a href="#cb17-310"></a>    opening <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb17-311"><a href="#cb17-311"></a>    </span>
<span id="cb17-312"><a href="#cb17-312"></a>    <span class="co"># Find sure background area</span></span>
<span id="cb17-313"><a href="#cb17-313"></a>    sure_bg <span class="op">=</span> cv2.dilate(opening, kernel, iterations<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb17-314"><a href="#cb17-314"></a>    </span>
<span id="cb17-315"><a href="#cb17-315"></a>    <span class="co"># Find sure foreground area using distance transform</span></span>
<span id="cb17-316"><a href="#cb17-316"></a>    dist_transform <span class="op">=</span> cv2.distanceTransform(opening, cv2.DIST_L2, <span class="dv">5</span>)</span>
<span id="cb17-317"><a href="#cb17-317"></a>    _, sure_fg <span class="op">=</span> cv2.threshold(dist_transform, <span class="fl">0.7</span> <span class="op">*</span> dist_transform.<span class="bu">max</span>(), <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb17-318"><a href="#cb17-318"></a>    </span>
<span id="cb17-319"><a href="#cb17-319"></a>    <span class="co"># Find unknown region</span></span>
<span id="cb17-320"><a href="#cb17-320"></a>    sure_fg <span class="op">=</span> np.uint8(sure_fg)</span>
<span id="cb17-321"><a href="#cb17-321"></a>    unknown <span class="op">=</span> cv2.subtract(sure_bg, sure_fg)</span>
<span id="cb17-322"><a href="#cb17-322"></a>    </span>
<span id="cb17-323"><a href="#cb17-323"></a>    <span class="co"># Marker labelling</span></span>
<span id="cb17-324"><a href="#cb17-324"></a>    _, markers <span class="op">=</span> cv2.connectedComponents(sure_fg)</span>
<span id="cb17-325"><a href="#cb17-325"></a>    </span>
<span id="cb17-326"><a href="#cb17-326"></a>    <span class="co"># Add one to all labels so that sure background is not 0, but 1</span></span>
<span id="cb17-327"><a href="#cb17-327"></a>    markers <span class="op">=</span> markers <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb17-328"><a href="#cb17-328"></a>    </span>
<span id="cb17-329"><a href="#cb17-329"></a>    <span class="co"># Mark the region of unknown with zero</span></span>
<span id="cb17-330"><a href="#cb17-330"></a>    markers[unknown <span class="op">==</span> <span class="dv">255</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-331"><a href="#cb17-331"></a>    </span>
<span id="cb17-332"><a href="#cb17-332"></a>    <span class="co"># Apply watershed</span></span>
<span id="cb17-333"><a href="#cb17-333"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-334"><a href="#cb17-334"></a>        markers <span class="op">=</span> cv2.watershed(image, markers)</span>
<span id="cb17-335"><a href="#cb17-335"></a>        result <span class="op">=</span> image.copy()</span>
<span id="cb17-336"><a href="#cb17-336"></a>        result[markers <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> [<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>]  <span class="co"># Mark boundaries in red</span></span>
<span id="cb17-337"><a href="#cb17-337"></a>    <span class="cf">else</span>:</span>
<span id="cb17-338"><a href="#cb17-338"></a>        <span class="co"># For grayscale, create a color version for visualization</span></span>
<span id="cb17-339"><a href="#cb17-339"></a>        result <span class="op">=</span> cv2.cvtColor(gray, cv2.COLOR_GRAY2RGB)</span>
<span id="cb17-340"><a href="#cb17-340"></a>        markers_watershed <span class="op">=</span> cv2.watershed(result, markers)</span>
<span id="cb17-341"><a href="#cb17-341"></a>        result[markers_watershed <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> [<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb17-342"><a href="#cb17-342"></a>    </span>
<span id="cb17-343"><a href="#cb17-343"></a>    <span class="cf">return</span> binary, sure_bg, sure_fg, unknown, markers, result</span>
<span id="cb17-344"><a href="#cb17-344"></a></span>
<span id="cb17-345"><a href="#cb17-345"></a><span class="co"># Apply watershed to our demo image</span></span>
<span id="cb17-346"><a href="#cb17-346"></a>binary, sure_bg, sure_fg, unknown, markers, watershed_result <span class="op">=</span> watershed_segmentation(img_rgb)</span>
<span id="cb17-347"><a href="#cb17-347"></a></span>
<span id="cb17-348"><a href="#cb17-348"></a><span class="co"># Display watershed process</span></span>
<span id="cb17-349"><a href="#cb17-349"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb17-350"><a href="#cb17-350"></a></span>
<span id="cb17-351"><a href="#cb17-351"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-352"><a href="#cb17-352"></a>plt.imshow(img_rgb)</span>
<span id="cb17-353"><a href="#cb17-353"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb17-354"><a href="#cb17-354"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-355"><a href="#cb17-355"></a></span>
<span id="cb17-356"><a href="#cb17-356"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb17-357"><a href="#cb17-357"></a>plt.imshow(binary, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-358"><a href="#cb17-358"></a>plt.title(<span class="st">"Binary Threshold"</span>)</span>
<span id="cb17-359"><a href="#cb17-359"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-360"><a href="#cb17-360"></a></span>
<span id="cb17-361"><a href="#cb17-361"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-362"><a href="#cb17-362"></a>plt.imshow(sure_bg, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-363"><a href="#cb17-363"></a>plt.title(<span class="st">"Sure Background"</span>)</span>
<span id="cb17-364"><a href="#cb17-364"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-365"><a href="#cb17-365"></a></span>
<span id="cb17-366"><a href="#cb17-366"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb17-367"><a href="#cb17-367"></a>plt.imshow(sure_fg, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-368"><a href="#cb17-368"></a>plt.title(<span class="st">"Sure Foreground"</span>)</span>
<span id="cb17-369"><a href="#cb17-369"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-370"><a href="#cb17-370"></a></span>
<span id="cb17-371"><a href="#cb17-371"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb17-372"><a href="#cb17-372"></a>plt.imshow(unknown, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-373"><a href="#cb17-373"></a>plt.title(<span class="st">"Unknown Region"</span>)</span>
<span id="cb17-374"><a href="#cb17-374"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-375"><a href="#cb17-375"></a></span>
<span id="cb17-376"><a href="#cb17-376"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb17-377"><a href="#cb17-377"></a>plt.imshow(markers, cmap<span class="op">=</span><span class="st">'tab20'</span>)</span>
<span id="cb17-378"><a href="#cb17-378"></a>plt.title(<span class="st">"Markers"</span>)</span>
<span id="cb17-379"><a href="#cb17-379"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-380"><a href="#cb17-380"></a></span>
<span id="cb17-381"><a href="#cb17-381"></a>plt.subplot(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb17-382"><a href="#cb17-382"></a>plt.imshow(watershed_result)</span>
<span id="cb17-383"><a href="#cb17-383"></a>plt.title(<span class="st">"Watershed Result"</span>)</span>
<span id="cb17-384"><a href="#cb17-384"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-385"><a href="#cb17-385"></a></span>
<span id="cb17-386"><a href="#cb17-386"></a>plt.tight_layout()</span>
<span id="cb17-387"><a href="#cb17-387"></a>plt.show()</span>
<span id="cb17-388"><a href="#cb17-388"></a></span>
<span id="cb17-389"><a href="#cb17-389"></a><span class="bu">print</span>(<span class="st">"ðŸŒŠ Watershed Segmentation Steps:"</span>)</span>
<span id="cb17-390"><a href="#cb17-390"></a><span class="bu">print</span>(<span class="st">"1. Threshold to get binary image"</span>)</span>
<span id="cb17-391"><a href="#cb17-391"></a><span class="bu">print</span>(<span class="st">"2. Find sure background (dilated objects)"</span>)</span>
<span id="cb17-392"><a href="#cb17-392"></a><span class="bu">print</span>(<span class="st">"3. Find sure foreground (distance transform peaks)"</span>)</span>
<span id="cb17-393"><a href="#cb17-393"></a><span class="bu">print</span>(<span class="st">"4. Mark unknown regions between sure areas"</span>)</span>
<span id="cb17-394"><a href="#cb17-394"></a><span class="bu">print</span>(<span class="st">"5. Apply watershed algorithm to flood from markers"</span>)</span>
<span id="cb17-395"><a href="#cb17-395"></a><span class="bu">print</span>(<span class="st">"6. Red lines show the watershed boundaries!"</span>)</span>
<span id="cb17-396"><a href="#cb17-396"></a><span class="in">```</span></span>
<span id="cb17-397"><a href="#cb17-397"></a></span>
<span id="cb17-398"><a href="#cb17-398"></a><span class="fu">## Technique 4: Contour-Based Segmentation</span></span>
<span id="cb17-399"><a href="#cb17-399"></a></span>
<span id="cb17-400"><a href="#cb17-400"></a>**Contours** are the boundaries of objects. We can use them to segment and analyze individual objects.</span>
<span id="cb17-401"><a href="#cb17-401"></a></span>
<span id="cb17-404"><a href="#cb17-404"></a><span class="in">```{python}</span></span>
<span id="cb17-405"><a href="#cb17-405"></a><span class="co">#| eval: true</span></span>
<span id="cb17-406"><a href="#cb17-406"></a><span class="kw">def</span> contour_segmentation(image):</span>
<span id="cb17-407"><a href="#cb17-407"></a>    <span class="co">"""Find and analyze contours for segmentation"""</span></span>
<span id="cb17-408"><a href="#cb17-408"></a>    </span>
<span id="cb17-409"><a href="#cb17-409"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb17-410"><a href="#cb17-410"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-411"><a href="#cb17-411"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-412"><a href="#cb17-412"></a>    <span class="cf">else</span>:</span>
<span id="cb17-413"><a href="#cb17-413"></a>        gray <span class="op">=</span> image</span>
<span id="cb17-414"><a href="#cb17-414"></a>    </span>
<span id="cb17-415"><a href="#cb17-415"></a>    <span class="co"># Apply threshold</span></span>
<span id="cb17-416"><a href="#cb17-416"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-417"><a href="#cb17-417"></a>    </span>
<span id="cb17-418"><a href="#cb17-418"></a>    <span class="co"># Find contours</span></span>
<span id="cb17-419"><a href="#cb17-419"></a>    contours, hierarchy <span class="op">=</span> cv2.findContours(binary, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb17-420"><a href="#cb17-420"></a>    </span>
<span id="cb17-421"><a href="#cb17-421"></a>    <span class="co"># Create result image</span></span>
<span id="cb17-422"><a href="#cb17-422"></a>    result <span class="op">=</span> image.copy() <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span> <span class="cf">else</span> cv2.cvtColor(gray, cv2.COLOR_GRAY2RGB)</span>
<span id="cb17-423"><a href="#cb17-423"></a>    </span>
<span id="cb17-424"><a href="#cb17-424"></a>    <span class="co"># Analyze each contour</span></span>
<span id="cb17-425"><a href="#cb17-425"></a>    contour_info <span class="op">=</span> []</span>
<span id="cb17-426"><a href="#cb17-426"></a>    colors <span class="op">=</span> [(<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>), (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">255</span>), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">255</span>)]</span>
<span id="cb17-427"><a href="#cb17-427"></a>    </span>
<span id="cb17-428"><a href="#cb17-428"></a>    <span class="cf">for</span> i, contour <span class="kw">in</span> <span class="bu">enumerate</span>(contours):</span>
<span id="cb17-429"><a href="#cb17-429"></a>        <span class="co"># Calculate contour properties</span></span>
<span id="cb17-430"><a href="#cb17-430"></a>        area <span class="op">=</span> cv2.contourArea(contour)</span>
<span id="cb17-431"><a href="#cb17-431"></a>        perimeter <span class="op">=</span> cv2.arcLength(contour, <span class="va">True</span>)</span>
<span id="cb17-432"><a href="#cb17-432"></a>        </span>
<span id="cb17-433"><a href="#cb17-433"></a>        <span class="co"># Filter small contours (noise)</span></span>
<span id="cb17-434"><a href="#cb17-434"></a>        <span class="cf">if</span> area <span class="op">&gt;</span> <span class="dv">500</span>:  <span class="co"># Minimum area threshold</span></span>
<span id="cb17-435"><a href="#cb17-435"></a>            <span class="co"># Get bounding rectangle</span></span>
<span id="cb17-436"><a href="#cb17-436"></a>            x, y, w, h <span class="op">=</span> cv2.boundingRect(contour)</span>
<span id="cb17-437"><a href="#cb17-437"></a>            </span>
<span id="cb17-438"><a href="#cb17-438"></a>            <span class="co"># Get center</span></span>
<span id="cb17-439"><a href="#cb17-439"></a>            M <span class="op">=</span> cv2.moments(contour)</span>
<span id="cb17-440"><a href="#cb17-440"></a>            <span class="cf">if</span> M[<span class="st">"m00"</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb17-441"><a href="#cb17-441"></a>                cx <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m10"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb17-442"><a href="#cb17-442"></a>                cy <span class="op">=</span> <span class="bu">int</span>(M[<span class="st">"m01"</span>] <span class="op">/</span> M[<span class="st">"m00"</span>])</span>
<span id="cb17-443"><a href="#cb17-443"></a>            <span class="cf">else</span>:</span>
<span id="cb17-444"><a href="#cb17-444"></a>                cx, cy <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb17-445"><a href="#cb17-445"></a>            </span>
<span id="cb17-446"><a href="#cb17-446"></a>            <span class="co"># Draw contour and info</span></span>
<span id="cb17-447"><a href="#cb17-447"></a>            color <span class="op">=</span> colors[i <span class="op">%</span> <span class="bu">len</span>(colors)]</span>
<span id="cb17-448"><a href="#cb17-448"></a>            cv2.drawContours(result, [contour], <span class="op">-</span><span class="dv">1</span>, color, <span class="dv">3</span>)</span>
<span id="cb17-449"><a href="#cb17-449"></a>            cv2.rectangle(result, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), color, <span class="dv">2</span>)</span>
<span id="cb17-450"><a href="#cb17-450"></a>            cv2.circle(result, (cx, cy), <span class="dv">5</span>, color, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb17-451"><a href="#cb17-451"></a>            </span>
<span id="cb17-452"><a href="#cb17-452"></a>            <span class="co"># Add text</span></span>
<span id="cb17-453"><a href="#cb17-453"></a>            cv2.putText(result, <span class="ss">f"#</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, (x, y<span class="op">-</span><span class="dv">10</span>), cv2.FONT_HERSHEY_SIMPLEX, <span class="fl">0.7</span>, color, <span class="dv">2</span>)</span>
<span id="cb17-454"><a href="#cb17-454"></a>            </span>
<span id="cb17-455"><a href="#cb17-455"></a>            contour_info.append({</span>
<span id="cb17-456"><a href="#cb17-456"></a>                <span class="st">'id'</span>: i<span class="op">+</span><span class="dv">1</span>,</span>
<span id="cb17-457"><a href="#cb17-457"></a>                <span class="st">'area'</span>: area,</span>
<span id="cb17-458"><a href="#cb17-458"></a>                <span class="st">'perimeter'</span>: perimeter,</span>
<span id="cb17-459"><a href="#cb17-459"></a>                <span class="st">'center'</span>: (cx, cy),</span>
<span id="cb17-460"><a href="#cb17-460"></a>                <span class="st">'bounding_box'</span>: (x, y, w, h)</span>
<span id="cb17-461"><a href="#cb17-461"></a>            })</span>
<span id="cb17-462"><a href="#cb17-462"></a>    </span>
<span id="cb17-463"><a href="#cb17-463"></a>    <span class="cf">return</span> binary, result, contour_info</span>
<span id="cb17-464"><a href="#cb17-464"></a></span>
<span id="cb17-465"><a href="#cb17-465"></a><span class="co"># Apply contour segmentation</span></span>
<span id="cb17-466"><a href="#cb17-466"></a>binary_contours, contour_result, contour_info <span class="op">=</span> contour_segmentation(img_rgb)</span>
<span id="cb17-467"><a href="#cb17-467"></a></span>
<span id="cb17-468"><a href="#cb17-468"></a><span class="co"># Display results</span></span>
<span id="cb17-469"><a href="#cb17-469"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb17-470"><a href="#cb17-470"></a></span>
<span id="cb17-471"><a href="#cb17-471"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-472"><a href="#cb17-472"></a>plt.imshow(img_rgb)</span>
<span id="cb17-473"><a href="#cb17-473"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb17-474"><a href="#cb17-474"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-475"><a href="#cb17-475"></a></span>
<span id="cb17-476"><a href="#cb17-476"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb17-477"><a href="#cb17-477"></a>plt.imshow(binary_contours, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-478"><a href="#cb17-478"></a>plt.title(<span class="st">"Binary Image"</span>)</span>
<span id="cb17-479"><a href="#cb17-479"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-480"><a href="#cb17-480"></a></span>
<span id="cb17-481"><a href="#cb17-481"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-482"><a href="#cb17-482"></a>plt.imshow(contour_result)</span>
<span id="cb17-483"><a href="#cb17-483"></a>plt.title(<span class="st">"Contour Segmentation"</span>)</span>
<span id="cb17-484"><a href="#cb17-484"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-485"><a href="#cb17-485"></a></span>
<span id="cb17-486"><a href="#cb17-486"></a>plt.tight_layout()</span>
<span id="cb17-487"><a href="#cb17-487"></a>plt.show()</span>
<span id="cb17-488"><a href="#cb17-488"></a></span>
<span id="cb17-489"><a href="#cb17-489"></a><span class="co"># Print contour analysis</span></span>
<span id="cb17-490"><a href="#cb17-490"></a><span class="bu">print</span>(<span class="st">"ðŸ” Contour Analysis Results:"</span>)</span>
<span id="cb17-491"><a href="#cb17-491"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb17-492"><a href="#cb17-492"></a><span class="cf">for</span> info <span class="kw">in</span> contour_info:</span>
<span id="cb17-493"><a href="#cb17-493"></a>    <span class="bu">print</span>(<span class="ss">f"Object #</span><span class="sc">{</span>info[<span class="st">'id'</span>]<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb17-494"><a href="#cb17-494"></a>    <span class="bu">print</span>(<span class="ss">f"  Area: </span><span class="sc">{</span>info[<span class="st">'area'</span>]<span class="sc">:.0f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb17-495"><a href="#cb17-495"></a>    <span class="bu">print</span>(<span class="ss">f"  Perimeter: </span><span class="sc">{</span>info[<span class="st">'perimeter'</span>]<span class="sc">:.1f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb17-496"><a href="#cb17-496"></a>    <span class="bu">print</span>(<span class="ss">f"  Center: </span><span class="sc">{</span>info[<span class="st">'center'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-497"><a href="#cb17-497"></a>    <span class="bu">print</span>(<span class="ss">f"  Bounding box: </span><span class="sc">{</span>info[<span class="st">'bounding_box'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-498"><a href="#cb17-498"></a>    <span class="bu">print</span>()</span>
<span id="cb17-499"><a href="#cb17-499"></a><span class="in">```</span></span>
<span id="cb17-500"><a href="#cb17-500"></a></span>
<span id="cb17-501"><a href="#cb17-501"></a><span class="fu">## Real-World Application: Document Cleaning</span></span>
<span id="cb17-502"><a href="#cb17-502"></a></span>
<span id="cb17-503"><a href="#cb17-503"></a>Let's combine multiple techniques to clean up a noisy document:</span>
<span id="cb17-504"><a href="#cb17-504"></a></span>
<span id="cb17-507"><a href="#cb17-507"></a><span class="in">```{python}</span></span>
<span id="cb17-508"><a href="#cb17-508"></a><span class="co">#| eval: true</span></span>
<span id="cb17-509"><a href="#cb17-509"></a><span class="kw">def</span> document_cleaning_pipeline(image):</span>
<span id="cb17-510"><a href="#cb17-510"></a>    <span class="co">"""Complete pipeline for cleaning scanned documents"""</span></span>
<span id="cb17-511"><a href="#cb17-511"></a>    </span>
<span id="cb17-512"><a href="#cb17-512"></a>    <span class="co"># Step 1: Convert to grayscale</span></span>
<span id="cb17-513"><a href="#cb17-513"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-514"><a href="#cb17-514"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-515"><a href="#cb17-515"></a>    <span class="cf">else</span>:</span>
<span id="cb17-516"><a href="#cb17-516"></a>        gray <span class="op">=</span> image</span>
<span id="cb17-517"><a href="#cb17-517"></a>    </span>
<span id="cb17-518"><a href="#cb17-518"></a>    <span class="co"># Step 2: Apply adaptive thresholding</span></span>
<span id="cb17-519"><a href="#cb17-519"></a>    binary <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb17-520"><a href="#cb17-520"></a>        gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb17-521"><a href="#cb17-521"></a>    )</span>
<span id="cb17-522"><a href="#cb17-522"></a>    </span>
<span id="cb17-523"><a href="#cb17-523"></a>    <span class="co"># Step 3: Remove noise with opening</span></span>
<span id="cb17-524"><a href="#cb17-524"></a>    kernel_noise <span class="op">=</span> np.ones((<span class="dv">2</span>, <span class="dv">2</span>), np.uint8)</span>
<span id="cb17-525"><a href="#cb17-525"></a>    denoised <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel_noise)</span>
<span id="cb17-526"><a href="#cb17-526"></a>    </span>
<span id="cb17-527"><a href="#cb17-527"></a>    <span class="co"># Step 4: Fill gaps in text with closing</span></span>
<span id="cb17-528"><a href="#cb17-528"></a>    kernel_fill <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>), np.uint8)</span>
<span id="cb17-529"><a href="#cb17-529"></a>    filled <span class="op">=</span> cv2.morphologyEx(denoised, cv2.MORPH_CLOSE, kernel_fill)</span>
<span id="cb17-530"><a href="#cb17-530"></a>    </span>
<span id="cb17-531"><a href="#cb17-531"></a>    <span class="co"># Step 5: Enhance text with dilation</span></span>
<span id="cb17-532"><a href="#cb17-532"></a>    kernel_enhance <span class="op">=</span> np.ones((<span class="dv">2</span>, <span class="dv">2</span>), np.uint8)</span>
<span id="cb17-533"><a href="#cb17-533"></a>    enhanced <span class="op">=</span> cv2.dilate(filled, kernel_enhance, iterations<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-534"><a href="#cb17-534"></a>    </span>
<span id="cb17-535"><a href="#cb17-535"></a>    <span class="cf">return</span> gray, binary, denoised, filled, enhanced</span>
<span id="cb17-536"><a href="#cb17-536"></a></span>
<span id="cb17-537"><a href="#cb17-537"></a><span class="co"># Apply document cleaning to our morphological demo</span></span>
<span id="cb17-538"><a href="#cb17-538"></a>gray_doc, binary_doc, denoised_doc, filled_doc, enhanced_doc <span class="op">=</span> document_cleaning_pipeline(morph_img)</span>
<span id="cb17-539"><a href="#cb17-539"></a></span>
<span id="cb17-540"><a href="#cb17-540"></a><span class="co"># Display the cleaning pipeline</span></span>
<span id="cb17-541"><a href="#cb17-541"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">12</span>))</span>
<span id="cb17-542"><a href="#cb17-542"></a></span>
<span id="cb17-543"><a href="#cb17-543"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-544"><a href="#cb17-544"></a>plt.imshow(gray_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-545"><a href="#cb17-545"></a>plt.title(<span class="st">"1. Original Grayscale"</span>)</span>
<span id="cb17-546"><a href="#cb17-546"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-547"><a href="#cb17-547"></a></span>
<span id="cb17-548"><a href="#cb17-548"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb17-549"><a href="#cb17-549"></a>plt.imshow(binary_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-550"><a href="#cb17-550"></a>plt.title(<span class="st">"2. Adaptive Threshold"</span>)</span>
<span id="cb17-551"><a href="#cb17-551"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-552"><a href="#cb17-552"></a></span>
<span id="cb17-553"><a href="#cb17-553"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb17-554"><a href="#cb17-554"></a>plt.imshow(denoised_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-555"><a href="#cb17-555"></a>plt.title(<span class="st">"3. Noise Removal (Opening)"</span>)</span>
<span id="cb17-556"><a href="#cb17-556"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-557"><a href="#cb17-557"></a></span>
<span id="cb17-558"><a href="#cb17-558"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb17-559"><a href="#cb17-559"></a>plt.imshow(filled_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-560"><a href="#cb17-560"></a>plt.title(<span class="st">"4. Gap Filling (Closing)"</span>)</span>
<span id="cb17-561"><a href="#cb17-561"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-562"><a href="#cb17-562"></a></span>
<span id="cb17-563"><a href="#cb17-563"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb17-564"><a href="#cb17-564"></a>plt.imshow(enhanced_doc, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-565"><a href="#cb17-565"></a>plt.title(<span class="st">"5. Text Enhancement (Dilation)"</span>)</span>
<span id="cb17-566"><a href="#cb17-566"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-567"><a href="#cb17-567"></a></span>
<span id="cb17-568"><a href="#cb17-568"></a><span class="co"># Show before/after comparison</span></span>
<span id="cb17-569"><a href="#cb17-569"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb17-570"><a href="#cb17-570"></a>comparison <span class="op">=</span> np.hstack([gray_doc, enhanced_doc])</span>
<span id="cb17-571"><a href="#cb17-571"></a>plt.imshow(comparison, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-572"><a href="#cb17-572"></a>plt.title(<span class="st">"Before â†’ After"</span>)</span>
<span id="cb17-573"><a href="#cb17-573"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-574"><a href="#cb17-574"></a></span>
<span id="cb17-575"><a href="#cb17-575"></a>plt.tight_layout()</span>
<span id="cb17-576"><a href="#cb17-576"></a>plt.show()</span>
<span id="cb17-577"><a href="#cb17-577"></a></span>
<span id="cb17-578"><a href="#cb17-578"></a><span class="bu">print</span>(<span class="st">"ðŸ“„ Document Cleaning Pipeline:"</span>)</span>
<span id="cb17-579"><a href="#cb17-579"></a><span class="bu">print</span>(<span class="st">"âœ… Adaptive thresholding handles varying lighting"</span>)</span>
<span id="cb17-580"><a href="#cb17-580"></a><span class="bu">print</span>(<span class="st">"âœ… Opening removes small noise pixels"</span>)</span>
<span id="cb17-581"><a href="#cb17-581"></a><span class="bu">print</span>(<span class="st">"âœ… Closing fills gaps in letters"</span>)</span>
<span id="cb17-582"><a href="#cb17-582"></a><span class="bu">print</span>(<span class="st">"âœ… Dilation strengthens text strokes"</span>)</span>
<span id="cb17-583"><a href="#cb17-583"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Result: Clean, readable text!"</span>)</span>
<span id="cb17-584"><a href="#cb17-584"></a><span class="in">```</span></span>
<span id="cb17-585"><a href="#cb17-585"></a></span>
<span id="cb17-586"><a href="#cb17-586"></a><span class="fu">## Segmentation Comparison Tool</span></span>
<span id="cb17-587"><a href="#cb17-587"></a></span>
<span id="cb17-588"><a href="#cb17-588"></a>Let's create a tool to compare all segmentation techniques side by side:</span>
<span id="cb17-589"><a href="#cb17-589"></a></span>
<span id="cb17-592"><a href="#cb17-592"></a><span class="in">```{python}</span></span>
<span id="cb17-593"><a href="#cb17-593"></a><span class="co">#| eval: true</span></span>
<span id="cb17-594"><a href="#cb17-594"></a><span class="kw">def</span> compare_segmentation_techniques(image):</span>
<span id="cb17-595"><a href="#cb17-595"></a>    <span class="co">"""Compare multiple segmentation techniques on the same image"""</span></span>
<span id="cb17-596"><a href="#cb17-596"></a>    </span>
<span id="cb17-597"><a href="#cb17-597"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb17-598"><a href="#cb17-598"></a>    <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-599"><a href="#cb17-599"></a>        gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-600"><a href="#cb17-600"></a>    <span class="cf">else</span>:</span>
<span id="cb17-601"><a href="#cb17-601"></a>        gray <span class="op">=</span> image</span>
<span id="cb17-602"><a href="#cb17-602"></a>    </span>
<span id="cb17-603"><a href="#cb17-603"></a>    techniques <span class="op">=</span> {}</span>
<span id="cb17-604"><a href="#cb17-604"></a>    </span>
<span id="cb17-605"><a href="#cb17-605"></a>    <span class="co"># 1. Simple thresholding</span></span>
<span id="cb17-606"><a href="#cb17-606"></a>    _, techniques[<span class="st">'Binary Threshold'</span>] <span class="op">=</span> cv2.threshold(gray, <span class="dv">127</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb17-607"><a href="#cb17-607"></a>    </span>
<span id="cb17-608"><a href="#cb17-608"></a>    <span class="co"># 2. Otsu's thresholding</span></span>
<span id="cb17-609"><a href="#cb17-609"></a>    _, techniques[<span class="st">'Otsu Threshold'</span>] <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-610"><a href="#cb17-610"></a>    </span>
<span id="cb17-611"><a href="#cb17-611"></a>    <span class="co"># 3. Adaptive thresholding</span></span>
<span id="cb17-612"><a href="#cb17-612"></a>    techniques[<span class="st">'Adaptive Threshold'</span>] <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb17-613"><a href="#cb17-613"></a>        gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb17-614"><a href="#cb17-614"></a>    )</span>
<span id="cb17-615"><a href="#cb17-615"></a>    </span>
<span id="cb17-616"><a href="#cb17-616"></a>    <span class="co"># 4. Morphological opening</span></span>
<span id="cb17-617"><a href="#cb17-617"></a>    kernel <span class="op">=</span> np.ones((<span class="dv">5</span>, <span class="dv">5</span>), np.uint8)</span>
<span id="cb17-618"><a href="#cb17-618"></a>    _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-619"><a href="#cb17-619"></a>    techniques[<span class="st">'Morphological Opening'</span>] <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel)</span>
<span id="cb17-620"><a href="#cb17-620"></a>    </span>
<span id="cb17-621"><a href="#cb17-621"></a>    <span class="co"># 5. Morphological closing</span></span>
<span id="cb17-622"><a href="#cb17-622"></a>    techniques[<span class="st">'Morphological Closing'</span>] <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb17-623"><a href="#cb17-623"></a>    </span>
<span id="cb17-624"><a href="#cb17-624"></a>    <span class="cf">return</span> techniques</span>
<span id="cb17-625"><a href="#cb17-625"></a></span>
<span id="cb17-626"><a href="#cb17-626"></a><span class="co"># Compare techniques on our demo image</span></span>
<span id="cb17-627"><a href="#cb17-627"></a>techniques <span class="op">=</span> compare_segmentation_techniques(img_rgb)</span>
<span id="cb17-628"><a href="#cb17-628"></a></span>
<span id="cb17-629"><a href="#cb17-629"></a><span class="co"># Display comparison</span></span>
<span id="cb17-630"><a href="#cb17-630"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>))</span>
<span id="cb17-631"><a href="#cb17-631"></a></span>
<span id="cb17-632"><a href="#cb17-632"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-633"><a href="#cb17-633"></a>plt.imshow(img_rgb)</span>
<span id="cb17-634"><a href="#cb17-634"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb17-635"><a href="#cb17-635"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-636"><a href="#cb17-636"></a></span>
<span id="cb17-637"><a href="#cb17-637"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(techniques.items(), <span class="dv">2</span>):</span>
<span id="cb17-638"><a href="#cb17-638"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, i)</span>
<span id="cb17-639"><a href="#cb17-639"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-640"><a href="#cb17-640"></a>    plt.title(name)</span>
<span id="cb17-641"><a href="#cb17-641"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-642"><a href="#cb17-642"></a></span>
<span id="cb17-643"><a href="#cb17-643"></a>plt.tight_layout()</span>
<span id="cb17-644"><a href="#cb17-644"></a>plt.show()</span>
<span id="cb17-645"><a href="#cb17-645"></a></span>
<span id="cb17-646"><a href="#cb17-646"></a><span class="bu">print</span>(<span class="st">"ðŸŽ¯ Technique Comparison:"</span>)</span>
<span id="cb17-647"><a href="#cb17-647"></a><span class="bu">print</span>(<span class="st">"- Binary: Simple but effective for uniform lighting"</span>)</span>
<span id="cb17-648"><a href="#cb17-648"></a><span class="bu">print</span>(<span class="st">"- Otsu: Automatically finds optimal threshold"</span>)</span>
<span id="cb17-649"><a href="#cb17-649"></a><span class="bu">print</span>(<span class="st">"- Adaptive: Handles varying lighting conditions"</span>)</span>
<span id="cb17-650"><a href="#cb17-650"></a><span class="bu">print</span>(<span class="st">"- Opening: Removes noise while preserving object shape"</span>)</span>
<span id="cb17-651"><a href="#cb17-651"></a><span class="bu">print</span>(<span class="st">"- Closing: Fills gaps and connects broken parts"</span>)</span>
<span id="cb17-652"><a href="#cb17-652"></a><span class="in">```</span></span>
<span id="cb17-653"><a href="#cb17-653"></a></span>
<span id="cb17-654"><a href="#cb17-654"></a><span class="fu">## Your Challenge: Medical Image Segmentation</span></span>
<span id="cb17-655"><a href="#cb17-655"></a></span>
<span id="cb17-656"><a href="#cb17-656"></a>Now it's your turn! Here's a framework for a medical image segmentation system:</span>
<span id="cb17-657"><a href="#cb17-657"></a></span>
<span id="cb17-660"><a href="#cb17-660"></a><span class="in">```{python}</span></span>
<span id="cb17-661"><a href="#cb17-661"></a><span class="co">#| eval: true</span></span>
<span id="cb17-662"><a href="#cb17-662"></a><span class="kw">class</span> MedicalImageSegmenter:</span>
<span id="cb17-663"><a href="#cb17-663"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb17-664"><a href="#cb17-664"></a>        <span class="va">self</span>.techniques <span class="op">=</span> {</span>
<span id="cb17-665"><a href="#cb17-665"></a>            <span class="st">'threshold'</span>: <span class="va">self</span>.threshold_segment,</span>
<span id="cb17-666"><a href="#cb17-666"></a>            <span class="st">'morphological'</span>: <span class="va">self</span>.morphological_segment,</span>
<span id="cb17-667"><a href="#cb17-667"></a>            <span class="st">'watershed'</span>: <span class="va">self</span>.watershed_segment,</span>
<span id="cb17-668"><a href="#cb17-668"></a>            <span class="st">'contour'</span>: <span class="va">self</span>.contour_segment</span>
<span id="cb17-669"><a href="#cb17-669"></a>        }</span>
<span id="cb17-670"><a href="#cb17-670"></a>    </span>
<span id="cb17-671"><a href="#cb17-671"></a>    <span class="kw">def</span> threshold_segment(<span class="va">self</span>, image, method<span class="op">=</span><span class="st">'otsu'</span>):</span>
<span id="cb17-672"><a href="#cb17-672"></a>        <span class="co">"""Apply thresholding segmentation"""</span></span>
<span id="cb17-673"><a href="#cb17-673"></a>        <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-674"><a href="#cb17-674"></a>            gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-675"><a href="#cb17-675"></a>        <span class="cf">else</span>:</span>
<span id="cb17-676"><a href="#cb17-676"></a>            gray <span class="op">=</span> image</span>
<span id="cb17-677"><a href="#cb17-677"></a>            </span>
<span id="cb17-678"><a href="#cb17-678"></a>        <span class="cf">if</span> method <span class="op">==</span> <span class="st">'otsu'</span>:</span>
<span id="cb17-679"><a href="#cb17-679"></a>            _, result <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-680"><a href="#cb17-680"></a>        <span class="cf">elif</span> method <span class="op">==</span> <span class="st">'adaptive'</span>:</span>
<span id="cb17-681"><a href="#cb17-681"></a>            result <span class="op">=</span> cv2.adaptiveThreshold(</span>
<span id="cb17-682"><a href="#cb17-682"></a>                gray, <span class="dv">255</span>, cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY, <span class="dv">11</span>, <span class="dv">2</span></span>
<span id="cb17-683"><a href="#cb17-683"></a>            )</span>
<span id="cb17-684"><a href="#cb17-684"></a>        <span class="cf">else</span>:</span>
<span id="cb17-685"><a href="#cb17-685"></a>            _, result <span class="op">=</span> cv2.threshold(gray, <span class="dv">127</span>, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb17-686"><a href="#cb17-686"></a>        </span>
<span id="cb17-687"><a href="#cb17-687"></a>        <span class="cf">return</span> result</span>
<span id="cb17-688"><a href="#cb17-688"></a>    </span>
<span id="cb17-689"><a href="#cb17-689"></a>    <span class="kw">def</span> morphological_segment(<span class="va">self</span>, image, operation<span class="op">=</span><span class="st">'opening'</span>, kernel_size<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb17-690"><a href="#cb17-690"></a>        <span class="co">"""Apply morphological operations"""</span></span>
<span id="cb17-691"><a href="#cb17-691"></a>        <span class="co"># First get binary image</span></span>
<span id="cb17-692"><a href="#cb17-692"></a>        binary <span class="op">=</span> <span class="va">self</span>.threshold_segment(image, <span class="st">'otsu'</span>)</span>
<span id="cb17-693"><a href="#cb17-693"></a>        </span>
<span id="cb17-694"><a href="#cb17-694"></a>        <span class="co"># Apply morphological operation</span></span>
<span id="cb17-695"><a href="#cb17-695"></a>        kernel <span class="op">=</span> np.ones((kernel_size, kernel_size), np.uint8)</span>
<span id="cb17-696"><a href="#cb17-696"></a>        </span>
<span id="cb17-697"><a href="#cb17-697"></a>        <span class="cf">if</span> operation <span class="op">==</span> <span class="st">'opening'</span>:</span>
<span id="cb17-698"><a href="#cb17-698"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_OPEN, kernel)</span>
<span id="cb17-699"><a href="#cb17-699"></a>        <span class="cf">elif</span> operation <span class="op">==</span> <span class="st">'closing'</span>:</span>
<span id="cb17-700"><a href="#cb17-700"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_CLOSE, kernel)</span>
<span id="cb17-701"><a href="#cb17-701"></a>        <span class="cf">elif</span> operation <span class="op">==</span> <span class="st">'gradient'</span>:</span>
<span id="cb17-702"><a href="#cb17-702"></a>            result <span class="op">=</span> cv2.morphologyEx(binary, cv2.MORPH_GRADIENT, kernel)</span>
<span id="cb17-703"><a href="#cb17-703"></a>        <span class="cf">else</span>:</span>
<span id="cb17-704"><a href="#cb17-704"></a>            result <span class="op">=</span> binary</span>
<span id="cb17-705"><a href="#cb17-705"></a>            </span>
<span id="cb17-706"><a href="#cb17-706"></a>        <span class="cf">return</span> result</span>
<span id="cb17-707"><a href="#cb17-707"></a>    </span>
<span id="cb17-708"><a href="#cb17-708"></a>    <span class="kw">def</span> watershed_segment(<span class="va">self</span>, image):</span>
<span id="cb17-709"><a href="#cb17-709"></a>        <span class="co">"""Apply watershed segmentation"""</span></span>
<span id="cb17-710"><a href="#cb17-710"></a>        <span class="co"># This is a simplified version</span></span>
<span id="cb17-711"><a href="#cb17-711"></a>        <span class="cf">if</span> <span class="bu">len</span>(image.shape) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb17-712"><a href="#cb17-712"></a>            gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)</span>
<span id="cb17-713"><a href="#cb17-713"></a>        <span class="cf">else</span>:</span>
<span id="cb17-714"><a href="#cb17-714"></a>            gray <span class="op">=</span> image</span>
<span id="cb17-715"><a href="#cb17-715"></a>            </span>
<span id="cb17-716"><a href="#cb17-716"></a>        <span class="co"># Apply threshold</span></span>
<span id="cb17-717"><a href="#cb17-717"></a>        _, binary <span class="op">=</span> cv2.threshold(gray, <span class="dv">0</span>, <span class="dv">255</span>, cv2.THRESH_BINARY <span class="op">+</span> cv2.THRESH_OTSU)</span>
<span id="cb17-718"><a href="#cb17-718"></a>        </span>
<span id="cb17-719"><a href="#cb17-719"></a>        <span class="co"># Distance transform</span></span>
<span id="cb17-720"><a href="#cb17-720"></a>        dist_transform <span class="op">=</span> cv2.distanceTransform(binary, cv2.DIST_L2, <span class="dv">5</span>)</span>
<span id="cb17-721"><a href="#cb17-721"></a>        </span>
<span id="cb17-722"><a href="#cb17-722"></a>        <span class="co"># Find local maxima</span></span>
<span id="cb17-723"><a href="#cb17-723"></a>        _, markers <span class="op">=</span> cv2.threshold(dist_transform, <span class="fl">0.7</span> <span class="op">*</span> dist_transform.<span class="bu">max</span>(), <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb17-724"><a href="#cb17-724"></a>        </span>
<span id="cb17-725"><a href="#cb17-725"></a>        <span class="cf">return</span> markers.astype(np.uint8)</span>
<span id="cb17-726"><a href="#cb17-726"></a>    </span>
<span id="cb17-727"><a href="#cb17-727"></a>    <span class="kw">def</span> contour_segment(<span class="va">self</span>, image, min_area<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb17-728"><a href="#cb17-728"></a>        <span class="co">"""Segment using contours"""</span></span>
<span id="cb17-729"><a href="#cb17-729"></a>        binary <span class="op">=</span> <span class="va">self</span>.threshold_segment(image, <span class="st">'otsu'</span>)</span>
<span id="cb17-730"><a href="#cb17-730"></a>        </span>
<span id="cb17-731"><a href="#cb17-731"></a>        <span class="co"># Find contours</span></span>
<span id="cb17-732"><a href="#cb17-732"></a>        contours, _ <span class="op">=</span> cv2.findContours(binary, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb17-733"><a href="#cb17-733"></a>        </span>
<span id="cb17-734"><a href="#cb17-734"></a>        <span class="co"># Create result image</span></span>
<span id="cb17-735"><a href="#cb17-735"></a>        result <span class="op">=</span> np.zeros_like(binary)</span>
<span id="cb17-736"><a href="#cb17-736"></a>        </span>
<span id="cb17-737"><a href="#cb17-737"></a>        <span class="co"># Draw significant contours</span></span>
<span id="cb17-738"><a href="#cb17-738"></a>        <span class="cf">for</span> contour <span class="kw">in</span> contours:</span>
<span id="cb17-739"><a href="#cb17-739"></a>            <span class="cf">if</span> cv2.contourArea(contour) <span class="op">&gt;</span> min_area:</span>
<span id="cb17-740"><a href="#cb17-740"></a>                cv2.drawContours(result, [contour], <span class="op">-</span><span class="dv">1</span>, <span class="dv">255</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb17-741"><a href="#cb17-741"></a>        </span>
<span id="cb17-742"><a href="#cb17-742"></a>        <span class="cf">return</span> result</span>
<span id="cb17-743"><a href="#cb17-743"></a>    </span>
<span id="cb17-744"><a href="#cb17-744"></a>    <span class="kw">def</span> analyze_segments(<span class="va">self</span>, segmented_image):</span>
<span id="cb17-745"><a href="#cb17-745"></a>        <span class="co">"""Analyze segmented regions"""</span></span>
<span id="cb17-746"><a href="#cb17-746"></a>        <span class="co"># Find connected components</span></span>
<span id="cb17-747"><a href="#cb17-747"></a>        num_labels, labels, stats, centroids <span class="op">=</span> cv2.connectedComponentsWithStats(segmented_image)</span>
<span id="cb17-748"><a href="#cb17-748"></a>        </span>
<span id="cb17-749"><a href="#cb17-749"></a>        analysis <span class="op">=</span> {</span>
<span id="cb17-750"><a href="#cb17-750"></a>            <span class="st">'num_objects'</span>: num_labels <span class="op">-</span> <span class="dv">1</span>,  <span class="co"># Subtract background</span></span>
<span id="cb17-751"><a href="#cb17-751"></a>            <span class="st">'total_area'</span>: np.<span class="bu">sum</span>(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]),  <span class="co"># Exclude background</span></span>
<span id="cb17-752"><a href="#cb17-752"></a>            <span class="st">'average_area'</span>: np.mean(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]) <span class="cf">if</span> num_labels <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb17-753"><a href="#cb17-753"></a>            <span class="st">'largest_area'</span>: np.<span class="bu">max</span>(stats[<span class="dv">1</span>:, cv2.CC_STAT_AREA]) <span class="cf">if</span> num_labels <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb17-754"><a href="#cb17-754"></a>        }</span>
<span id="cb17-755"><a href="#cb17-755"></a>        </span>
<span id="cb17-756"><a href="#cb17-756"></a>        <span class="cf">return</span> analysis</span>
<span id="cb17-757"><a href="#cb17-757"></a></span>
<span id="cb17-758"><a href="#cb17-758"></a><span class="co"># Example usage</span></span>
<span id="cb17-759"><a href="#cb17-759"></a>segmenter <span class="op">=</span> MedicalImageSegmenter()</span>
<span id="cb17-760"><a href="#cb17-760"></a></span>
<span id="cb17-761"><a href="#cb17-761"></a><span class="co"># Apply different techniques to our demo image</span></span>
<span id="cb17-762"><a href="#cb17-762"></a>results <span class="op">=</span> {}</span>
<span id="cb17-763"><a href="#cb17-763"></a><span class="cf">for</span> name, method <span class="kw">in</span> segmenter.techniques.items():</span>
<span id="cb17-764"><a href="#cb17-764"></a>    <span class="cf">if</span> name <span class="op">==</span> <span class="st">'morphological'</span>:</span>
<span id="cb17-765"><a href="#cb17-765"></a>        results[name] <span class="op">=</span> method(img_rgb, <span class="st">'opening'</span>)</span>
<span id="cb17-766"><a href="#cb17-766"></a>    <span class="cf">else</span>:</span>
<span id="cb17-767"><a href="#cb17-767"></a>        results[name] <span class="op">=</span> method(img_rgb)</span>
<span id="cb17-768"><a href="#cb17-768"></a></span>
<span id="cb17-769"><a href="#cb17-769"></a><span class="co"># Analyze results</span></span>
<span id="cb17-770"><a href="#cb17-770"></a><span class="bu">print</span>(<span class="st">"ðŸ¥ Medical Image Segmentation Analysis:"</span>)</span>
<span id="cb17-771"><a href="#cb17-771"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb17-772"><a href="#cb17-772"></a></span>
<span id="cb17-773"><a href="#cb17-773"></a><span class="cf">for</span> name, result <span class="kw">in</span> results.items():</span>
<span id="cb17-774"><a href="#cb17-774"></a>    analysis <span class="op">=</span> segmenter.analyze_segments(result)</span>
<span id="cb17-775"><a href="#cb17-775"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss"> TECHNIQUE:"</span>)</span>
<span id="cb17-776"><a href="#cb17-776"></a>    <span class="bu">print</span>(<span class="ss">f"  Objects detected: </span><span class="sc">{</span>analysis[<span class="st">'num_objects'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-777"><a href="#cb17-777"></a>    <span class="bu">print</span>(<span class="ss">f"  Total area: </span><span class="sc">{</span>analysis[<span class="st">'total_area'</span>]<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb17-778"><a href="#cb17-778"></a>    <span class="bu">print</span>(<span class="ss">f"  Average area: </span><span class="sc">{</span>analysis[<span class="st">'average_area'</span>]<span class="sc">:.1f}</span><span class="ss"> pixels"</span>)</span>
<span id="cb17-779"><a href="#cb17-779"></a>    <span class="bu">print</span>(<span class="ss">f"  Largest area: </span><span class="sc">{</span>analysis[<span class="st">'largest_area'</span>]<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb17-780"><a href="#cb17-780"></a></span>
<span id="cb17-781"><a href="#cb17-781"></a><span class="co"># Visualize results</span></span>
<span id="cb17-782"><a href="#cb17-782"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb17-783"><a href="#cb17-783"></a></span>
<span id="cb17-784"><a href="#cb17-784"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb17-785"><a href="#cb17-785"></a>plt.imshow(img_rgb)</span>
<span id="cb17-786"><a href="#cb17-786"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb17-787"><a href="#cb17-787"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-788"><a href="#cb17-788"></a></span>
<span id="cb17-789"><a href="#cb17-789"></a><span class="cf">for</span> i, (name, result) <span class="kw">in</span> <span class="bu">enumerate</span>(results.items(), <span class="dv">2</span>):</span>
<span id="cb17-790"><a href="#cb17-790"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, i)</span>
<span id="cb17-791"><a href="#cb17-791"></a>    plt.imshow(result, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb17-792"><a href="#cb17-792"></a>    plt.title(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Segmentation"</span>)</span>
<span id="cb17-793"><a href="#cb17-793"></a>    plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-794"><a href="#cb17-794"></a></span>
<span id="cb17-795"><a href="#cb17-795"></a>plt.tight_layout()</span>
<span id="cb17-796"><a href="#cb17-796"></a>plt.show()</span>
<span id="cb17-797"><a href="#cb17-797"></a></span>
<span id="cb17-798"><a href="#cb17-798"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ðŸ’¡ Challenge: Try this framework on medical images!"</span>)</span>
<span id="cb17-799"><a href="#cb17-799"></a><span class="bu">print</span>(<span class="st">"- X-rays: Segment bones from soft tissue"</span>)</span>
<span id="cb17-800"><a href="#cb17-800"></a><span class="bu">print</span>(<span class="st">"- MRI scans: Identify different brain regions"</span>)</span>
<span id="cb17-801"><a href="#cb17-801"></a><span class="bu">print</span>(<span class="st">"- Cell images: Count and measure individual cells"</span>)</span>
<span id="cb17-802"><a href="#cb17-802"></a><span class="in">```</span></span>
<span id="cb17-803"><a href="#cb17-803"></a></span>
<span id="cb17-804"><a href="#cb17-804"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb17-805"><a href="#cb17-805"></a></span>
<span id="cb17-806"><a href="#cb17-806"></a><span class="ss">- </span>**Thresholding** is your first line of defense - simple but powerful</span>
<span id="cb17-807"><a href="#cb17-807"></a><span class="ss">- </span>**Morphological operations** are like image surgery tools - they reshape and clean</span>
<span id="cb17-808"><a href="#cb17-808"></a><span class="ss">- </span>**Watershed** excels at separating touching objects</span>
<span id="cb17-809"><a href="#cb17-809"></a><span class="ss">- </span>**Contour analysis** gives you detailed object measurements</span>
<span id="cb17-810"><a href="#cb17-810"></a><span class="ss">- </span>**Combine techniques** for robust real-world applications</span>
<span id="cb17-811"><a href="#cb17-811"></a></span>
<span id="cb17-812"><a href="#cb17-812"></a><span class="fu">## What's Coming Next?</span></span>
<span id="cb17-813"><a href="#cb17-813"></a></span>
<span id="cb17-814"><a href="#cb17-814"></a>In our next post, <span class="co">[</span><span class="ot">**"Feature Magic: What Makes Images Unique"**</span><span class="co">](06-feature-magic.qmd)</span>, we'll discover:</span>
<span id="cb17-815"><a href="#cb17-815"></a></span>
<span id="cb17-816"><a href="#cb17-816"></a><span class="ss">- </span>**SIFT and ORB** feature detectors</span>
<span id="cb17-817"><a href="#cb17-817"></a><span class="ss">- </span>**Feature matching** between images</span>
<span id="cb17-818"><a href="#cb17-818"></a><span class="ss">- </span>**Object recognition** using keypoints</span>
<span id="cb17-819"><a href="#cb17-819"></a><span class="ss">- </span>**Panorama stitching** with feature alignment</span>
<span id="cb17-820"><a href="#cb17-820"></a></span>
<span id="cb17-821"><a href="#cb17-821"></a>You've mastered the art of dividing images into meaningful partsâ€”next, we'll learn to find the unique fingerprints that make each image special!</span>
<span id="cb17-822"><a href="#cb17-822"></a></span>
<span id="cb17-823"><a href="#cb17-823"></a>:::{.callout-tip}</span>
<span id="cb17-824"><a href="#cb17-824"></a><span class="fu">## Hands-On Lab</span></span>
<span id="cb17-825"><a href="#cb17-825"></a>Ready to segment your own images? Try the complete interactive notebook: <span class="co">[</span><span class="ot">**Image Segmentation Lab**</span><span class="co">](https://colab.research.google.com/github/hasanpasha/quarto_blog_hasan/blob/main/notebooks/cv-foundations-05-image-segmentation.ipynb)</span></span>
<span id="cb17-826"><a href="#cb17-826"></a></span>
<span id="cb17-827"><a href="#cb17-827"></a>Experiment with medical images, document cleaning, and object counting!</span>
<span id="cb17-828"><a href="#cb17-828"></a>:::</span>
<span id="cb17-829"><a href="#cb17-829"></a></span>
<span id="cb17-830"><a href="#cb17-830"></a>:::{.callout-note}</span>
<span id="cb17-831"><a href="#cb17-831"></a><span class="fu">## Series Navigation</span></span>
<span id="cb17-832"><a href="#cb17-832"></a><span class="ss">- </span>**Previous**: <span class="co">[</span><span class="ot">Finding Patterns: Edges, Contours, and Shapes</span><span class="co">](04-finding-patterns.qmd)</span></span>
<span id="cb17-833"><a href="#cb17-833"></a><span class="ss">- </span>**Next**: <span class="co">[</span><span class="ot">Feature Magic: What Makes Images Unique</span><span class="co">](06-feature-magic.qmd)</span></span>
<span id="cb17-834"><a href="#cb17-834"></a><span class="ss">- </span>**Series Home**: <span class="co">[</span><span class="ot">Computer Vision Foundations</span><span class="co">](../computer-vision-foundations.qmd)</span></span>
<span id="cb17-835"><a href="#cb17-835"></a>:::</span>
<span id="cb17-836"><a href="#cb17-836"></a></span>
<span id="cb17-837"><a href="#cb17-837"></a>---</span>
<span id="cb17-838"><a href="#cb17-838"></a></span>
<span id="cb17-839"><a href="#cb17-839"></a>*You've just learned the fundamental techniques for breaking images into meaningful parts! Segmentation is used everywhere from medical imaging to autonomous vehicles. Next, we'll explore how to find unique features that make images recognizable.* </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>